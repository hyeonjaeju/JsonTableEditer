var FV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var n0e=FV((w0e,ew)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function VV(t){try{const e=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(e)}catch(e){return`오류 발생: ${e.message}`}}function BV(t,e=2){try{let s=function(c){return Array.isArray(c)&&c.every(h=>typeof h=="number"||typeof h=="string"||typeof h=="boolean"||h===null)},a=function(c,h){return s(h)?`@@__INLINE__@@${JSON.stringify(h)}`:h};var n=s,r=a;const i=typeof t=="string"?JSON.parse(t):t,o=JSON.stringify(i,null,e);return JSON.stringify(i,a,e).replace(/"@@__INLINE__@@\[(.*?)\]"/g,(c,h)=>`[${h}]`)}catch(i){return`오류 발생: ${i.message}`}}/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function kA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rP(t,e){return t.get(kA(t,e))}function jV(t,e,n){WV(t,e),e.set(t,n)}function UV(t,e,n){return t.set(kA(t,e),n),n}const zV=100,Se={},YV=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},GV=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,r=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{YV(),e()},zV),window.scrollTo(n,r)}),$A="swal2-",KV=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],z=KV.reduce((t,e)=>(t[e]=$A+e,t),{}),qV=["success","warning","info","question","error"],tw=qV.reduce((t,e)=>(t[e]=$A+e,t),{}),LA="SweetAlert2:",f0=t=>t.charAt(0).toUpperCase()+t.slice(1),cr=t=>{console.warn(`${LA} ${typeof t=="object"?t.join(" "):t}`)},wu=t=>{console.error(`${LA} ${t}`)},iP=[],XV=t=>{iP.includes(t)||(iP.push(t),cr(t))},FA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;XV(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},gv=t=>typeof t=="function"?t():t,g0=t=>t&&typeof t.toPromise=="function",Yf=t=>g0(t)?t.toPromise():Promise.resolve(t),m0=t=>t&&Promise.resolve(t)===t,fr=()=>document.body.querySelector(`.${z.container}`),Gf=t=>{const e=fr();return e?e.querySelector(t):null},Zr=t=>Gf(`.${t}`),rt=()=>Zr(z.popup),rh=()=>Zr(z.icon),JV=()=>Zr(z["icon-content"]),VA=()=>Zr(z.title),p0=()=>Zr(z["html-container"]),BA=()=>Zr(z.image),w0=()=>Zr(z["progress-steps"]),mv=()=>Zr(z["validation-message"]),Go=()=>Gf(`.${z.actions} .${z.confirm}`),ih=()=>Gf(`.${z.actions} .${z.cancel}`),vu=()=>Gf(`.${z.actions} .${z.deny}`),ZV=()=>Zr(z["input-label"]),oh=()=>Gf(`.${z.loader}`),Kf=()=>Zr(z.actions),WA=()=>Zr(z.footer),pv=()=>Zr(z["timer-progress-bar"]),v0=()=>Zr(z.close),QV=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,y0=()=>{const t=rt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),l=parseInt(s.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),r=t.querySelectorAll(QV),i=Array.from(r).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(i))].filter(o=>Nr(o))},C0=()=>Ls(document.body,z.shown)&&!Ls(document.body,z["toast-shown"])&&!Ls(document.body,z["no-backdrop"]),wv=()=>{const t=rt();return t?Ls(t,z.toast):!1},eB=()=>{const t=rt();return t?t.hasAttribute("data-loading"):!1},Qr=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{t.appendChild(s)});const o=r.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?t.appendChild(s.cloneNode(!0)):t.appendChild(s)})}},Ls=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let r=0;r<n.length;r++)if(!t.classList.contains(n[r]))return!1;return!0},tB=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(z).includes(n)&&!Object.values(tw).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Jr=(t,e,n)=>{if(tB(t,e),!e.customClass)return;const r=e.customClass[n];if(r){if(typeof r!="string"&&!r.forEach){cr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`);return}ct(t,r)}},vv=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${z.popup} > .${z[e]}`);case"checkbox":return t.querySelector(`.${z.popup} > .${z.checkbox} input`);case"radio":return t.querySelector(`.${z.popup} > .${z.radio} input:checked`)||t.querySelector(`.${z.popup} > .${z.radio} input:first-child`);case"range":return t.querySelector(`.${z.popup} > .${z.range} input`);default:return t.querySelector(`.${z.popup} > .${z.input}`)}},jA=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},UA=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(i=>{n?i.classList.add(r):i.classList.remove(r)}):n?t.classList.add(r):t.classList.remove(r)}))},ct=(t,e)=>{UA(t,e,!0)},Si=(t,e)=>{UA(t,e,!1)},Ma=(t,e)=>{const n=Array.from(t.children);for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof HTMLElement&&Ls(i,e))return i}},tu=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},Hn=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},Jn=t=>{t&&(t.style.display="none")},b0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{qf(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},oP=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},qf=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?Hn(t,n):Jn(t)},Nr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),nB=()=>!Nr(Go())&&!Nr(vu())&&!Nr(ih()),sP=t=>t.scrollHeight>t.clientHeight,zA=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},S0=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=pv();n&&Nr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},rB=()=>{const t=pv();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),r=e/n*100;t.style.width=`${r}%`},iB=()=>typeof window>"u"||typeof document>"u",oB=`
 <div aria-labelledby="${z.title}" aria-describedby="${z["html-container"]}" class="${z.popup}" tabindex="-1">
   <button type="button" class="${z.close}"></button>
   <ul class="${z["progress-steps"]}"></ul>
   <div class="${z.icon}"></div>
   <img class="${z.image}" />
   <h2 class="${z.title}" id="${z.title}"></h2>
   <div class="${z["html-container"]}" id="${z["html-container"]}"></div>
   <input class="${z.input}" id="${z.input}" />
   <input type="file" class="${z.file}" />
   <div class="${z.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${z.select}" id="${z.select}"></select>
   <div class="${z.radio}"></div>
   <label class="${z.checkbox}">
     <input type="checkbox" id="${z.checkbox}" />
     <span class="${z.label}"></span>
   </label>
   <textarea class="${z.textarea}" id="${z.textarea}"></textarea>
   <div class="${z["validation-message"]}" id="${z["validation-message"]}"></div>
   <div class="${z.actions}">
     <div class="${z.loader}"></div>
     <button type="button" class="${z.confirm}"></button>
     <button type="button" class="${z.deny}"></button>
     <button type="button" class="${z.cancel}"></button>
   </div>
   <div class="${z.footer}"></div>
   <div class="${z["timer-progress-bar-container"]}">
     <div class="${z["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),sB=()=>{const t=fr();return t?(t.remove(),Si([document.documentElement,document.body],[z["no-backdrop"],z["toast-shown"],z["has-column"]]),!0):!1},Qa=()=>{Se.currentInstance.resetValidationMessage()},aB=()=>{const t=rt(),e=Ma(t,z.input),n=Ma(t,z.file),r=t.querySelector(`.${z.range} input`),i=t.querySelector(`.${z.range} output`),o=Ma(t,z.select),s=t.querySelector(`.${z.checkbox} input`),a=Ma(t,z.textarea);e.oninput=Qa,n.onchange=Qa,o.onchange=Qa,s.onchange=Qa,a.oninput=Qa,r.oninput=()=>{Qa(),i.value=r.value},r.onchange=()=>{Qa(),i.value=r.value}},lB=t=>typeof t=="string"?document.querySelector(t):t,uB=t=>{const e=rt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},cB=t=>{window.getComputedStyle(t).direction==="rtl"&&ct(fr(),z.rtl)},hB=t=>{const e=sB();if(iB()){wu("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=z.container,e&&ct(n,z["no-transition"]),Qr(n,oB),n.dataset.swal2Theme=t.theme;const r=lB(t.target);r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),uB(t),cB(r),aB()},R0=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?dB(t,e):t&&Qr(e,t)},dB=(t,e)=>{t.jquery?fB(e,t):Qr(e,t.toString())},fB=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},gB=(t,e)=>{const n=Kf(),r=oh();!n||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?Jn(n):Hn(n),Jr(n,e,"actions"),mB(n,r,e),Qr(r,e.loaderHtml||""),Jr(r,e,"loader"))};function mB(t,e,n){const r=Go(),i=vu(),o=ih();!r||!i||!o||(Ty(r,"confirm",n),Ty(i,"deny",n),Ty(o,"cancel",n),pB(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}function pB(t,e,n,r){if(!r.buttonsStyling){Si([t,e,n],z.styled);return}ct([t,e,n],z.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Ey(t),Ey(e),Ey(n)}function Ey(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function Ty(t,e,n){const r=f0(e);qf(t,n[`show${r}Button`],"inline-block"),Qr(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=z[e],Jr(t,n,`${e}Button`)}const wB=(t,e)=>{const n=v0();n&&(Qr(n,e.closeButtonHtml||""),Jr(n,e,"closeButton"),qf(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},vB=(t,e)=>{const n=fr();n&&(yB(n,e.backdrop),CB(n,e.position),bB(n,e.grow),Jr(n,e,"container"))};function yB(t,e){typeof e=="string"?t.style.background=e:e||ct([document.documentElement,document.body],z["no-backdrop"])}function CB(t,e){e&&(e in z?ct(t,z[e]):(cr('The "position" parameter is not valid, defaulting to "center"'),ct(t,z.center)))}function bB(t,e){e&&ct(t,z[`grow-${e}`])}var Mt={innerParams:new WeakMap,domCache:new WeakMap};const SB=["input","file","range","select","radio","checkbox","textarea"],RB=(t,e)=>{const n=rt();if(!n)return;const r=Mt.innerParams.get(t),i=!r||e.input!==r.input;SB.forEach(o=>{const s=Ma(n,z[o]);s&&(MB(o,e.inputAttributes),s.className=z[o],i&&Jn(s))}),e.input&&(i&&EB(e),_B(e))},EB=t=>{if(!t.input)return;if(!on[t.input]){wu(`Unexpected type of input! Expected ${Object.keys(on).join(" | ")}, got "${t.input}"`);return}const e=YA(t.input);if(!e)return;const n=on[t.input](e,t);Hn(e),t.inputAutoFocus&&setTimeout(()=>{jA(n)})},TB=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},MB=(t,e)=>{const n=rt();if(!n)return;const r=vv(n,t);if(r){TB(r);for(const i in e)r.setAttribute(i,e[i])}},_B=t=>{if(!t.input)return;const e=YA(t.input);e&&Jr(e,t,"input")},E0=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Xf=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=z["input-label"];r.setAttribute("for",t.id),r.className=i,typeof n.customClass=="object"&&ct(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},YA=t=>{const e=rt();if(e)return Ma(e,z[t]||z.input)},nw=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:m0(e)||cr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},on={};on.text=on.email=on.password=on.number=on.tel=on.url=on.search=on.date=on["datetime-local"]=on.time=on.week=on.month=(t,e)=>(nw(t,e.inputValue),Xf(t,t,e),E0(t,e),t.type=e.input,t);on.file=(t,e)=>(Xf(t,t,e),E0(t,e),t);on.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return nw(n,e.inputValue),n.type=e.input,nw(r,e.inputValue),Xf(n,t,e),t};on.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");Qr(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Xf(t,t,e),t};on.radio=t=>(t.textContent="",t);on.checkbox=(t,e)=>{const n=vv(rt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const r=t.querySelector("span");return Qr(r,e.inputPlaceholder||e.inputLabel),n};on.textarea=(t,e)=>{nw(t,e.inputValue),E0(t,e),Xf(t,t,e);const n=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(rt()).width),i=()=>{if(!document.body.contains(t))return;const o=t.offsetWidth+n(t);o>r?rt().style.width=`${o}px`:tu(rt(),"width",e.width)};new MutationObserver(i).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const PB=(t,e)=>{const n=p0();n&&(b0(n),Jr(n,e,"htmlContainer"),e.html?(R0(e.html,n),Hn(n,"block")):e.text?(n.textContent=e.text,Hn(n,"block")):Jn(n),RB(t,e))},xB=(t,e)=>{const n=WA();n&&(b0(n),qf(n,e.footer,"block"),e.footer&&R0(e.footer,n),Jr(n,e,"footer"))},IB=(t,e)=>{const n=Mt.innerParams.get(t),r=rh();if(!r)return;if(n&&e.icon===n.icon){lP(r,e),aP(r,e);return}if(!e.icon&&!e.iconHtml){Jn(r);return}if(e.icon&&Object.keys(tw).indexOf(e.icon)===-1){wu(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),Jn(r);return}Hn(r),lP(r,e),aP(r,e),ct(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",GA)},aP=(t,e)=>{for(const[n,r]of Object.entries(tw))e.icon!==n&&Si(t,r);ct(t,e.icon&&tw[e.icon]),HB(t,e),GA(),Jr(t,e,"icon")},GA=()=>{const t=rt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=e},OB=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,AB=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,lP=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=uP(e.iconHtml):e.icon==="success"?(r=OB,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?r=AB:e.icon&&(r=uP({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&Qr(t,r)},HB=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])oP(t,n,"background-color",e.iconColor);oP(t,".swal2-success-ring","border-color",e.iconColor)}},uP=t=>`<div class="${z["icon-content"]}">${t}</div>`,NB=(t,e)=>{const n=BA();if(n){if(!e.imageUrl){Jn(n);return}Hn(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),tu(n,"width",e.imageWidth),tu(n,"height",e.imageHeight),n.className=z.image,Jr(n,e,"image")}};let T0=!1,KA=0,qA=0,XA=0,JA=0;const DB=t=>{t.addEventListener("mousedown",rw),document.body.addEventListener("mousemove",iw),t.addEventListener("mouseup",ow),t.addEventListener("touchstart",rw),document.body.addEventListener("touchmove",iw),t.addEventListener("touchend",ow)},kB=t=>{t.removeEventListener("mousedown",rw),document.body.removeEventListener("mousemove",iw),t.removeEventListener("mouseup",ow),t.removeEventListener("touchstart",rw),document.body.removeEventListener("touchmove",iw),t.removeEventListener("touchend",ow)},rw=t=>{const e=rt();if(t.target===e||rh().contains(t.target)){T0=!0;const n=ZA(t);KA=n.clientX,qA=n.clientY,XA=parseInt(e.style.insetInlineStart)||0,JA=parseInt(e.style.insetBlockStart)||0,ct(e,"swal2-dragging")}},iw=t=>{const e=rt();if(T0){let{clientX:n,clientY:r}=ZA(t);e.style.insetInlineStart=`${XA+(n-KA)}px`,e.style.insetBlockStart=`${JA+(r-qA)}px`}},ow=()=>{const t=rt();T0=!1,Si(t,"swal2-dragging")},ZA=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},$B=(t,e)=>{const n=fr(),r=rt();if(!(!n||!r)){if(e.toast){tu(n,"width",e.width),r.style.width="100%";const i=oh();i&&r.insertBefore(i,rh())}else tu(r,"width",e.width);tu(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),Jn(mv()),LB(r,e),e.draggable&&!e.toast?(ct(r,z.draggable),DB(r)):(Si(r,z.draggable),kB(r))}},LB=(t,e)=>{const n=e.showClass||{};t.className=`${z.popup} ${Nr(t)?n.popup:""}`,e.toast?(ct([document.documentElement,document.body],z["toast-shown"]),ct(t,z.toast)):ct(t,z.modal),Jr(t,e,"popup"),typeof e.customClass=="string"&&ct(t,e.customClass),e.icon&&ct(t,z[`icon-${e.icon}`])},FB=(t,e)=>{const n=w0();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;if(!r||r.length===0||i===void 0){Jn(n);return}Hn(n),n.textContent="",i>=r.length&&cr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((o,s)=>{const a=VB(o);if(n.appendChild(a),s===i&&ct(a,z["active-progress-step"]),s!==r.length-1){const l=BB(e);n.appendChild(l)}})},VB=t=>{const e=document.createElement("li");return ct(e,z["progress-step"]),Qr(e,t),e},BB=t=>{const e=document.createElement("li");return ct(e,z["progress-step-line"]),t.progressStepsDistance&&tu(e,"width",t.progressStepsDistance),e},WB=(t,e)=>{const n=VA();n&&(b0(n),qf(n,e.title||e.titleText,"block"),e.title&&R0(e.title,n),e.titleText&&(n.innerText=e.titleText),Jr(n,e,"title"))},QA=(t,e)=>{$B(t,e),vB(t,e),FB(t,e),IB(t,e),NB(t,e),WB(t,e),wB(t,e),PB(t,e),gB(t,e),xB(t,e);const n=rt();typeof e.didRender=="function"&&n&&e.didRender(n),Se.eventEmitter.emit("didRender",n)},jB=()=>Nr(rt()),eH=()=>{var t;return(t=Go())===null||t===void 0?void 0:t.click()},UB=()=>{var t;return(t=vu())===null||t===void 0?void 0:t.click()},zB=()=>{var t;return(t=ih())===null||t===void 0?void 0:t.click()},sh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),tH=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},YB=(t,e,n)=>{tH(t),e.toast||(t.keydownHandler=r=>KB(e,r,n),t.keydownTarget=e.keydownListenerCapture?window:rt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},NS=(t,e)=>{var n;const r=y0();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(n=rt())===null||n===void 0||n.focus()},nH=["ArrowRight","ArrowDown"],GB=["ArrowLeft","ArrowUp"],KB=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?qB(e,t):e.key==="Tab"?XB(e):[...nH,...GB].includes(e.key)?JB(e.key):e.key==="Escape"&&ZB(e,t,n)))},qB=(t,e)=>{if(!gv(e.allowEnterKey))return;const n=vv(rt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;eH(),t.preventDefault()}},XB=t=>{const e=t.target,n=y0();let r=-1;for(let i=0;i<n.length;i++)if(e===n[i]){r=i;break}t.shiftKey?NS(r,-1):NS(r,1),t.stopPropagation(),t.preventDefault()},JB=t=>{const e=Kf(),n=Go(),r=vu(),i=ih();if(!e||!n||!r||!i)return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=nH.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Nr(a))break}a instanceof HTMLButtonElement&&a.focus()}},ZB=(t,e,n)=>{gv(e.allowEscapeKey)&&(t.preventDefault(),n(sh.esc))};var Yc={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const QB=()=>{const t=fr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},rH=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},iH=typeof window<"u"&&!!window.GestureEvent,eW=()=>{if(iH&&!Ls(document.body,z.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,ct(document.body,z.iosfix),tW()}},tW=()=>{const t=fr();if(!t)return;let e;t.ontouchstart=n=>{e=nW(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},nW=t=>{const e=t.target,n=fr(),r=p0();return!n||!r||rW(t)||iW(t)?!1:e===n||!sP(n)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(sP(r)&&r.contains(e))},rW=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",iW=t=>t.touches&&t.touches.length>1,oW=()=>{if(Ls(document.body,z.iosfix)){const t=parseInt(document.body.style.top,10);Si(document.body,z.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},sW=()=>{const t=document.createElement("div");t.className=z["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let Nc=null;const aW=t=>{Nc===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(Nc=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Nc+sW()}px`)},lW=()=>{Nc!==null&&(document.body.style.paddingRight=`${Nc}px`,Nc=null)};function oH(t,e,n,r){wv()?cP(t,r):(GV(n).then(()=>cP(t,r)),tH(Se)),iH?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),C0()&&(lW(),oW(),rH()),uW()}function uW(){Si([document.documentElement,document.body],[z.shown,z["height-auto"],z["no-backdrop"],z["toast-shown"]])}function _a(t){t=hW(t);const e=Yc.swalPromiseResolve.get(this),n=cW(this);this.isAwaitingPromise?t.isDismissed||(Jf(this),e(t)):n&&e(t)}const cW=t=>{const e=rt();if(!e)return!1;const n=Mt.innerParams.get(t);if(!n||Ls(e,n.hideClass.popup))return!1;Si(e,n.showClass.popup),ct(e,n.hideClass.popup);const r=fr();return Si(r,n.showClass.backdrop),ct(r,n.hideClass.backdrop),dW(t,e,n),!0};function sH(t){const e=Yc.swalPromiseReject.get(this);Jf(this),e&&e(t)}const Jf=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Mt.innerParams.get(t)||t._destroy())},hW=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),dW=(t,e,n)=>{var r;const i=fr(),o=zA(e);typeof n.willClose=="function"&&n.willClose(e),(r=Se.eventEmitter)===null||r===void 0||r.emit("willClose",e),o?fW(t,e,i,n.returnFocus,n.didClose):oH(t,i,n.returnFocus,n.didClose)},fW=(t,e,n,r,i)=>{Se.swalCloseEventFinishedCallback=oH.bind(null,t,n,r,i);const o=function(s){if(s.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",o),e.removeEventListener("transitionend",o)}};e.addEventListener("animationend",o),e.addEventListener("transitionend",o)},cP=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Gc=t=>{let e=rt();if(e||new yi,e=rt(),!e)return;const n=oh();wv()?Jn(rh()):gW(e,t),Hn(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},gW=(t,e)=>{const n=Kf(),r=oh();!n||!r||(!e&&Nr(Go())&&(e=Go()),Hn(n),e&&(Jn(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),ct([t,n],z.loading))},mW=(t,e)=>{e.input==="select"||e.input==="radio"?CW(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(g0(e.inputValue)||m0(e.inputValue))&&(Gc(Go()),bW(t,e))},pW=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return wW(n);case"radio":return vW(n);case"file":return yW(n);default:return e.inputAutoTrim?n.value.trim():n.value}},wW=t=>t.checked?1:0,vW=t=>t.checked?t.value:null,yW=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,CW=(t,e)=>{const n=rt();if(!n)return;const r=i=>{e.input==="select"?SW(n,sw(i),e):e.input==="radio"&&RW(n,sw(i),e)};g0(e.inputOptions)||m0(e.inputOptions)?(Gc(Go()),Yf(e.inputOptions).then(i=>{t.hideLoading(),r(i)})):typeof e.inputOptions=="object"?r(e.inputOptions):wu(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},bW=(t,e)=>{const n=t.getInput();n&&(Jn(n),Yf(e.inputValue).then(r=>{n.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,Hn(n),n.focus(),t.hideLoading()}).catch(r=>{wu(`Error in inputValue promise: ${r}`),n.value="",Hn(n),n.focus(),t.hideLoading()}))};function SW(t,e,n){const r=Ma(t,z.select);if(!r)return;const i=(o,s,a)=>{const l=document.createElement("option");l.value=a,Qr(l,s),l.selected=aH(a,n.inputValue),o.appendChild(l)};e.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=s,l.disabled=!1,r.appendChild(l),a.forEach(u=>i(l,u[1],u[0]))}else i(r,a,s)}),r.focus()}function RW(t,e,n){const r=Ma(t,z.radio);if(!r)return;e.forEach(o=>{const s=o[0],a=o[1],l=document.createElement("input"),u=document.createElement("label");l.type="radio",l.name=z.radio,l.value=s,aH(s,n.inputValue)&&(l.checked=!0);const c=document.createElement("span");Qr(c,a),c.className=z.label,u.appendChild(l),u.appendChild(c),r.appendChild(u)});const i=r.querySelectorAll("input");i.length&&i[0].focus()}const sw=t=>{const e=[];return t instanceof Map?t.forEach((n,r)=>{let i=n;typeof i=="object"&&(i=sw(i)),e.push([r,i])}):Object.keys(t).forEach(n=>{let r=t[n];typeof r=="object"&&(r=sw(r)),e.push([n,r])}),e},aH=(t,e)=>!!e&&e.toString()===t.toString(),EW=t=>{const e=Mt.innerParams.get(t);t.disableButtons(),e.input?lH(t,"confirm"):_0(t,!0)},TW=t=>{const e=Mt.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?lH(t,"deny"):M0(t,!1)},MW=(t,e)=>{t.disableButtons(),e(sh.cancel)},lH=(t,e)=>{const n=Mt.innerParams.get(t);if(!n.input){wu(`The "input" parameter is needed to be set when using returnInputValueOn${f0(e)}`);return}const r=t.getInput(),i=pW(t,n);n.inputValidator?_W(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):e==="deny"?M0(t,i):_0(t,i)},_W=(t,e,n)=>{const r=Mt.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Yf(r.inputValidator(e,r.validationMessage))).then(o=>{t.enableButtons(),t.enableInput(),o?t.showValidationMessage(o):n==="deny"?M0(t,e):_0(t,e)})},M0=(t,e)=>{const n=Mt.innerParams.get(t||void 0);n.showLoaderOnDeny&&Gc(vu()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Yf(n.preDeny(e,n.validationMessage))).then(i=>{i===!1?(t.hideLoading(),Jf(t)):t.close({isDenied:!0,value:typeof i>"u"?e:i})}).catch(i=>uH(t||void 0,i))):t.close({isDenied:!0,value:e})},hP=(t,e)=>{t.close({isConfirmed:!0,value:e})},uH=(t,e)=>{t.rejectPromise(e)},_0=(t,e)=>{const n=Mt.innerParams.get(t||void 0);n.showLoaderOnConfirm&&Gc(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Yf(n.preConfirm(e,n.validationMessage))).then(i=>{Nr(mv())||i===!1?(t.hideLoading(),Jf(t)):hP(t,typeof i>"u"?e:i)}).catch(i=>uH(t||void 0,i))):hP(t,e)};function aw(){const t=Mt.innerParams.get(this);if(!t)return;const e=Mt.domCache.get(this);Jn(e.loader),wv()?t.icon&&Hn(rh()):PW(e),Si([e.popup,e.actions],z.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const PW=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Hn(e[0],"inline-block"):nB()&&Jn(t.actions)};function cH(){const t=Mt.innerParams.get(this),e=Mt.domCache.get(this);return e?vv(e.popup,t.input):null}function hH(t,e,n){const r=Mt.domCache.get(t);e.forEach(i=>{r[i].disabled=n})}function dH(t,e){const n=rt();if(!(!n||!t))if(t.type==="radio"){const r=n.querySelectorAll(`[name="${z.radio}"]`);for(let i=0;i<r.length;i++)r[i].disabled=e}else t.disabled=e}function fH(){hH(this,["confirmButton","denyButton","cancelButton"],!1)}function gH(){hH(this,["confirmButton","denyButton","cancelButton"],!0)}function mH(){dH(this.getInput(),!1)}function pH(){dH(this.getInput(),!0)}function wH(t){const e=Mt.domCache.get(this),n=Mt.innerParams.get(this);Qr(e.validationMessage,t),e.validationMessage.className=z["validation-message"],n.customClass&&n.customClass.validationMessage&&ct(e.validationMessage,n.customClass.validationMessage),Hn(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",z["validation-message"]),jA(r),ct(r,z.inputerror))}function vH(){const t=Mt.domCache.get(this);t.validationMessage&&Jn(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Si(e,z.inputerror))}const Dc={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},xW=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],IW={allowEnterKey:void 0},OW=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],yH=t=>Object.prototype.hasOwnProperty.call(Dc,t),CH=t=>xW.indexOf(t)!==-1,bH=t=>IW[t],AW=t=>{yH(t)||cr(`Unknown parameter "${t}"`)},HW=t=>{OW.includes(t)&&cr(`The parameter "${t}" is incompatible with toasts`)},NW=t=>{const e=bH(t);e&&FA(t,e)},SH=t=>{t.backdrop===!1&&t.allowOutsideClick&&cr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&cr(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)AW(e),t.toast&&HW(e),NW(e)};function RH(t){const e=fr(),n=rt(),r=Mt.innerParams.get(this);if(!n||Ls(n,r.hideClass.popup)){cr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=DW(t),o=Object.assign({},r,i);SH(o),e.dataset.swal2Theme=o.theme,QA(this,o),Mt.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const DW=t=>{const e={};return Object.keys(t).forEach(n=>{CH(n)?e[n]=t[n]:cr(`Invalid parameter to update: ${n}`)}),e};function EH(){const t=Mt.domCache.get(this),e=Mt.innerParams.get(this);if(!e){TH(this);return}t.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),Se.eventEmitter.emit("didDestroy"),kW(this)}const kW=t=>{TH(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},TH=t=>{t.isAwaitingPromise?(My(Mt,t),t.isAwaitingPromise=!0):(My(Yc,t),My(Mt,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},My=(t,e)=>{for(const n in t)t[n].delete(e)};var $W=Object.freeze({__proto__:null,_destroy:EH,close:_a,closeModal:_a,closePopup:_a,closeToast:_a,disableButtons:gH,disableInput:pH,disableLoading:aw,enableButtons:fH,enableInput:mH,getInput:cH,handleAwaitingPromise:Jf,hideLoading:aw,rejectPromise:sH,resetValidationMessage:vH,showValidationMessage:wH,update:RH});const LW=(t,e,n)=>{t.toast?FW(t,e,n):(BW(e),WW(e),jW(t,e,n))},FW=(t,e,n)=>{e.popup.onclick=()=>{t&&(VW(t)||t.timer||t.input)||n(sh.close)}},VW=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let lw=!1;const BW=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(lw=!0)}}},WW=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(lw=!0)}}},jW=(t,e,n)=>{e.container.onclick=r=>{if(lw){lw=!1;return}r.target===e.container&&gv(t.allowOutsideClick)&&n(sh.backdrop)}},UW=t=>typeof t=="object"&&t.jquery,dP=t=>t instanceof Element||UW(t),zW=t=>{const e={};return typeof t[0]=="object"&&!dP(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,r)=>{const i=t[r];typeof i=="string"||dP(i)?e[n]=i:i!==void 0&&wu(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)}),e};function YW(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)}function GW(t){class e extends this{_main(r,i){return super._main(r,Object.assign({},t,i))}}return e}const KW=()=>Se.timeout&&Se.timeout.getTimerLeft(),MH=()=>{if(Se.timeout)return rB(),Se.timeout.stop()},_H=()=>{if(Se.timeout){const t=Se.timeout.start();return S0(t),t}},qW=()=>{const t=Se.timeout;return t&&(t.running?MH():_H())},XW=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return S0(e,!0),e}},JW=()=>!!(Se.timeout&&Se.timeout.isRunning());let fP=!1;const DS={};function ZW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";DS[t]=this,fP||(document.body.addEventListener("click",QW),fP=!0)}const QW=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in DS){const r=e.getAttribute(n);if(r){DS[n].fire({template:r});return}}};class e2{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const r=this._getHandlersByEventName(e);r.includes(n)||r.push(n)}once(e,n){var r=this;const i=function(){r.removeListener(e,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];n.apply(r,s)};this.on(e,i)}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._getHandlersByEventName(e).forEach(o=>{try{o.apply(this,r)}catch(s){console.error(s)}})}removeListener(e,n){const r=this._getHandlersByEventName(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new e2;const t2=(t,e)=>{Se.eventEmitter.on(t,e)},n2=(t,e)=>{Se.eventEmitter.once(t,e)},r2=(t,e)=>{if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)};var i2=Object.freeze({__proto__:null,argsToParams:zW,bindClickHandler:ZW,clickCancel:zB,clickConfirm:eH,clickDeny:UB,enableLoading:Gc,fire:YW,getActions:Kf,getCancelButton:ih,getCloseButton:v0,getConfirmButton:Go,getContainer:fr,getDenyButton:vu,getFocusableElements:y0,getFooter:WA,getHtmlContainer:p0,getIcon:rh,getIconContent:JV,getImage:BA,getInputLabel:ZV,getLoader:oh,getPopup:rt,getProgressSteps:w0,getTimerLeft:KW,getTimerProgressBar:pv,getTitle:VA,getValidationMessage:mv,increaseTimer:XW,isDeprecatedParameter:bH,isLoading:eB,isTimerRunning:JW,isUpdatableParameter:CH,isValidParameter:yH,isVisible:jB,mixin:GW,off:r2,on:t2,once:n2,resumeTimer:_H,showLoading:Gc,stopTimer:MH,toggleTimer:qW});class o2{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const PH=["swal-title","swal-html","swal-footer"],s2=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return g2(n),Object.assign(a2(n),l2(n),u2(n),c2(n),h2(n),d2(n),f2(n,PH))},a2=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{su(r,["name","value"]);const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(typeof Dc[i]=="boolean"?e[i]=o!=="false":typeof Dc[i]=="object"?e[i]=JSON.parse(o):e[i]=o)}),e},l2=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const i=r.getAttribute("name"),o=r.getAttribute("value");!i||!o||(e[i]=new Function(`return ${o}`)())}),e},u2=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{su(r,["type","color","aria-label"]);const i=r.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(e[`${i}ButtonText`]=r.innerHTML,e[`show${f0(i)}Button`]=!0,r.hasAttribute("color")&&(e[`${i}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${i}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},c2=t=>{const e={},n=t.querySelector("swal-image");return n&&(su(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},h2=t=>{const e={},n=t.querySelector("swal-icon");return n&&(su(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},d2=t=>{const e={},n=t.querySelector("swal-input");n&&(su(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(i=>{su(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;e.inputOptions[o]=s})),e},f2=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(su(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},g2=t=>{const e=PH.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const r=n.tagName.toLowerCase();e.includes(r)||cr(`Unrecognized element <${r}>`)})},su=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&cr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},xH=10,m2=t=>{const e=fr(),n=rt();typeof t.willOpen=="function"&&t.willOpen(n),Se.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;v2(e,n,t),setTimeout(()=>{p2(e,n)},xH),C0()&&(w2(e,t.scrollbarPadding,i),QB()),!wv()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),Se.eventEmitter.emit("didOpen",n),Si(e,z["no-transition"])},uw=t=>{const e=rt();if(t.target!==e)return;const n=fr();e.removeEventListener("animationend",uw),e.removeEventListener("transitionend",uw),n.style.overflowY="auto"},p2=(t,e)=>{zA(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",uw),e.addEventListener("transitionend",uw)):t.style.overflowY="auto"},w2=(t,e,n)=>{eW(),e&&n!=="hidden"&&aW(n),setTimeout(()=>{t.scrollTop=0})},v2=(t,e,n)=>{ct(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Hn(e,"grid"),setTimeout(()=>{ct(e,n.showClass.popup),e.style.removeProperty("opacity")},xH)):Hn(e,"grid"),ct([document.documentElement,document.body],z.shown),n.heightAuto&&n.backdrop&&!n.toast&&ct([document.documentElement,document.body],z["height-auto"])};var gP={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function y2(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=gP.email),t.input==="url"&&(t.inputValidator=gP.url))}function C2(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(cr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function b2(t){y2(t),t.showLoaderOnConfirm&&!t.preConfirm&&cr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),C2(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),hB(t)}let Do;var Ag=new WeakMap;class hn{constructor(){if(jV(this,Ag,void 0),typeof window>"u")return;Do=this;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=Object.freeze(this.constructor.argsToParams(n));this.params=i,this.isAwaitingPromise=!1,UV(Ag,this,this._main(Do.params))}_main(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(SH(Object.assign({},n,e)),Se.currentInstance){const o=Yc.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:s}=Se.currentInstance;Se.currentInstance._destroy(),s||o({isDismissed:!0}),C0()&&rH()}Se.currentInstance=Do;const r=R2(e,n);b2(r),Object.freeze(r),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const i=E2(Do);return QA(Do,r),Mt.innerParams.set(Do,r),S2(Do,i,r)}then(e){return rP(Ag,this).then(e)}finally(e){return rP(Ag,this).finally(e)}}const S2=(t,e,n)=>new Promise((r,i)=>{const o=s=>{t.close({isDismissed:!0,dismiss:s})};Yc.swalPromiseResolve.set(t,r),Yc.swalPromiseReject.set(t,i),e.confirmButton.onclick=()=>{EW(t)},e.denyButton.onclick=()=>{TW(t)},e.cancelButton.onclick=()=>{MW(t,o)},e.closeButton.onclick=()=>{o(sh.close)},LW(n,e,o),YB(Se,n,o),mW(t,n),m2(n),T2(Se,n,o),M2(e,n),setTimeout(()=>{e.container.scrollTop=0})}),R2=(t,e)=>{const n=s2(t),r=Object.assign({},Dc,e,n,t);return r.showClass=Object.assign({},Dc.showClass,r.showClass),r.hideClass=Object.assign({},Dc.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},E2=t=>{const e={popup:rt(),container:fr(),actions:Kf(),confirmButton:Go(),denyButton:vu(),cancelButton:ih(),loader:oh(),closeButton:v0(),validationMessage:mv(),progressSteps:w0()};return Mt.domCache.set(t,e),e},T2=(t,e,n)=>{const r=pv();Jn(r),e.timer&&(t.timeout=new o2(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(Hn(r),Jr(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&S0(e.timer)})))},M2=(t,e)=>{if(!e.toast){if(!gv(e.allowEnterKey)){FA("allowEnterKey"),x2();return}_2(t)||P2(t,e)||NS(-1,1)}},_2=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Nr(n))return n.focus(),!0;return!1},P2=(t,e)=>e.focusDeny&&Nr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Nr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Nr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,x2=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}hn.prototype.disableButtons=gH;hn.prototype.enableButtons=fH;hn.prototype.getInput=cH;hn.prototype.disableInput=pH;hn.prototype.enableInput=mH;hn.prototype.hideLoading=aw;hn.prototype.disableLoading=aw;hn.prototype.showValidationMessage=wH;hn.prototype.resetValidationMessage=vH;hn.prototype.close=_a;hn.prototype.closePopup=_a;hn.prototype.closeModal=_a;hn.prototype.closeToast=_a;hn.prototype.rejectPromise=sH;hn.prototype.update=RH;hn.prototype._destroy=EH;Object.assign(hn,i2);Object.keys($W).forEach(t=>{hn[t]=function(){return Do&&Do[t]?Do[t](...arguments):null}});hn.DismissReason=sh;hn.version="11.21.0";const yi=hn;yi.default=yi;typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var zs=function(){function t(){}return t.prototype.diff=function(e,n,r){r===void 0&&(r={});var i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);var o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)},t.prototype.diffWithOptionsObj=function(e,n,r,i){var o=this,s,a=function(x){if(x=o.postProcess(x,r),i){setTimeout(function(){i(x)},0);return}else return x},l=n.length,u=e.length,c=1,h=l+u;r.maxEditLength!=null&&(h=Math.min(h,r.maxEditLength));var d=(s=r.timeout)!==null&&s!==void 0?s:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],v=this.extractCommon(g[0],n,e,0,r);if(g[0].oldPos+1>=u&&v+1>=l)return a(this.buildValues(g[0].lastComponent,n,e));var y=-1/0,E=1/0,C=function(){for(var x=Math.max(y,-c);x<=Math.min(E,c);x+=2){var P=void 0,T=g[x-1],O=g[x+1];T&&(g[x-1]=void 0);var G=!1;if(O){var U=O.oldPos-x;G=O&&0<=U&&U<l}var V=T&&T.oldPos+1<u;if(!G&&!V){g[x]=void 0;continue}if(!V||G&&T.oldPos<O.oldPos?P=o.addToPath(O,!0,!1,0,r):P=o.addToPath(T,!1,!0,1,r),v=o.extractCommon(P,n,e,x,r),P.oldPos+1>=u&&v+1>=l)return a(o.buildValues(P.lastComponent,n,e))||!0;g[x]=P,P.oldPos+1>=u&&(E=Math.min(E,x-1)),v+1>=l&&(y=Math.max(y,x+1))}c++};if(i)(function x(){setTimeout(function(){if(c>h||Date.now()>f)return i(void 0);C()||x()},0)})();else for(;c<=h&&Date.now()<=f;){var M=C();if(M)return M}},t.prototype.addToPath=function(e,n,r,i,o){var s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}},t.prototype.extractCommon=function(e,n,r,i,o){for(var s=n.length,a=r.length,l=e.oldPos,u=l-i,c=0;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u},t.prototype.equals=function(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},t.prototype.removeEmpty=function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},t.prototype.castInput=function(e,n){return e},t.prototype.tokenize=function(e,n){return Array.from(e)},t.prototype.join=function(e){return e.join("")},t.prototype.postProcess=function(e,n){return e},Object.defineProperty(t.prototype,"useLongestToken",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.buildValues=function(e,n,r){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var s=i.length,a=0,l=0,u=0;a<s;a++){var c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){var h=n.slice(l,l+c.count);h=h.map(function(d,f){var g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i},t}(),I2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),O2=function(t){I2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(zs),IH=new O2;function A2(t,e,n){return IH.diff(t,e,n)}function mP(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function pP(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function kS(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function $S(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Th(t,e){return kS(t,e,"")}function Hg(t,e){return $S(t,e,"")}function wP(t,e){return e.slice(0,H2(t,e))}function H2(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var i=Array(r),o=0;i[0]=0;for(var s=1;s<r;s++){for(e[s]==e[o]?i[s]=i[o]:i[s]=o;o>0&&e[s]!=e[o];)o=i[o];e[s]==e[o]&&o++}o=0;for(var a=n;a<t.length;a++){for(;o>0&&t[a]!=e[o];)o=i[o];t[a]==e[o]&&o++}return o}function N2(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function D2(t){return!t.includes(`\r
`)&&t.includes(`
`)}function Mh(t){var e;for(e=t.length-1;e>=0&&t[e].match(/\s/);e--);return t.substring(e+1)}function Zs(t){var e=t.match(/^\s*/);return e?e[0]:""}var OH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),cw="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",k2=new RegExp("[".concat(cw,"]+|\\s+|[^").concat(cw,"]"),"ug"),$2=function(t){OH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.equals=function(n,r,i){return i.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()},e.prototype.tokenize=function(n,r){r===void 0&&(r={});var i;if(r.intlSegmenter){var o=r.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');i=Array.from(o.segment(n),function(l){return l.segment})}else i=n.match(k2)||[];var s=[],a=null;return i.forEach(function(l){/\s/.test(l)?a==null?s.push(l):s.push(s.pop()+l):a!=null&&/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+l):s.push(a+l):s.push(l),a=l}),s},e.prototype.join=function(n){return n.map(function(r,i){return i==0?r:r.replace(/^\s+/,"")}).join("")},e.prototype.postProcess=function(n,r){if(!n||r.oneChangePerToken)return n;var i=null,o=null,s=null;return n.forEach(function(a){a.added?o=a:a.removed?s=a:((o||s)&&vP(i,s,o,a),i=a,o=null,s=null)}),(o||s)&&vP(i,s,o,null),n},e}(zs),AH=new $2;function L2(t,e,n){return(n==null?void 0:n.ignoreWhitespace)!=null&&!n.ignoreWhitespace?NH(t,e,n):AH.diff(t,e,n)}function vP(t,e,n,r){if(e&&n){var i=Zs(e.value),o=Mh(e.value),s=Zs(n.value),a=Mh(n.value);if(t){var l=mP(i,s);t.value=$S(t.value,s,l),e.value=Th(e.value,l),n.value=Th(n.value,l)}if(r){var u=pP(o,a);r.value=kS(r.value,a,u),e.value=Hg(e.value,u),n.value=Hg(n.value,u)}}else if(n){if(t){var c=Zs(n.value);n.value=n.value.substring(c.length)}if(r){var c=Zs(r.value);r.value=r.value.substring(c.length)}}else if(t&&r){var h=Zs(r.value),d=Zs(e.value),f=Mh(e.value),g=mP(h,d);e.value=Th(e.value,g);var v=pP(Th(h,g),f);e.value=Hg(e.value,v),r.value=kS(r.value,h,v),t.value=$S(t.value,h,h.slice(0,h.length-v.length))}else if(r){var y=Zs(r.value),E=Mh(e.value),C=wP(E,y);e.value=Hg(e.value,C)}else if(t){var M=Mh(t.value),x=Zs(e.value),C=wP(M,x);e.value=Th(e.value,C)}}var F2=function(t){OH(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){var r=new RegExp("(\\r?\\n)|[".concat(cw,"]+|[^\\S\\n\\r]+|[^").concat(cw,"]"),"ug");return n.match(r)||[]},e}(zs),HH=new F2;function NH(t,e,n){return HH.diff(t,e,n)}function V2(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var B2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),W2=function(t){B2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=DH,n}return e.prototype.equals=function(n,r,i){return i.ignoreWhitespace?((!i.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),t.prototype.equals.call(this,n,r,i)},e}(zs),P0=new W2;function yf(t,e,n){return P0.diff(t,e,n)}function j2(t,e,n){return n=V2(n,{ignoreWhitespace:!0}),P0.diff(t,e,n)}function DH(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var U2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),z2=function(t){U2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(new RegExp("(?<=[.!?])(\\s+|$)"))},e}(zs),kH=new z2;function Y2(t,e,n){return kH.diff(t,e,n)}var G2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),K2=function(t){G2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)},e}(zs),$H=new K2;function q2(t,e,n){return $H.diff(t,e,n)}var X2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),J2=function(t){X2(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.tokenize=DH,n}return Object.defineProperty(e.prototype,"useLongestToken",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.castInput=function(n,r){var i=r.undefinedReplacement,o=r.stringifyReplacer,s=o===void 0?function(a,l){return typeof l>"u"?i:l}:o;return typeof n=="string"?n:JSON.stringify(hw(n,null,null,s),null,"  ")},e.prototype.equals=function(n,r,i){return t.prototype.equals.call(this,n.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"),i)},e}(zs),LH=new J2;function Z2(t,e,n){return LH.diff(t,e,n)}function hw(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i===void 0?"":i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=hw(t[o],e,n,r,String(o));return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),typeof t=="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=hw(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var Q2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ej=function(t){Q2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.tokenize=function(n){return n.slice()},e.prototype.join=function(n){return n},e.prototype.removeEmpty=function(n){return n},e}(zs),FH=new ej;function tj(t,e,n){return FH.diff(t,e,n)}var Wo=function(){return Wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Wo.apply(this,arguments)};function VH(t){return Array.isArray(t)?t.map(function(e){return VH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n,r){var i;return n.startsWith("\\")||n.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?n:n+"\r"})})})})}function BH(t){return Array.isArray(t)?t.map(function(e){return BH(e)}):Wo(Wo({},t),{hunks:t.hunks.map(function(e){return Wo(Wo({},e),{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function nj(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function rj(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,i){var o;return r.startsWith("\\")||r.endsWith("\r")||((o=n.lines[i+1])===null||o===void 0?void 0:o.startsWith("\\"))})})})}function x0(t){var e=t.split(/\n/),n=[],r=0;function i(){var a={};for(n.push(a);r<e.length;){var l=e[r];if(/^(---|\+\+\+|@@)\s/.test(l))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(l);u&&(a.index=u[1]),r++}for(o(a),o(a),a.hunks=[];r<e.length;){var l=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(l))break;if(/^@@/.test(l))a.hunks.push(s());else{if(l)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(l));r++}}}function o(a){var l=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(l){var u=l[2].split("	",2),c=(u[1]||"").trim(),h=u[0].replace(/\\\\/g,"\\");/^".*"$/.test(h)&&(h=h.substr(1,h.length-2)),l[1]==="---"?(a.oldFileName=h,a.oldHeader=c):(a.newFileName=h,a.newHeader=c),r++}}function s(){var a,l=r,u=e[r++],c=u.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),h={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};h.oldLines===0&&(h.oldStart+=1),h.newLines===0&&(h.newStart+=1);for(var d=0,f=0;r<e.length&&(f<h.oldLines||d<h.newLines||!((a=e[r])===null||a===void 0)&&a.startsWith("\\"));r++){var g=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(g==="+"||g==="-"||g===" "||g==="\\")h.lines.push(e[r]),g==="+"?d++:g==="-"?f++:g===" "&&(d++,f++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!d&&h.newLines===1&&(h.newLines=0),!f&&h.oldLines===1&&(h.oldLines=0),d!==h.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(f!==h.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return h}for(;r<e.length;)i();return n}function ij(t,e,n){var r=!0,i=!1,o=!1,s=1;return function a(){if(r&&!o){if(i?s++:r=!1,t+s<=n)return t+s;o=!0}if(!i)return o||(r=!0),e<=t-s?t-s++:(i=!0,a())}}function WH(t,e,n){n===void 0&&(n={});var r;if(typeof e=="string"?r=x0(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return oj(t,r[0],n)}function oj(t,e,n){n===void 0&&(n={}),(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(N2(t)&&nj(e)?e=VH(e):D2(t)&&rj(e)&&(e=BH(e)));var r=t.split(`
`),i=e.hunks,o=n.compareLine||function(G,U,V,X){return U===X},s=n.fuzzFactor||0,a=0;if(s<0||!Number.isInteger(s))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return t;for(var l="",u=!1,c=!1,h=0;h<i[i.length-1].lines.length;h++){var d=i[i.length-1].lines[h];d[0]=="\\"&&(l[0]=="+"?u=!0:l[0]=="-"&&(c=!0)),l=d}if(u){if(c){if(!s&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!s)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!s)return!1}function f(G,U,V,X,ne,Q,te){X===void 0&&(X=0),ne===void 0&&(ne=!0),Q===void 0&&(Q=[]),te===void 0&&(te=0);for(var pe=0,et=!1;X<G.length;X++){var Re=G[X],Ae=Re.length>0?Re[0]:" ",st=Re.length>0?Re.substr(1):Re;if(Ae==="-")if(o(U+1,r[U],Ae,st))U++,pe=0;else return!V||r[U]==null?null:(Q[te]=r[U],f(G,U+1,V-1,X,!1,Q,te+1));if(Ae==="+"){if(!ne)return null;Q[te]=st,te++,pe=0,et=!0}if(Ae===" ")if(pe++,Q[te]=r[U],o(U+1,r[U],Ae,st))te++,ne=!0,et=!1,U++;else return et||!V?null:r[U]&&(f(G,U+1,V-1,X+1,!1,Q,te+1)||f(G,U+1,V-1,X,!1,Q,te+1))||f(G,U,V-1,X+1,!1,Q,te)}return te-=pe,U-=pe,Q.length=te,{patchedLines:Q,oldLineLastI:U-1}}for(var g=[],v=0,h=0;h<i.length;h++){for(var y=i[h],E=void 0,C=r.length-y.oldLines+s,M=void 0,x=0;x<=s;x++){M=y.oldStart+v-1;for(var P=ij(M,a,C);M!==void 0&&(E=f(y.lines,M,x),!E);M=P());if(E)break}if(!E)return!1;for(var T=a;T<M;T++)g.push(r[T]);for(var O=0;O<E.patchedLines.length;O++){var d=E.patchedLines[O];g.push(d)}a=E.oldLineLastI+1,v=M+1-y.oldStart}for(var h=a;h<r.length;h++)g.push(r[h]);return g.join(`
`)}function sj(t,e){var n=typeof t=="string"?x0(t):t,r=0;function i(){var o=n[r++];if(!o)return e.complete();e.loadFile(o,function(s,a){if(s)return e.complete(s);var l=WH(a,o,e);e.patched(o,l,function(u){if(u)return e.complete(u);i()})})}i()}var dw=function(){return dw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},dw.apply(this,arguments)};function jH(t){return Array.isArray(t)?t.map(function(e){return jH(e)}).reverse():dw(dw({},t),{oldFileName:t.newFileName,oldHeader:t.newHeader,newFileName:t.oldFileName,newHeader:t.oldHeader,hunks:t.hunks.map(function(e){return{oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(function(n){return n.startsWith("-")?"+".concat(n.slice(1)):n.startsWith("+")?"-".concat(n.slice(1)):n})}})})}var Kc=function(){return Kc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Kc.apply(this,arguments)};function LS(t,e,n,r,i,o,s){var a;s?typeof s=="function"?a={callback:s}:a=s:a={},typeof a.context>"u"&&(a.context=4);var l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){var u=a.callback;yf(n,r,Kc(Kc({},a),{callback:function(h){var d=c(h);u(d)}}))}else return c(yf(n,r,a));function c(h){if(!h)return;h.push({value:"",lines:[]});function d(Ae){return Ae.map(function(st){return" "+st})}for(var f=[],g=0,v=0,y=[],E=1,C=1,M=0;M<h.length;M++){var x=h[M],P=x.lines||lj(x.value);if(x.lines=P,x.added||x.removed){if(!g){var T=h[M-1];g=E,v=C,T&&(y=l>0?d(T.lines.slice(-l)):[],g-=y.length,v-=y.length)}for(var O=0,G=P;O<G.length;O++){var U=G[O];y.push((x.added?"+":"-")+U)}x.added?C+=P.length:E+=P.length}else{if(g)if(P.length<=l*2&&M<h.length-2)for(var V=0,X=d(P);V<X.length;V++){var U=X[V];y.push(U)}else{for(var ne=Math.min(P.length,l),Q=0,te=d(P.slice(0,ne));Q<te.length;Q++){var U=te[Q];y.push(U)}var pe={oldStart:g,oldLines:E-g+ne,newStart:v,newLines:C-v+ne,lines:y};f.push(pe),g=0,v=0,y=[]}E+=P.length,C+=P.length}}for(var et=0,Re=f;et<Re.length;et++)for(var pe=Re[et],M=0;M<pe.lines.length;M++)pe.lines[M].endsWith(`
`)?pe.lines[M]=pe.lines[M].slice(0,-1):(pe.lines.splice(M+1,0,"\\ No newline at end of file"),M++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:f}}}function fw(t){if(Array.isArray(t))return t.map(fw).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(var i=0,o=r.lines;i<o.length;i++){var s=o[i];e.push(s)}}return e.join(`
`)+`
`}function UH(t,e,n,r,i,o,s){if(typeof s=="function"&&(s={callback:s}),s!=null&&s.callback){var l=s.callback;LS(t,e,n,r,i,o,Kc(Kc({},s),{callback:function(u){l(u?fw(u):void 0)}}))}else{var a=LS(t,e,n,r,i,o,s);return a?fw(a):void 0}}function aj(t,e,n,r,i,o){return UH(t,t,e,n,r,i,o)}function lj(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}function uj(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}function cj(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(hj(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function hj(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}const dj=Object.freeze(Object.defineProperty({__proto__:null,Diff:zs,applyPatch:WH,applyPatches:sj,arrayDiff:FH,canonicalize:hw,characterDiff:IH,convertChangesToDMP:uj,convertChangesToXML:cj,createPatch:aj,createTwoFilesPatch:UH,cssDiff:$H,diffArrays:tj,diffChars:A2,diffCss:q2,diffJson:Z2,diffLines:yf,diffSentences:Y2,diffTrimmedLines:j2,diffWords:L2,diffWordsWithSpace:NH,formatPatch:fw,jsonDiff:LH,lineDiff:P0,parsePatch:x0,reversePatch:jH,sentenceDiff:kH,structuredPatch:LS,wordDiff:AH,wordsWithSpaceDiff:HH},Symbol.toStringTag,{value:"Module"}));function fj(t){const{title:e="JSON Diff",jsonDiffData:n,buttons:r=[],hotInstance:i}=t;i&&typeof i.deselectCell=="function"&&i.deselectCell();let o="",s="",a=[];const l=(h,d=2)=>{const f=g=>{if(typeof g!="object"||g===null)return g;if(Array.isArray(g))return g.map(f);const v={};return Object.keys(g).forEach(y=>{v[y]=f(g[y])}),v};try{return JSON.stringify(f(h),null,d)}catch(g){return console.error("Error stringifying object while preserving key order:",g),JSON.stringify(h,null,d)}};function u(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(n&&n.left!==void 0&&n.right!==void 0)if(typeof dj>"u"||typeof yf!="function")s='<p class="diff-popup-error-message">Diff 라이브러리를 로드할 수 없습니다. (Diff is not defined)</p>',o='<div class="diff-popup-header error">라이브러리 오류</div>';else try{const h=l(n.left),d=l(n.right),f=yf(h,d);let g=0,v=0;f.forEach(V=>{const X=V.value||"",ne=X.split(`
`);let Q=ne.length;ne[ne.length-1]===""&&X.length>0&&Q--,X===""&&(Q=0),V.added?g+=Q:V.removed&&(v+=Q)});const y=[];let E=1,C=1;f.forEach((V,X)=>{const ne=V.value||"",Q=ne.split(`
`);let te=Q.length;Q[Q.length-1]===""&&ne.length>0&&te--,ne===""&&(te=0),V.removed?(y.push({originalPartIndex:X,part:V,sourceType:"del",lineNumber:E,numLines:te}),E+=te):V.added?(y.push({originalPartIndex:X,part:V,sourceType:"ins",lineNumber:C,numLines:te}),C+=te):(E+=te,C+=te)}),a=[];let M=[...y],x=null;for(M.length>0&&(M.sort((V,X)=>V.lineNumber!==X.lineNumber?V.lineNumber-X.lineNumber:V.sourceType==="del"&&X.sourceType!=="del"?-1:V.sourceType!=="del"&&X.sourceType==="del"?1:V.originalPartIndex-X.originalPartIndex),x=M[0],a.push(x),M=M.filter(V=>V.originalPartIndex!==x.originalPartIndex));M.length>0&&x;){const V=x.lineNumber;let X=null,ne=[];for(const Q of M)Q.lineNumber>=V&&ne.push({...Q,diff:Q.lineNumber-V});if(ne.length>0)ne.sort((Q,te)=>Q.diff!==te.diff?Q.diff-te.diff:Q.sourceType==="del"&&te.sourceType!=="del"?-1:Q.sourceType!=="del"&&te.sourceType==="del"?1:Q.originalPartIndex-te.originalPartIndex),X=ne[0];else{let Q=[];for(const te of M)Q.push({...te,absDiff:Math.abs(te.lineNumber-V)});Q.length>0&&(Q.sort((te,pe)=>te.absDiff!==pe.absDiff?te.absDiff-pe.absDiff:te.lineNumber!==pe.lineNumber?te.lineNumber-pe.lineNumber:te.sourceType==="del"&&pe.sourceType!=="del"?-1:te.sourceType!=="del"&&pe.sourceType==="del"?1:te.originalPartIndex-pe.originalPartIndex),X=Q[0])}if(X)a.push(X),x=X,M=M.filter(Q=>Q.originalPartIndex!==X.originalPartIndex);else break}let P="",T="",O=1,G=1;const U=new Map;if(a.forEach((V,X)=>U.set(V.originalPartIndex,X)),f.forEach((V,X)=>{const ne=V.value||"",Q=ne.replace(/\n$/,"").split(`
`);Q.length===1&&Q[0]===""&&ne===""||Q.forEach((te,pe)=>{let et="";(V.added||V.removed)&&pe===0&&U.has(X)&&(et=`id="diff-nav-target-${U.get(X)}"`),V.added?(P+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`,T+=`<div ${et} class="diff-sbs-line diff-added"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`):V.removed?(P+=`<div ${et} class="diff-sbs-line diff-removed"><span class="diff-sbs-line-num">${O++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line"><span class="diff-sbs-line-num"></span><span class="diff-sbs-line-content"></span></div>
`):(P+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${O++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`,T+=`<div class="diff-sbs-line diff-common"><span class="diff-sbs-line-num">${G++}</span><span class="diff-sbs-line-content">${u(te)}</span></div>
`)})}),s=`<div class="diff-sbs-container"><div class="diff-sbs-pane" id="diff-left-pane">${P}</div><div class="diff-sbs-pane" id="diff-right-pane">${T}</div></div>`,a.length>0||g>0||v>0){let V="";(g>0||v>0)&&(V=`<span class="diff-summary"><strong class="diff-summary-added">+${g}</strong> <strong class="diff-summary-removed">-${v}</strong></span>`),o=`<div class="diff-popup-header">JSON 비교 결과</div><div id="diff-navigation">${V}<button id="prev-change-btn" class="swal2-styled">이전 변경점</button><button id="next-change-btn" class="swal2-styled">다음 변경점</button><span id="current-change-info"></span></div>`}else o='<div class="diff-popup-header">JSON 비교 결과</div>',h===d?s='<p class="diff-no-changes-message">내용이 동일합니다. 변경 사항이 없습니다.</p>':s='<p class="diff-no-changes-message">변경 사항이 감지되지 않았지만 원본 문자열은 다릅니다.</p>'}catch(h){s=`<p class="diff-popup-error-message">JSON diff 표시에 오류 발생: ${h.message}</p>`,o='<div class="diff-popup-header error">오류 발생</div>'}else s='<p class="diff-no-data">Diff를 표시할 JSON 데이터가 제공되지 않았습니다.</p>',o='<div class="diff-popup-header error">데이터 오류</div>';const c=`${o}<div id="diff-container">${s}</div>`;return gj({title:e,html:c,buttons:r,width:"95%",customClass:{popup:"custom-swal-popup-wider-text-diff",htmlContainer:"custom-swal-html-container-text-diff"},didOpen:h=>{const d=[];if(a&&a.length>0)for(let P=0;P<a.length;P++){const T=document.getElementById(`diff-nav-target-${P}`);T&&d.push(T)}let f=-1,g=null;const v=document.getElementById("diff-navigation"),y=document.getElementById("next-change-btn"),E=document.getElementById("prev-change-btn"),C=document.getElementById("current-change-info");function M(){if(!v)return;const P=d.length===0;y&&(y.style.display=P?"none":"inline-block"),E&&(E.style.display=P?"none":"inline-block"),C&&(C.textContent=P?totalAdded>0||totalRemoved>0?"0 / 0":"변경점 없음":`${f+1} / ${d.length}`),y&&(y.disabled=f>=d.length-1),E&&(E.disabled=f<=0)}function x(P){if(P<0||P>=d.length)return;g&&g.classList.remove("diff-navigation-highlight");const T=d[P];if(T){const O=document.getElementById("diff-container");if(O){const G=T.offsetTop;O.scrollTop=G-O.clientHeight/2+T.clientHeight/2}else T.scrollIntoView({block:"center"});T.classList.add("diff-navigation-highlight"),g=T}f=P,M()}d.length>0?x(0):M(),y&&y.addEventListener("click",()=>{f<d.length-1&&x(f+1)}),E&&E.addEventListener("click",()=>{f>0&&x(f-1)}),h.addEventListener("keydown",P=>{d.length===0||!y||!E||(P.key==="ArrowDown"||P.key==="PageDown"?(P.preventDefault(),y.disabled||y.click()):(P.key==="ArrowUp"||P.key==="PageUp")&&(P.preventDefault(),E.disabled||E.click()))}),M()}})}async function Vl(t){const{title:e,inputLabel:n,inputValue:r="",inputPlaceholder:i="",inputValidator:o,confirmButtonText:s="확인",cancelButtonText:a="취소",showCancelButton:l=!0,customClass:u={},html:c,hotInstance:h}=t;h&&typeof h.deselectCell=="function"&&h.deselectCell();let d=c||"";return n&&!c&&(d=`<label style="display: block; text-align: left; margin-bottom: .5em; font-weight: normal;">${n}</label>`),yi.fire({title:e,html:d,input:"text",inputValue:r,inputPlaceholder:i,inputValidator:o,showCancelButton:l,confirmButtonText:s,cancelButtonText:a,customClass:u,didOpen:()=>{const f=yi.getInput();f&&(f.focus(),typeof f.select=="function"&&f.select())}})}async function tt(t){const{title:e,text:n="",html:r="",icon:i="warning",confirmButtonText:o="확인",cancelButtonText:s="취소",showCancelButton:a=!0,customClass:l={},hotInstance:u}=t;return u&&typeof u.deselectCell=="function"&&u.deselectCell(),yi.fire({title:e,text:n,html:r,icon:i,showCancelButton:a,confirmButtonText:o,cancelButtonText:s,customClass:l})}function gj(t){const{title:e,html:n,icon:r,buttons:i=[],width:o="32em",padding:s="1em",customClass:a={},preConfirm:l,didOpen:u}=t,c={title:e,html:n,icon:r,width:o,padding:s,showConfirmButton:!0,showCancelButton:!1,customClass:a,preConfirm:l,didOpen:u},h=i.find(g=>g.role==="confirm"||!g.role&&i.indexOf(g)===0),d=i.find(g=>g.role==="cancel");return h?(c.showConfirmButton=!0,c.confirmButtonText=h.text||yi.getConfirmButton().innerText,h.color&&(c.confirmButtonColor=h.color)):i.length>0||l?!i.some(g=>g.role!=="cancel")&&!l&&(c.showConfirmButton=!1):c.showConfirmButton=!1,d&&(c.showCancelButton=!0,c.cancelButtonText=d.text||yi.getCancelButton().innerText,d.color&&(c.cancelButtonColor=d.color)),typeof yi>"u"?Promise.reject("SweetAlert2 is not imported"):yi.fire(c).then(g=>{let v={...g,formData:{}};return g.isConfirmed&&l&&(v.formData=g.value||{}),g.isConfirmed&&h&&typeof h.action=="function"&&!l?h.action():g.isDismissed&&d&&typeof d.action=="function"&&g.dismiss===yi.DismissReason.cancel&&d.action(),v})}const sn=document.getElementById("json-input"),qr=document.getElementById("save-message"),en=document.getElementById("json-error"),Et=document.getElementById("tree-view"),FS=document.getElementById("table-view");function nu(t,e,n){t&&(t.textContent=e,setTimeout(()=>{t.textContent=""},n))}function kc(t,e){const n=document.querySelectorAll("h2");let r=null;if(n.forEach(a=>{a.textContent&&a.textContent.includes("데이터 테이블 뷰")&&(r=a)}),!r)return;let i=document.getElementById("table-view-current-path-display");i||(i=document.createElement("span"),i.id="table-view-current-path-display",i.style.marginLeft="10px",i.style.fontSize="0.8em",i.style.fontWeight="normal",r.appendChild(i)),i.innerHTML="";const o="(현재 경로: ",s=")";if(i.appendChild(document.createTextNode(o)),e){const a=document.createElement("a");a.href="#",a.textContent="root",a.style.textDecoration="underline",a.style.cursor="pointer",a.onclick=l=>{l.preventDefault(),e("")},i.appendChild(a)}else i.appendChild(document.createTextNode("root"));if(t&&t!==""){let a="";const l=/([^[.]+)|(\[[^\]]+\])/g;let u;for(;(u=l.exec(t))!==null;){const c=u[0];let h=c;if(a===""?a=c:c.startsWith("[")?a+=c:a+="."+c,i.appendChild(document.createTextNode(" > ")),e){const d=document.createElement("a");d.href="#",d.textContent=h,d.style.textDecoration="underline",d.style.cursor="pointer",d.onclick=(f=>g=>{g.preventDefault(),e(f)})(a),i.appendChild(d)}else i.appendChild(document.createTextNode(h))}}i.appendChild(document.createTextNode(s))}function mj(){Et&&(Et.innerHTML=""),FS&&(FS.innerHTML=""),en&&(en.textContent=""),qr&&(qr.textContent=""),kc(null,null)}function au(t,e){if(!e)return t;const n=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function VS(t,e){if(typeof t=="string"){const n=t.trim();if(n.toLowerCase()==="null")return null;if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1;if(n!==""&&!isNaN(Number(n))&&(typeof e=="number"||n.includes(".")||/^-?\d+$/.test(n)||String(Number(n))===n.replace(/^0+(?=\d)/,"")))return Number(n);if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n)}catch{return t}return t}return t}function zH(t,e){let n=String(e),r="";typeof e=="string"?(n=`"${e}"`,r="#28a745"):typeof e=="number"?r="#17a2b8":typeof e=="boolean"?r="#fd7e14":e===null&&(n="null",r="#6c757d"),t.textContent=n,r?t.style.color=r:t.style.color=""}let zl=null;function qc(t){zl&&zl.classList.remove("selected-node"),zl=t,zl&&zl.classList.add("selected-node")}function pj(t,e,n,r){const i=document.createElement("div");i.classList.add("tree-node"),i.dataset.path=n;const o=document.createElement("span");o.classList.add("toggle-icon"),i.appendChild(o);const s=document.createElement("span");s.classList.add("node-text-wrapper"),i.appendChild(s);const a=document.createElement("span");if(a.classList.add("tree-node-key"),a.textContent=`${t}: `,s.appendChild(a),typeof e=="object"&&e!==null){const l=document.createElement("span");l.classList.add("tree-node-type"),l.textContent=Array.isArray(e)?`[Array (${e.length})]`:"{Object}",s.appendChild(l);const u=Object.keys(e).length>0;o.textContent=u?"▶":" ",s.onclick=c=>{c.stopPropagation(),qc(i),r.displayTableCallback(e,t,r.rootJsonData,n)}}else{o.innerHTML="&nbsp;";const l=document.createElement("span");l.classList.add("tree-node-value"),zH(l,e),s.appendChild(l),s.onclick=u=>{u.stopPropagation(),qc(i);const c=n.lastIndexOf("."),h=c===-1?"":n.substring(0,c),d=h.split(".").pop()||(Object.keys(r.rootJsonData)[0]===t&&r.depth===0?"root":""),f=r.getObjectByPathCallback(r.rootJsonData,h);if(f&&typeof f=="object")r.displayTableCallback(f,d,r.rootJsonData,h);else{const g={[t]:e};r.displayTableCallback(g,"root",r.rootJsonData,n)}}}return i}function wj(t,e,n,r){if(!(Object.keys(e).length>0))return null;const o=document.createElement("div");o.classList.add("tree-node-children"),o.style.display="none";const s=t.querySelector(".toggle-icon");return s&&(s.onclick=a=>{a.stopPropagation();const l=o.style.display==="none";o.style.display=l?"block":"none",s.textContent=l?"▼":"▶"}),Cf(e,o,n,r.rootJsonData,r.depth+1,r),o}function Cf(t,e,n,r,i,o){Object.keys(t).forEach(s=>{const a=t[s],l=n?`${n}.${s}`:s,u=document.createElement("div"),c=pj(s,a,l,{...o,rootJsonData:r,depth:i});if(u.appendChild(c),typeof a=="object"&&a!==null){const h=wj(c,a,l,{...o,rootJsonData:r,depth:i});h&&u.appendChild(h)}e.appendChild(u)})}function vj(){return zl?zl.dataset.path:null}function yj(t){const e=new Set;return t.querySelectorAll(".tree-node .toggle-icon").forEach(r=>{if(r.textContent==="▼"){const i=r.closest(".tree-node");i&&i.dataset.path&&e.add(i.dataset.path)}}),e}function Cj(t,e){!e||e.size===0||e.forEach(n=>{const r=t.querySelector(`.tree-node[data-path="${n}"]`);if(r){const i=r.querySelector(".toggle-icon"),o=r.nextElementSibling;i&&o&&o.classList.contains("tree-node-children")&&o.style.display==="none"&&(o.style.display="block",i.textContent="▼")}})}var Ng=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_h=function(t){return t&&t.Math===Math&&t},vn=_h(typeof globalThis=="object"&&globalThis)||_h(typeof window=="object"&&window)||_h(typeof self=="object"&&self)||_h(typeof Ng=="object"&&Ng)||_h(typeof Ng=="object"&&Ng)||function(){return this}()||Function("return this")(),I0={},Nn=function(t){try{return!!t()}catch{return!0}},bj=Nn,Ti=!bj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Sj=Nn,yv=!Sj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Rj=yv,Dg=Function.prototype.call,yn=Rj?Dg.bind(Dg):function(){return Dg.apply(Dg,arguments)},YH={},GH={}.propertyIsEnumerable,KH=Object.getOwnPropertyDescriptor,Ej=KH&&!GH.call({1:2},1);YH.f=Ej?function(e){var n=KH(this,e);return!!n&&n.enumerable}:GH;var Cv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},qH=yv,XH=Function.prototype,BS=XH.call,Tj=qH&&XH.bind.bind(BS,BS),dn=qH?Tj:function(t){return function(){return BS.apply(t,arguments)}},JH=dn,Mj=JH({}.toString),_j=JH("".slice),yu=function(t){return _j(Mj(t),8,-1)},Pj=dn,xj=Nn,Ij=yu,_y=Object,Oj=Pj("".split),Aj=xj(function(){return!_y("z").propertyIsEnumerable(0)})?function(t){return Ij(t)==="String"?Oj(t,""):_y(t)}:_y,O0=function(t){return t==null},Hj=O0,Nj=TypeError,Zf=function(t){if(Hj(t))throw new Nj("Can't call method on "+t);return t},Dj=Aj,kj=Zf,Qf=function(t){return Dj(kj(t))},Py=typeof document=="object"&&document.all,Cn=typeof Py>"u"&&Py!==void 0?function(t){return typeof t=="function"||t===Py}:function(t){return typeof t=="function"},$j=Cn,Mi=function(t){return typeof t=="object"?t!==null:$j(t)},xy=vn,Lj=Cn,Fj=function(t){return Lj(t)?t:void 0},ah=function(t,e){return arguments.length<2?Fj(xy[t]):xy[t]&&xy[t][e]},Vj=dn,eg=Vj({}.isPrototypeOf),Bj=vn,yP=Bj.navigator,CP=yP&&yP.userAgent,bv=CP?String(CP):"",ZH=vn,Iy=bv,bP=ZH.process,SP=ZH.Deno,RP=bP&&bP.versions||SP&&SP.version,EP=RP&&RP.v8,Ji,gw;EP&&(Ji=EP.split("."),gw=Ji[0]>0&&Ji[0]<4?1:+(Ji[0]+Ji[1]));!gw&&Iy&&(Ji=Iy.match(/Edge\/(\d+)/),(!Ji||Ji[1]>=74)&&(Ji=Iy.match(/Chrome\/(\d+)/),Ji&&(gw=+Ji[1])));var Wj=gw,TP=Wj,jj=Nn,Uj=vn,zj=Uj.String,A0=!!Object.getOwnPropertySymbols&&!jj(function(){var t=Symbol("symbol detection");return!zj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&TP&&TP<41}),Yj=A0,QH=Yj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Gj=ah,Kj=Cn,qj=eg,Xj=QH,Jj=Object,H0=Xj?function(t){return typeof t=="symbol"}:function(t){var e=Gj("Symbol");return Kj(e)&&qj(e.prototype,Jj(t))},Zj=String,Sv=function(t){try{return Zj(t)}catch{return"Object"}},Qj=Cn,eU=Sv,tU=TypeError,Dr=function(t){if(Qj(t))return t;throw new tU(eU(t)+" is not a function")},nU=Dr,rU=O0,tg=function(t,e){var n=t[e];return rU(n)?void 0:nU(n)},Oy=yn,Ay=Cn,Hy=Mi,iU=TypeError,oU=function(t,e){var n,r;if(e==="string"&&Ay(n=t.toString)&&!Hy(r=Oy(n,t))||Ay(n=t.valueOf)&&!Hy(r=Oy(n,t))||e!=="string"&&Ay(n=t.toString)&&!Hy(r=Oy(n,t)))return r;throw new iU("Can't convert object to primitive value")},eN={exports:{}},MP=vn,sU=Object.defineProperty,N0=function(t,e){try{sU(MP,t,{value:e,configurable:!0,writable:!0})}catch{MP[t]=e}return e},aU=vn,lU=N0,_P="__core-js_shared__",PP=eN.exports=aU[_P]||lU(_P,{});(PP.versions||(PP.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var D0=eN.exports,xP=D0,tN=function(t,e){return xP[t]||(xP[t]=e||{})},uU=Zf,cU=Object,lh=function(t){return cU(uU(t))},hU=dn,dU=lh,fU=hU({}.hasOwnProperty),_i=Object.hasOwn||function(e,n){return fU(dU(e),n)},gU=dn,mU=0,pU=Math.random(),wU=gU(1 .toString),nN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+wU(++mU+pU,36)},vU=vn,yU=tN,IP=_i,CU=nN,bU=A0,SU=QH,_c=vU.Symbol,Ny=yU("wks"),RU=SU?_c.for||_c:_c&&_c.withoutSetter||CU,so=function(t){return IP(Ny,t)||(Ny[t]=bU&&IP(_c,t)?_c[t]:RU("Symbol."+t)),Ny[t]},EU=yn,OP=Mi,AP=H0,TU=tg,MU=oU,_U=so,PU=TypeError,xU=_U("toPrimitive"),IU=function(t,e){if(!OP(t)||AP(t))return t;var n=TU(t,xU),r;if(n){if(e===void 0&&(e="default"),r=EU(n,t,e),!OP(r)||AP(r))return r;throw new PU("Can't convert object to primitive value")}return e===void 0&&(e="number"),MU(t,e)},OU=IU,AU=H0,rN=function(t){var e=OU(t,"string");return AU(e)?e:e+""},HU=vn,HP=Mi,WS=HU.document,NU=HP(WS)&&HP(WS.createElement),k0=function(t){return NU?WS.createElement(t):{}},DU=Ti,kU=Nn,$U=k0,iN=!DU&&!kU(function(){return Object.defineProperty($U("div"),"a",{get:function(){return 7}}).a!==7}),LU=Ti,FU=yn,VU=YH,BU=Cv,WU=Qf,jU=rN,UU=_i,zU=iN,NP=Object.getOwnPropertyDescriptor;I0.f=LU?NP:function(e,n){if(e=WU(e),n=jU(n),zU)try{return NP(e,n)}catch{}if(UU(e,n))return BU(!FU(VU.f,e,n),e[n])};var Ys={},YU=Ti,GU=Nn,oN=YU&&GU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),KU=Mi,qU=String,XU=TypeError,bn=function(t){if(KU(t))return t;throw new XU(qU(t)+" is not an object")},JU=Ti,ZU=iN,QU=oN,kg=bn,DP=rN,ez=TypeError,Dy=Object.defineProperty,tz=Object.getOwnPropertyDescriptor,ky="enumerable",$y="configurable",Ly="writable";Ys.f=JU?QU?function(e,n,r){if(kg(e),n=DP(n),kg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Ly in r&&!r[Ly]){var i=tz(e,n);i&&i[Ly]&&(e[n]=r.value,r={configurable:$y in r?r[$y]:i[$y],enumerable:ky in r?r[ky]:i[ky],writable:!1})}return Dy(e,n,r)}:Dy:function(e,n,r){if(kg(e),n=DP(n),kg(r),ZU)try{return Dy(e,n,r)}catch{}if("get"in r||"set"in r)throw new ez("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var nz=Ti,rz=Ys,iz=Cv,uh=nz?function(t,e,n){return rz.f(t,e,iz(1,n))}:function(t,e,n){return t[e]=n,t},sN={exports:{}},jS=Ti,oz=_i,aN=Function.prototype,sz=jS&&Object.getOwnPropertyDescriptor,az=oz(aN,"name"),lz=az&&(!jS||jS&&sz(aN,"name").configurable),uz={CONFIGURABLE:lz},cz=dn,hz=Cn,US=D0,dz=cz(Function.toString);hz(US.inspectSource)||(US.inspectSource=function(t){return dz(t)});var fz=US.inspectSource,gz=vn,mz=Cn,kP=gz.WeakMap,pz=mz(kP)&&/native code/.test(String(kP)),wz=tN,vz=nN,$P=wz("keys"),$0=function(t){return $P[t]||($P[t]=vz(t))},L0={},yz=pz,lN=vn,Cz=Mi,bz=uh,Fy=_i,Vy=D0,Sz=$0,Rz=L0,LP="Object already initialized",zS=lN.TypeError,Ez=lN.WeakMap,mw,bf,pw,Tz=function(t){return pw(t)?bf(t):mw(t,{})},Mz=function(t){return function(e){var n;if(!Cz(e)||(n=bf(e)).type!==t)throw new zS("Incompatible receiver, "+t+" required");return n}};if(yz||Vy.state){var ho=Vy.state||(Vy.state=new Ez);ho.get=ho.get,ho.has=ho.has,ho.set=ho.set,mw=function(t,e){if(ho.has(t))throw new zS(LP);return e.facade=t,ho.set(t,e),e},bf=function(t){return ho.get(t)||{}},pw=function(t){return ho.has(t)}}else{var Hu=Sz("state");Rz[Hu]=!0,mw=function(t,e){if(Fy(t,Hu))throw new zS(LP);return e.facade=t,bz(t,Hu,e),e},bf=function(t){return Fy(t,Hu)?t[Hu]:{}},pw=function(t){return Fy(t,Hu)}}var uN={set:mw,get:bf,has:pw,enforce:Tz,getterFor:Mz},F0=dn,_z=Nn,Pz=Cn,$g=_i,YS=Ti,xz=uz.CONFIGURABLE,Iz=fz,cN=uN,Oz=cN.enforce,Az=cN.get,FP=String,Mp=Object.defineProperty,Hz=F0("".slice),Nz=F0("".replace),Dz=F0([].join),kz=YS&&!_z(function(){return Mp(function(){},"length",{value:8}).length!==8}),$z=String(String).split("String"),Lz=sN.exports=function(t,e,n){Hz(FP(e),0,7)==="Symbol("&&(e="["+Nz(FP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!$g(t,"name")||xz&&t.name!==e)&&(YS?Mp(t,"name",{value:e,configurable:!0}):t.name=e),kz&&n&&$g(n,"arity")&&t.length!==n.arity&&Mp(t,"length",{value:n.arity});try{n&&$g(n,"constructor")&&n.constructor?YS&&Mp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Oz(t);return $g(r,"source")||(r.source=Dz($z,typeof e=="string"?e:"")),t};Function.prototype.toString=Lz(function(){return Pz(this)&&Az(this).source||Iz(this)},"toString");var hN=sN.exports,Fz=Cn,Vz=Ys,Bz=hN,Wz=N0,V0=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Fz(n)&&Bz(n,o,r),r.global)i?t[e]=n:Wz(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Vz.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},dN={},jz=Math.ceil,Uz=Math.floor,zz=Math.trunc||function(e){var n=+e;return(n>0?Uz:jz)(n)},Yz=zz,ng=function(t){var e=+t;return e!==e||e===0?0:Yz(e)},Gz=ng,Kz=Math.max,qz=Math.min,Xz=function(t,e){var n=Gz(t);return n<0?Kz(n+e,0):qz(n,e)},Jz=ng,Zz=Math.min,Qz=function(t){var e=Jz(t);return e>0?Zz(e,9007199254740991):0},eY=Qz,ch=function(t){return eY(t.length)},tY=Qf,nY=Xz,rY=ch,iY=function(t){return function(e,n,r){var i=tY(e),o=rY(i);if(o===0)return!t&&-1;var s=nY(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},oY={indexOf:iY(!1)},sY=dn,By=_i,aY=Qf,lY=oY.indexOf,uY=L0,VP=sY([].push),fN=function(t,e){var n=aY(t),r=0,i=[],o;for(o in n)!By(uY,o)&&By(n,o)&&VP(i,o);for(;e.length>r;)By(n,o=e[r++])&&(~lY(i,o)||VP(i,o));return i},B0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],cY=fN,hY=B0,dY=hY.concat("length","prototype");dN.f=Object.getOwnPropertyNames||function(e){return cY(e,dY)};var gN={};gN.f=Object.getOwnPropertySymbols;var fY=ah,gY=dn,mY=dN,pY=gN,wY=bn,vY=gY([].concat),yY=fY("Reflect","ownKeys")||function(e){var n=mY.f(wY(e)),r=pY.f;return r?vY(n,r(e)):n},BP=_i,CY=yY,bY=I0,SY=Ys,mN=function(t,e,n){for(var r=CY(e),i=SY.f,o=bY.f,s=0;s<r.length;s++){var a=r[s];!BP(t,a)&&!(n&&BP(n,a))&&i(t,a,o(e,a))}},RY=Nn,EY=Cn,TY=/#|\.prototype\./,rg=function(t,e){var n=_Y[MY(t)];return n===xY?!0:n===PY?!1:EY(e)?RY(e):!!e},MY=rg.normalize=function(t){return String(t).replace(TY,".").toLowerCase()},_Y=rg.data={},PY=rg.NATIVE="N",xY=rg.POLYFILL="P",IY=rg,Lg=vn,OY=I0.f,AY=uh,HY=V0,NY=N0,DY=mN,kY=IY,Ct=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Lg:i?s=Lg[n]||NY(n,{}):s=Lg[n]&&Lg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=OY(s,a),l=c&&c.value):l=s[a],o=kY(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;DY(u,l)}(t.sham||l&&l.sham)&&AY(u,"sham",!0),HY(s,a,u,t)}},$Y=yv,pN=Function.prototype,WP=pN.apply,jP=pN.call,ig=typeof Reflect=="object"&&Reflect.apply||($Y?jP.bind(WP):function(){return jP.apply(WP,arguments)}),LY=dn,FY=Dr,wN=function(t,e,n){try{return LY(FY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},VY=Mi,BY=function(t){return VY(t)||t===null},WY=BY,jY=String,UY=TypeError,zY=function(t){if(WY(t))return t;throw new UY("Can't set "+jY(t)+" as a prototype")},YY=wN,GY=Mi,KY=Zf,qY=zY,vN=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=YY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return KY(i),qY(o),GY(i)&&(t?n(i,o):i.__proto__=o),i}}():void 0),XY=Ys.f,JY=function(t,e,n){n in t||XY(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},ZY=Cn,QY=Mi,UP=vN,eG=function(t,e,n){var r,i;return UP&&ZY(r=e.constructor)&&r!==n&&QY(i=r.prototype)&&i!==n.prototype&&UP(t,i),t},tG=so,nG=tG("toStringTag"),yN={};yN[nG]="z";var rG=String(yN)==="[object z]",iG=rG,oG=Cn,_p=yu,sG=so,aG=sG("toStringTag"),lG=Object,uG=_p(function(){return arguments}())==="Arguments",cG=function(t,e){try{return t[e]}catch{}},CN=iG?_p:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=cG(e=lG(t),aG))=="string"?n:uG?_p(e):(r=_p(e))==="Object"&&oG(e.callee)?"Arguments":r},hG=CN,dG=String,Rv=function(t){if(hG(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return dG(t)},fG=Rv,gG=function(t,e){return t===void 0?arguments.length<2?"":e:fG(t)},mG=Mi,pG=uh,wG=function(t,e){mG(e)&&"cause"in e&&pG(t,"cause",e.cause)},vG=dn,bN=Error,yG=vG("".replace),CG=function(t){return String(new bN(t).stack)}("zxcasd"),SN=/\n\s*at [^:]*:[^\n]*/,bG=SN.test(CG),SG=function(t,e){if(bG&&typeof t=="string"&&!bN.prepareStackTrace)for(;e--;)t=yG(t,SN,"");return t},RG=Nn,EG=Cv,TG=!RG(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",EG(1,7)),t.stack!==7):!0}),MG=uh,_G=SG,PG=TG,zP=Error.captureStackTrace,xG=function(t,e,n,r){PG&&(zP?zP(t,e):MG(t,"stack",_G(n,r)))},YP=ah,IG=_i,GP=uh,OG=eg,KP=vN,qP=mN,XP=JY,AG=eG,HG=gG,NG=wG,DG=xG,kG=Ti,$G=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=YP.apply(null,s);if(l){var u=l.prototype;if(IG(u,"cause")&&delete u.cause,!n)return l;var c=YP("Error"),h=e(function(d,f){var g=HG(r?f:d,void 0),v=r?new l(d):new l;return g!==void 0&&GP(v,"message",g),DG(v,h,v.stack,2),this&&OG(u,this)&&AG(v,this,h),arguments.length>o&&NG(v,arguments[o]),v});h.prototype=u,a!=="Error"?KP?KP(h,c):qP(h,c,{name:!0}):kG&&i in l&&(XP(h,l,i),XP(h,l,"prepareStackTrace")),qP(h,l);try{u.name!==a&&GP(u,"name",a),u.constructor=h}catch{}return h}},RN=Ct,LG=vn,Xo=ig,EN=$G,GS="WebAssembly",JP=LG[GS],ww=new Error("e",{cause:7}).cause!==7,Cu=function(t,e){var n={};n[t]=EN(t,e,ww),RN({global:!0,constructor:!0,arity:1,forced:ww},n)},W0=function(t,e){if(JP&&JP[t]){var n={};n[t]=EN(GS+"."+t,e,ww),RN({target:GS,stat:!0,constructor:!0,arity:1,forced:ww},n)}};Cu("Error",function(t){return function(n){return Xo(t,this,arguments)}});Cu("EvalError",function(t){return function(n){return Xo(t,this,arguments)}});Cu("RangeError",function(t){return function(n){return Xo(t,this,arguments)}});Cu("ReferenceError",function(t){return function(n){return Xo(t,this,arguments)}});Cu("SyntaxError",function(t){return function(n){return Xo(t,this,arguments)}});Cu("TypeError",function(t){return function(n){return Xo(t,this,arguments)}});Cu("URIError",function(t){return function(n){return Xo(t,this,arguments)}});W0("CompileError",function(t){return function(n){return Xo(t,this,arguments)}});W0("LinkError",function(t){return function(n){return Xo(t,this,arguments)}});W0("RuntimeError",function(t){return function(n){return Xo(t,this,arguments)}});var FG=yu,TN=Array.isArray||function(e){return FG(e)==="Array"},VG=Ti,BG=TN,WG=TypeError,jG=Object.getOwnPropertyDescriptor,UG=VG&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),MN=UG?function(t,e){if(BG(t)&&!jG(t,"length").writable)throw new WG("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},zG=TypeError,YG=9007199254740991,_N=function(t){if(t>YG)throw zG("Maximum allowed index exceeded");return t},GG=Ct,KG=lh,qG=ch,XG=MN,JG=_N,ZG=Nn,QG=ZG(function(){return[].push.call({length:4294967296},1)!==4294967297}),eK=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},tK=QG||!eK();GG({target:"Array",proto:!0,arity:1,forced:tK},{push:function(e){var n=KG(this),r=qG(n),i=arguments.length;JG(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return XG(n,r),r}});var nK=yu,rK=dn,iK=function(t){if(nK(t)==="Function")return rK(t)},ZP=iK,oK=Dr,sK=yv,aK=ZP(ZP.bind),PN=function(t,e){return oK(t),e===void 0?t:sK?aK(t,e):function(){return t.apply(e,arguments)}},xN={},lK=so,uK=xN,cK=lK("iterator"),hK=Array.prototype,dK=function(t){return t!==void 0&&(uK.Array===t||hK[cK]===t)},fK=CN,QP=tg,gK=O0,mK=xN,pK=so,wK=pK("iterator"),j0=function(t){if(!gK(t))return QP(t,wK)||QP(t,"@@iterator")||mK[fK(t)]},vK=yn,yK=Dr,CK=bn,bK=Sv,SK=j0,RK=TypeError,EK=function(t,e){var n=arguments.length<2?SK(t):e;if(yK(n))return CK(vK(n,t));throw new RK(bK(t)+" is not iterable")},TK=yn,ex=bn,MK=tg,ei=function(t,e,n){var r,i;ex(t);try{if(r=MK(t,"return"),!r){if(e==="throw")throw n;return n}r=TK(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return ex(r),n},_K=PN,PK=yn,xK=bn,IK=Sv,OK=dK,AK=ch,tx=eg,HK=EK,NK=j0,nx=ei,DK=TypeError,Pp=function(t,e){this.stopped=t,this.result=e},rx=Pp.prototype,hh=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=_K(e,r),u,c,h,d,f,g,v,y=function(C){return u&&nx(u,"normal",C),new Pp(!0,C)},E=function(C){return i?(xK(C),a?l(C[0],C[1],y):l(C[0],C[1])):a?l(C,y):l(C)};if(o)u=t.iterator;else if(s)u=t;else{if(c=NK(t),!c)throw new DK(IK(t)+" is not iterable");if(OK(c)){for(h=0,d=AK(t);d>h;h++)if(f=E(t[h]),f&&tx(rx,f))return f;return new Pp(!1)}u=HK(t,c)}for(g=o?t.next:u.next;!(v=PK(g,u)).done;){try{f=E(v.value)}catch(C){nx(u,"throw",C)}if(typeof f=="object"&&f&&tx(rx,f))return f}return new Pp(!1)},kK=Ti,$K=Ys,LK=Cv,IN=function(t,e,n){kK?$K.f(t,e,LK(0,n)):t[e]=n},FK=Ct,VK=hh,BK=IN;FK({target:"Object",stat:!0},{fromEntries:function(e){var n={};return VK(e,function(r,i){BK(n,r,i)},{AS_ENTRIES:!0}),n}});var Wy=dn,Fg=Set.prototype,Jo={Set,add:Wy(Fg.add),has:Wy(Fg.has),remove:Wy(Fg.delete),proto:Fg},WK=Jo.has,bu=function(t){return WK(t),t},jK=yn,Su=function(t,e,n){for(var r=n?t:t.iterator,i=t.next,o,s;!(o=jK(i,r)).done;)if(s=e(o.value),s!==void 0)return s},ON=dn,UK=Su,AN=Jo,zK=AN.Set,HN=AN.proto,YK=ON(HN.forEach),NN=ON(HN.keys),GK=NN(new zK).next,og=function(t,e,n){return n?UK({iterator:NN(t),next:GK},e):YK(t,e)},DN=Jo,KK=og,qK=DN.Set,XK=DN.add,U0=function(t){var e=new qK;return KK(t,function(n){XK(e,n)}),e},JK=wN,ZK=Jo,sg=JK(ZK.proto,"size","get")||function(t){return t.size},Zo=function(t){return{iterator:t,next:t.next,done:!1}},ix=Dr,kN=bn,ox=yn,QK=ng,e3=Zo,sx="Invalid size",t3=RangeError,n3=TypeError,r3=Math.max,$N=function(t,e){this.set=t,this.size=r3(e,0),this.has=ix(t.has),this.keys=ix(t.keys)};$N.prototype={getIterator:function(){return e3(kN(ox(this.keys,this.set)))},includes:function(t){return ox(this.has,this.set,t)}};var Ru=function(t){kN(t);var e=+t.size;if(e!==e)throw new n3(sx);var n=QK(e);if(n<0)throw new t3(sx);return new $N(t,n)},i3=bu,LN=Jo,o3=U0,s3=sg,a3=Ru,l3=og,u3=Su,c3=LN.has,ax=LN.remove,h3=function(e){var n=i3(this),r=a3(e),i=o3(n);return s3(n)<=r.size?l3(n,function(o){r.includes(o)&&ax(i,o)}):u3(r.getIterator(),function(o){c3(n,o)&&ax(i,o)}),i},d3=ah,lx=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ux=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Eu=function(t,e){var n=d3("Set");try{new n()[t](lx(0));try{return new n()[t](lx(-1)),!1}catch{if(!e)return!0;try{return new n()[t](ux(-1/0)),!1}catch{var r=new n;return r.add(1),r.add(2),e(r[t](ux(1/0)))}}}catch{return!1}},f3=Ct,g3=h3,m3=Eu,p3=!m3("difference",function(t){return t.size===0});f3({target:"Set",proto:!0,real:!0,forced:p3},{difference:g3});var w3=bu,z0=Jo,v3=sg,y3=Ru,C3=og,b3=Su,S3=z0.Set,cx=z0.add,R3=z0.has,E3=function(e){var n=w3(this),r=y3(e),i=new S3;return v3(n)>r.size?b3(r.getIterator(),function(o){R3(n,o)&&cx(i,o)}):C3(n,function(o){r.includes(o)&&cx(i,o)}),i},T3=Ct,M3=Nn,_3=E3,P3=Eu,x3=!P3("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||M3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});T3({target:"Set",proto:!0,real:!0,forced:x3},{intersection:_3});var I3=bu,O3=Jo.has,A3=sg,H3=Ru,N3=og,D3=Su,k3=ei,$3=function(e){var n=I3(this),r=H3(e);if(A3(n)<=r.size)return N3(n,function(o){if(r.includes(o))return!1},!0)!==!1;var i=r.getIterator();return D3(i,function(o){if(O3(n,o))return k3(i,"normal",!1)})!==!1},L3=Ct,F3=$3,V3=Eu,B3=!V3("isDisjointFrom",function(t){return!t});L3({target:"Set",proto:!0,real:!0,forced:B3},{isDisjointFrom:F3});var W3=bu,j3=sg,U3=og,z3=Ru,Y3=function(e){var n=W3(this),r=z3(e);return j3(n)>r.size?!1:U3(n,function(i){if(!r.includes(i))return!1},!0)!==!1},G3=Ct,K3=Y3,q3=Eu,X3=!q3("isSubsetOf",function(t){return t});G3({target:"Set",proto:!0,real:!0,forced:X3},{isSubsetOf:K3});var J3=bu,Z3=Jo.has,Q3=sg,e5=Ru,t5=Su,n5=ei,r5=function(e){var n=J3(this),r=e5(e);if(Q3(n)<r.size)return!1;var i=r.getIterator();return t5(i,function(o){if(!Z3(n,o))return n5(i,"normal",!1)})!==!1},i5=Ct,o5=r5,s5=Eu,a5=!s5("isSupersetOf",function(t){return!t});i5({target:"Set",proto:!0,real:!0,forced:a5},{isSupersetOf:o5});var l5=bu,Y0=Jo,u5=U0,c5=Ru,h5=Su,d5=Y0.add,f5=Y0.has,g5=Y0.remove,m5=function(e){var n=l5(this),r=c5(e).getIterator(),i=u5(n);return h5(r,function(o){f5(n,o)?g5(i,o):d5(i,o)}),i},p5=Ct,w5=m5,v5=Eu;p5({target:"Set",proto:!0,real:!0,forced:!v5("symmetricDifference")},{symmetricDifference:w5});var y5=bu,C5=Jo.add,b5=U0,S5=Ru,R5=Su,E5=function(e){var n=y5(this),r=S5(e).getIterator(),i=b5(n);return R5(r,function(o){C5(i,o)}),i},T5=Ct,M5=E5,_5=Eu;T5({target:"Set",proto:!0,real:!0,forced:!_5("union")},{union:M5});var P5=eg,x5=TypeError,I5=function(t,e){if(P5(e,t))return t;throw new x5("Incorrect invocation")},O5=Nn,A5=!O5(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),H5=_i,N5=Cn,D5=lh,k5=$0,$5=A5,hx=k5("IE_PROTO"),KS=Object,L5=KS.prototype,FN=$5?KS.getPrototypeOf:function(t){var e=D5(t);if(H5(e,hx))return e[hx];var n=e.constructor;return N5(n)&&e instanceof n?n.prototype:e instanceof KS?L5:null},dx=hN,F5=Ys,V5=function(t,e,n){return n.get&&dx(n.get,e,{getter:!0}),n.set&&dx(n.set,e,{setter:!0}),F5.f(t,e,n)},VN={},B5=fN,W5=B0,j5=Object.keys||function(e){return B5(e,W5)},U5=Ti,z5=oN,Y5=Ys,G5=bn,K5=Qf,q5=j5;VN.f=U5&&!z5?Object.defineProperties:function(e,n){G5(e);for(var r=K5(n),i=q5(n),o=i.length,s=0,a;o>s;)Y5.f(e,a=i[s++],r[a]);return e};var X5=ah,BN=X5("document","documentElement"),J5=bn,Z5=VN,fx=B0,Q5=L0,eq=BN,tq=k0,nq=$0,gx=">",mx="<",qS="prototype",XS="script",WN=nq("IE_PROTO"),jy=function(){},jN=function(t){return mx+XS+gx+t+mx+"/"+XS+gx},px=function(t){t.write(jN("")),t.close();var e=t.parentWindow.Object;return t=null,e},rq=function(){var t=tq("iframe"),e="java"+XS+":",n;return t.style.display="none",eq.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(jN("document.F=Object")),n.close(),n.F},Vg,xp=function(){try{Vg=new ActiveXObject("htmlfile")}catch{}xp=typeof document<"u"?document.domain&&Vg?px(Vg):rq():px(Vg);for(var t=fx.length;t--;)delete xp[qS][fx[t]];return xp()};Q5[WN]=!0;var UN=Object.create||function(e,n){var r;return e!==null?(jy[qS]=J5(e),r=new jy,jy[qS]=null,r[WN]=e):r=xp(),n===void 0?r:Z5.f(r,n)},iq=Nn,oq=Cn,sq=Mi,wx=FN,aq=V0,lq=so,JS=lq("iterator"),lu,Uy,zy;[].keys&&(zy=[].keys(),"next"in zy&&(Uy=wx(wx(zy)),Uy!==Object.prototype&&(lu=Uy)));var uq=!sq(lu)||iq(function(){var t={};return lu[JS].call(t)!==t});uq&&(lu={});oq(lu[JS])||aq(lu,JS,function(){return this});var zN={IteratorPrototype:lu},cq=Ct,hq=vn,dq=I5,fq=bn,gq=Cn,mq=FN,pq=V5,wq=IN,vq=Nn,G0=_i,yq=so,Uo=zN.IteratorPrototype,Cq=Ti,Yy="constructor",YN="Iterator",vx=yq("toStringTag"),GN=TypeError,Gy=hq[YN],KN=!gq(Gy)||Gy.prototype!==Uo||!vq(function(){Gy({})}),K0=function(){if(dq(this,Uo),mq(this)===Uo)throw new GN("Abstract class Iterator not directly constructable")},qN=function(t,e){Cq?pq(Uo,t,{configurable:!0,get:function(){return e},set:function(n){if(fq(this),this===Uo)throw new GN("You can't redefine this property");G0(this,t)?this[t]=n:wq(this,t,n)}}):Uo[t]=e};G0(Uo,vx)||qN(vx,YN);(KN||!G0(Uo,Yy)||Uo[Yy]===Object)&&qN(Yy,K0);K0.prototype=Uo;cq({global:!0,constructor:!0,forced:KN},{Iterator:K0});var bq=V0,Sq=function(t,e,n){for(var r in e)bq(t,r,e[r],n);return t},Rq=function(t,e){return{value:t,done:e}},Eq=yn,Tq=UN,Mq=uh,_q=Sq,Pq=so,XN=uN,xq=tg,Iq=zN.IteratorPrototype,Bg=Rq,Ky=ei,Oq=Pq("toStringTag"),JN="IteratorHelper",ZN="WrapForValidIterator",Aq=XN.set,QN=function(t){var e=XN.getterFor(t?ZN:JN);return _q(Tq(Iq),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return Bg(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:Bg(i,r.done)}catch(o){throw r.done=!0,o}},return:function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var i=xq(r,"return");return i?Eq(i,r):Bg(void 0,!0)}if(n.inner)try{Ky(n.inner.iterator,"normal")}catch(o){return Ky(r,"throw",o)}return r&&Ky(r,"normal"),Bg(void 0,!0)}})},Hq=QN(!0),eD=QN(!1);Mq(eD,Oq,"Iterator Helper");var q0=function(t,e,n){var r=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?ZN:JN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,Aq(this,s)};return r.prototype=e?Hq:eD,r},Nq=bn,Dq=ei,tD=function(t,e,n,r){try{return r?e(Nq(n)[0],n[1]):e(n)}catch(i){Dq(t,"throw",i)}},kq=vn,Ka=function(t,e){var n=kq.Iterator,r=n&&n.prototype,i=r&&r[t],o=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return i},$q=Ct,nD=yn,Lq=Dr,rD=bn,Fq=Zo,Vq=q0,Bq=tD,Wq=ei,jq=Ka,qy=jq("filter",TypeError),Uq=Vq(function(){for(var t=this.iterator,e=this.predicate,n=this.next,r,i,o;;){if(r=rD(nD(n,t)),i=this.done=!!r.done,i)return;if(o=r.value,Bq(t,e,[o,this.counter++],!0))return o}});$q({target:"Iterator",proto:!0,real:!0,forced:qy},{filter:function(e){rD(this);try{Lq(e)}catch(n){Wq(this,"throw",n)}return qy?nD(qy,this,e):new Uq(Fq(this),{predicate:e})}});var zq=Ct,Yq=yn,Gq=hh,Kq=Dr,qq=bn,Xq=Zo,Jq=ei,Zq=Ka,Xy=Zq("forEach",TypeError);zq({target:"Iterator",proto:!0,real:!0,forced:Xy},{forEach:function(e){qq(this);try{Kq(e)}catch(i){Jq(this,"throw",i)}if(Xy)return Yq(Xy,this,e);var n=Xq(this),r=0;Gq(n,function(i){e(i,r++)},{IS_RECORD:!0})}});var Qq=Ct,iD=yn,e4=Dr,oD=bn,t4=Zo,n4=q0,r4=tD,i4=ei,o4=Ka,Jy=o4("map",TypeError),s4=n4(function(){var t=this.iterator,e=oD(iD(this.next,t)),n=this.done=!!e.done;if(!n)return r4(t,this.mapper,[e.value,this.counter++],!0)});Qq({target:"Iterator",proto:!0,real:!0,forced:Jy},{map:function(e){oD(this);try{e4(e)}catch(n){i4(this,"throw",n)}return Jy?iD(Jy,this,e):new s4(t4(this),{mapper:e})}});var a4=dn,X0=a4([].slice),l4=TypeError,sD=function(t,e){if(t<e)throw new l4("Not enough arguments");return t},u4=bv,c4=/(?:ipad|iphone|ipod).*applewebkit/i.test(u4),Ph=vn,h4=bv,d4=yu,Wg=function(t){return h4.slice(0,t.length)===t},aD=function(){return Wg("Bun/")?"BUN":Wg("Cloudflare-Workers")?"CLOUDFLARE":Wg("Deno/")?"DENO":Wg("Node.js/")?"NODE":Ph.Bun&&typeof Bun.version=="string"?"BUN":Ph.Deno&&typeof Deno.version=="object"?"DENO":d4(Ph.process)==="process"?"NODE":Ph.window&&Ph.document?"BROWSER":"REST"}(),f4=aD,g4=f4==="NODE",Xr=vn,m4=ig,p4=PN,yx=Cn,w4=_i,lD=Nn,Cx=BN,v4=X0,bx=k0,y4=sD,C4=c4,b4=g4,ZS=Xr.setImmediate,QS=Xr.clearImmediate,S4=Xr.process,Zy=Xr.Dispatch,R4=Xr.Function,Sx=Xr.MessageChannel,E4=Xr.String,Qy=0,jd={},Rx="onreadystatechange",Sf,el,eC,tC;lD(function(){Sf=Xr.location});var J0=function(t){if(w4(jd,t)){var e=jd[t];delete jd[t],e()}},nC=function(t){return function(){J0(t)}},Ex=function(t){J0(t.data)},Tx=function(t){Xr.postMessage(E4(t),Sf.protocol+"//"+Sf.host)};(!ZS||!QS)&&(ZS=function(e){y4(arguments.length,1);var n=yx(e)?e:R4(e),r=v4(arguments,1);return jd[++Qy]=function(){m4(n,void 0,r)},el(Qy),Qy},QS=function(e){delete jd[e]},b4?el=function(t){S4.nextTick(nC(t))}:Zy&&Zy.now?el=function(t){Zy.now(nC(t))}:Sx&&!C4?(eC=new Sx,tC=eC.port2,eC.port1.onmessage=Ex,el=p4(tC.postMessage,tC)):Xr.addEventListener&&yx(Xr.postMessage)&&!Xr.importScripts&&Sf&&Sf.protocol!=="file:"&&!lD(Tx)?(el=Tx,Xr.addEventListener("message",Ex,!1)):Rx in bx("script")?el=function(t){Cx.appendChild(bx("script"))[Rx]=function(){Cx.removeChild(this),J0(t)}}:el=function(t){setTimeout(nC(t),0)});var uD={set:ZS,clear:QS},T4=Ct,M4=vn,Mx=uD.clear;T4({global:!0,bind:!0,enumerable:!0,forced:M4.clearImmediate!==Mx},{clearImmediate:Mx});var cD=vn,_4=ig,P4=Cn,x4=aD,I4=bv,O4=X0,A4=sD,H4=cD.Function,N4=/MSIE .\./.test(I4)||x4==="BUN"&&function(){var t=cD.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),D4=function(t,e){var n=e?2:1;return N4?function(r,i){var o=A4(arguments.length,1)>n,s=P4(r)?r:H4(r),a=o?O4(arguments,n):[],l=o?function(){_4(s,this,a)}:s;return e?t(l,i):t(l)}:t},k4=Ct,hD=vn,_x=uD.set,$4=D4,Px=hD.setImmediate?$4(_x,!1):_x;k4({global:!0,bind:!0,enumerable:!0,forced:hD.setImmediate!==Px},{setImmediate:Px});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:dD,setPrototypeOf:xx,isFrozen:L4,getPrototypeOf:F4,getOwnPropertyDescriptor:V4}=Object;let{freeze:hr,seal:Ri,create:fD}=Object,{apply:eR,construct:tR}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});Ri||(Ri=function(e){return e});eR||(eR=function(e,n,r){return e.apply(n,r)});tR||(tR=function(e,n){return new e(...n)});const jg=dr(Array.prototype.forEach),B4=dr(Array.prototype.lastIndexOf),Ix=dr(Array.prototype.pop),xh=dr(Array.prototype.push),W4=dr(Array.prototype.splice),Ip=dr(String.prototype.toLowerCase),rC=dr(String.prototype.toString),Ox=dr(String.prototype.match),Ih=dr(String.prototype.replace),j4=dr(String.prototype.indexOf),U4=dr(String.prototype.trim),Wi=dr(Object.prototype.hasOwnProperty),tr=dr(RegExp.prototype.test),Oh=z4(TypeError);function dr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return eR(t,e,r)}}function z4(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return tR(t,n)}}function We(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ip;xx&&xx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(L4(e)||(e[r]=o),i=o)}t[i]=!0}return t}function Y4(t){for(let e=0;e<t.length;e++)Wi(t,e)||(t[e]=null);return t}function Bl(t){const e=fD(null);for(const[n,r]of dD(t))Wi(t,n)&&(Array.isArray(r)?e[n]=Y4(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Bl(r):e[n]=r);return e}function Ah(t,e){for(;t!==null;){const r=V4(t,e);if(r){if(r.get)return dr(r.get);if(typeof r.value=="function")return dr(r.value)}t=F4(t)}function n(){return null}return n}const Ax=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),iC=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),oC=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),G4=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),sC=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),K4=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Hx=hr(["#text"]),Nx=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),aC=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Dx=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ug=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q4=Ri(/\{\{[\w\W]*|[\w\W]*\}\}/gm),X4=Ri(/<%[\w\W]*|[\w\W]*%>/gm),J4=Ri(/\$\{[\w\W]*/gm),Z4=Ri(/^data-[\-\w.\u00B7-\uFFFF]+$/),Q4=Ri(/^aria-[\-\w]+$/),gD=Ri(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eX=Ri(/^(?:\w+script|data):/i),tX=Ri(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mD=Ri(/^html$/i),nX=Ri(/^[a-z][.\w]*(-[.\w]+)+$/i);var kx=Object.freeze({__proto__:null,ARIA_ATTR:Q4,ATTR_WHITESPACE:tX,CUSTOM_ELEMENT:nX,DATA_ATTR:Z4,DOCTYPE_NAME:mD,ERB_EXPR:X4,IS_ALLOWED_URI:gD,IS_SCRIPT_OR_DATA:eX,MUSTACHE_EXPR:q4,TMPLIT_EXPR:J4});const Hh={element:1,text:3,progressingInstruction:7,comment:8,document:9},rX=function(){return typeof window>"u"?null:window},iX=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},$x=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function pD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rX();const e=ye=>pD(ye);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==Hh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,v=Ah(g,"cloneNode"),y=Ah(g,"remove"),E=Ah(g,"nextSibling"),C=Ah(g,"childNodes"),M=Ah(g,"parentNode");if(typeof s=="function"){const ye=n.createElement("template");ye.content&&ye.content.ownerDocument&&(n=ye.content.ownerDocument)}let x,P="";const{implementation:T,createNodeIterator:O,createDocumentFragment:G,getElementsByTagName:U}=n,{importNode:V}=r;let X=$x();e.isSupported=typeof dD=="function"&&typeof M=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:Q,TMPLIT_EXPR:te,DATA_ATTR:pe,ARIA_ATTR:et,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ae,CUSTOM_ELEMENT:st}=kx;let{IS_ALLOWED_URI:Pn}=kx,at=null;const m=We({},[...Ax,...iC,...oC,...sC,...Hx]);let w=null;const p=We({},[...Nx,...aC,...Dx,...Ug]);let A=Object.seal(fD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,j=null,K=!0,J=!0,b=!1,R=!0,S=!1,$=!0,I=!1,N=!1,W=!1,H=!1,D=!1,B=!1,F=!0,Y=!1;const ae="user-content-";let ce=!0,_e=!1,Fe={},ze=null;const Me=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ve=null;const _t=We({},["audio","video","img","source","image","track"]);let Ai=null;const rs=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ni="http://www.w3.org/1998/Math/MathML",Pt="http://www.w3.org/2000/svg",gn="http://www.w3.org/1999/xhtml";let bt=gn,xt=!1,Be=null;const ri=We({},[ni,Pt,gn],rC);let Ja=We({},["mi","mo","mn","ms","mtext"]),Za=We({},["annotation-xml"]);const HV=We({},["title","style","font","a","script"]);let Rh=null;const NV=["application/xhtml+xml","text/html"],DV="text/html";let xn=null,Au=null;const kV=n.createElement("form"),z_=function(k){return k instanceof RegExp||k instanceof Function},Sy=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Au&&Au===k)){if((!k||typeof k!="object")&&(k={}),k=Bl(k),Rh=NV.indexOf(k.PARSER_MEDIA_TYPE)===-1?DV:k.PARSER_MEDIA_TYPE,xn=Rh==="application/xhtml+xml"?rC:Ip,at=Wi(k,"ALLOWED_TAGS")?We({},k.ALLOWED_TAGS,xn):m,w=Wi(k,"ALLOWED_ATTR")?We({},k.ALLOWED_ATTR,xn):p,Be=Wi(k,"ALLOWED_NAMESPACES")?We({},k.ALLOWED_NAMESPACES,rC):ri,Ai=Wi(k,"ADD_URI_SAFE_ATTR")?We(Bl(rs),k.ADD_URI_SAFE_ATTR,xn):rs,Ve=Wi(k,"ADD_DATA_URI_TAGS")?We(Bl(_t),k.ADD_DATA_URI_TAGS,xn):_t,ze=Wi(k,"FORBID_CONTENTS")?We({},k.FORBID_CONTENTS,xn):Me,L=Wi(k,"FORBID_TAGS")?We({},k.FORBID_TAGS,xn):{},j=Wi(k,"FORBID_ATTR")?We({},k.FORBID_ATTR,xn):{},Fe=Wi(k,"USE_PROFILES")?k.USE_PROFILES:!1,K=k.ALLOW_ARIA_ATTR!==!1,J=k.ALLOW_DATA_ATTR!==!1,b=k.ALLOW_UNKNOWN_PROTOCOLS||!1,R=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=k.SAFE_FOR_TEMPLATES||!1,$=k.SAFE_FOR_XML!==!1,I=k.WHOLE_DOCUMENT||!1,H=k.RETURN_DOM||!1,D=k.RETURN_DOM_FRAGMENT||!1,B=k.RETURN_TRUSTED_TYPE||!1,W=k.FORCE_BODY||!1,F=k.SANITIZE_DOM!==!1,Y=k.SANITIZE_NAMED_PROPS||!1,ce=k.KEEP_CONTENT!==!1,_e=k.IN_PLACE||!1,Pn=k.ALLOWED_URI_REGEXP||gD,bt=k.NAMESPACE||gn,Ja=k.MATHML_TEXT_INTEGRATION_POINTS||Ja,Za=k.HTML_INTEGRATION_POINTS||Za,A=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&z_(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&z_(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(J=!1),D&&(H=!0),Fe&&(at=We({},Hx),w=[],Fe.html===!0&&(We(at,Ax),We(w,Nx)),Fe.svg===!0&&(We(at,iC),We(w,aC),We(w,Ug)),Fe.svgFilters===!0&&(We(at,oC),We(w,aC),We(w,Ug)),Fe.mathMl===!0&&(We(at,sC),We(w,Dx),We(w,Ug))),k.ADD_TAGS&&(at===m&&(at=Bl(at)),We(at,k.ADD_TAGS,xn)),k.ADD_ATTR&&(w===p&&(w=Bl(w)),We(w,k.ADD_ATTR,xn)),k.ADD_URI_SAFE_ATTR&&We(Ai,k.ADD_URI_SAFE_ATTR,xn),k.FORBID_CONTENTS&&(ze===Me&&(ze=Bl(ze)),We(ze,k.FORBID_CONTENTS,xn)),ce&&(at["#text"]=!0),I&&We(at,["html","head","body"]),at.table&&(We(at,["tbody"]),delete L.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Oh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Oh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=k.TRUSTED_TYPES_POLICY,P=x.createHTML("")}else x===void 0&&(x=iX(f,i)),x!==null&&typeof P=="string"&&(P=x.createHTML(""));hr&&hr(k),Au=k}},Y_=We({},[...iC,...oC,...G4]),G_=We({},[...sC,...K4]),$V=function(k){let re=M(k);(!re||!re.tagName)&&(re={namespaceURI:bt,tagName:"template"});const me=Ip(k.tagName),kt=Ip(re.tagName);return Be[k.namespaceURI]?k.namespaceURI===Pt?re.namespaceURI===gn?me==="svg":re.namespaceURI===ni?me==="svg"&&(kt==="annotation-xml"||Ja[kt]):!!Y_[me]:k.namespaceURI===ni?re.namespaceURI===gn?me==="math":re.namespaceURI===Pt?me==="math"&&Za[kt]:!!G_[me]:k.namespaceURI===gn?re.namespaceURI===Pt&&!Za[kt]||re.namespaceURI===ni&&!Ja[kt]?!1:!G_[me]&&(HV[me]||!Y_[me]):!!(Rh==="application/xhtml+xml"&&Be[k.namespaceURI]):!1},uo=function(k){xh(e.removed,{element:k});try{M(k).removeChild(k)}catch{y(k)}},Og=function(k,re){try{xh(e.removed,{attribute:re.getAttributeNode(k),from:re})}catch{xh(e.removed,{attribute:null,from:re})}if(re.removeAttribute(k),k==="is")if(H||D)try{uo(re)}catch{}else try{re.setAttribute(k,"")}catch{}},K_=function(k){let re=null,me=null;if(W)k="<remove></remove>"+k;else{const Dn=Ox(k,/^[\r\n\t ]+/);me=Dn&&Dn[0]}Rh==="application/xhtml+xml"&&bt===gn&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const kt=x?x.createHTML(k):k;if(bt===gn)try{re=new d().parseFromString(kt,Rh)}catch{}if(!re||!re.documentElement){re=T.createDocument(bt,"template",null);try{re.documentElement.innerHTML=xt?P:kt}catch{}}const Vn=re.body||re.documentElement;return k&&me&&Vn.insertBefore(n.createTextNode(me),Vn.childNodes[0]||null),bt===gn?U.call(re,I?"html":"body")[0]:I?re.documentElement:Vn},q_=function(k){return O.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ry=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},X_=function(k){return typeof a=="function"&&k instanceof a};function is(ye,k,re){jg(ye,me=>{me.call(e,k,re,Au)})}const J_=function(k){let re=null;if(is(X.beforeSanitizeElements,k,null),Ry(k))return uo(k),!0;const me=xn(k.nodeName);if(is(X.uponSanitizeElement,k,{tagName:me,allowedTags:at}),k.hasChildNodes()&&!X_(k.firstElementChild)&&tr(/<[/\w!]/g,k.innerHTML)&&tr(/<[/\w!]/g,k.textContent)||k.nodeType===Hh.progressingInstruction||$&&k.nodeType===Hh.comment&&tr(/<[/\w]/g,k.data))return uo(k),!0;if(!at[me]||L[me]){if(!L[me]&&Q_(me)&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me)))return!1;if(ce&&!ze[me]){const kt=M(k)||k.parentNode,Vn=C(k)||k.childNodes;if(Vn&&kt){const Dn=Vn.length;for(let mr=Dn-1;mr>=0;--mr){const co=v(Vn[mr],!0);co.__removalCount=(k.__removalCount||0)+1,kt.insertBefore(co,E(k))}}}return uo(k),!0}return k instanceof l&&!$V(k)||(me==="noscript"||me==="noembed"||me==="noframes")&&tr(/<\/no(script|embed|frames)/i,k.innerHTML)?(uo(k),!0):(S&&k.nodeType===Hh.text&&(re=k.textContent,jg([ne,Q,te],kt=>{re=Ih(re,kt," ")}),k.textContent!==re&&(xh(e.removed,{element:k.cloneNode()}),k.textContent=re)),is(X.afterSanitizeElements,k,null),!1)},Z_=function(k,re,me){if(F&&(re==="id"||re==="name")&&(me in n||me in kV))return!1;if(!(J&&!j[re]&&tr(pe,re))){if(!(K&&tr(et,re))){if(!w[re]||j[re]){if(!(Q_(k)&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,k)||A.tagNameCheck instanceof Function&&A.tagNameCheck(k))&&(A.attributeNameCheck instanceof RegExp&&tr(A.attributeNameCheck,re)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(re))||re==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&tr(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me))))return!1}else if(!Ai[re]){if(!tr(Pn,Ih(me,Ae,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&k!=="script"&&j4(me,"data:")===0&&Ve[k])){if(!(b&&!tr(Re,Ih(me,Ae,"")))){if(me)return!1}}}}}}return!0},Q_=function(k){return k!=="annotation-xml"&&Ox(k,st)},eP=function(k){is(X.beforeSanitizeAttributes,k,null);const{attributes:re}=k;if(!re||Ry(k))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let kt=re.length;for(;kt--;){const Vn=re[kt],{name:Dn,namespaceURI:mr,value:co}=Vn,Eh=xn(Dn);let er=Dn==="value"?co:U4(co);if(me.attrName=Eh,me.attrValue=er,me.keepAttr=!0,me.forceKeepAttr=void 0,is(X.uponSanitizeAttribute,k,me),er=me.attrValue,Y&&(Eh==="id"||Eh==="name")&&(Og(Dn,k),er=ae+er),$&&tr(/((--!?|])>)|<\/(style|title)/i,er)){Og(Dn,k);continue}if(me.forceKeepAttr||(Og(Dn,k),!me.keepAttr))continue;if(!R&&tr(/\/>/i,er)){Og(Dn,k);continue}S&&jg([ne,Q,te],nP=>{er=Ih(er,nP," ")});const tP=xn(k.nodeName);if(Z_(tP,Eh,er)){if(x&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!mr)switch(f.getAttributeType(tP,Eh)){case"TrustedHTML":{er=x.createHTML(er);break}case"TrustedScriptURL":{er=x.createScriptURL(er);break}}try{mr?k.setAttributeNS(mr,Dn,er):k.setAttribute(Dn,er),Ry(k)?uo(k):Ix(e.removed)}catch{}}}is(X.afterSanitizeAttributes,k,null)},LV=function ye(k){let re=null;const me=q_(k);for(is(X.beforeSanitizeShadowDOM,k,null);re=me.nextNode();)is(X.uponSanitizeShadowNode,re,null),J_(re),eP(re),re.content instanceof o&&ye(re.content);is(X.afterSanitizeShadowDOM,k,null)};return e.sanitize=function(ye){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,me=null,kt=null,Vn=null;if(xt=!ye,xt&&(ye="<!-->"),typeof ye!="string"&&!X_(ye))if(typeof ye.toString=="function"){if(ye=ye.toString(),typeof ye!="string")throw Oh("dirty is not a string, aborting")}else throw Oh("toString is not a function");if(!e.isSupported)return ye;if(N||Sy(k),e.removed=[],typeof ye=="string"&&(_e=!1),_e){if(ye.nodeName){const co=xn(ye.nodeName);if(!at[co]||L[co])throw Oh("root node is forbidden and cannot be sanitized in-place")}}else if(ye instanceof a)re=K_("<!---->"),me=re.ownerDocument.importNode(ye,!0),me.nodeType===Hh.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?re=me:re.appendChild(me);else{if(!H&&!S&&!I&&ye.indexOf("<")===-1)return x&&B?x.createHTML(ye):ye;if(re=K_(ye),!re)return H?null:B?P:""}re&&W&&uo(re.firstChild);const Dn=q_(_e?ye:re);for(;kt=Dn.nextNode();)J_(kt),eP(kt),kt.content instanceof o&&LV(kt.content);if(_e)return ye;if(H){if(D)for(Vn=G.call(re.ownerDocument);re.firstChild;)Vn.appendChild(re.firstChild);else Vn=re;return(w.shadowroot||w.shadowrootmode)&&(Vn=V.call(r,Vn,!0)),Vn}let mr=I?re.outerHTML:re.innerHTML;return I&&at["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&tr(mD,re.ownerDocument.doctype.name)&&(mr="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+mr),S&&jg([ne,Q,te],co=>{mr=Ih(mr,co," ")}),x&&B?x.createHTML(mr):mr},e.setConfig=function(){let ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Sy(ye),N=!0},e.clearConfig=function(){Au=null,N=!1},e.isValidAttribute=function(ye,k,re){Au||Sy({});const me=xn(ye),kt=xn(k);return Z_(me,kt,re)},e.addHook=function(ye,k){typeof k=="function"&&xh(X[ye],k)},e.removeHook=function(ye,k){if(k!==void 0){const re=B4(X[ye],k);return re===-1?void 0:W4(X[ye],re,1)[0]}return Ix(X[ye])},e.removeHooks=function(ye){X[ye]=[]},e.removeAllHooks=function(){X=$x()},e}var oX=pD();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var wD;function Z(){return wD.apply(null,arguments)}function sX(t){wD=t}function ro(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ru(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function Tr(t){return t===void 0}function Bs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ag(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function vD(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Pa(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Qo(t,e,n,r){return BD(t,e,n,r,!0).utc()}function aX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ne(t){return t._pf==null&&(t._pf=aX()),t._pf}var nR;Array.prototype.some?nR=Array.prototype.some:nR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Q0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ne(t),n=nR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Ev(t){var e=Qo(NaN);return t!=null?Pa(Ne(e),t):Ne(e).userInvalidated=!0,e}var Lx=Z.momentProperties=[],lC=!1;function eE(t,e){var n,r,i,o=Lx.length;if(Tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Tr(e._i)||(t._i=e._i),Tr(e._f)||(t._f=e._f),Tr(e._l)||(t._l=e._l),Tr(e._strict)||(t._strict=e._strict),Tr(e._tzm)||(t._tzm=e._tzm),Tr(e._isUTC)||(t._isUTC=e._isUTC),Tr(e._offset)||(t._offset=e._offset),Tr(e._pf)||(t._pf=Ne(e)),Tr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Lx[n],i=e[r],Tr(i)||(t[r]=i);return t}function lg(t){eE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),lC===!1&&(lC=!0,Z.updateOffset(this),lC=!1)}function io(t){return t instanceof lg||t!=null&&t._isAMomentObject!=null}function yD(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Pi(t,e){var n=!0;return Pa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])it(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}yD(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Fx={};function CD(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),Fx[t]||(yD(e),Fx[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function es(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function lX(t){var e,n;for(n in t)it(t,n)&&(e=t[n],es(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function rR(t,e){var n=Pa({},t),r;for(r in e)it(e,r)&&(ru(t[r])&&ru(e[r])?(n[r]={},Pa(n[r],t[r]),Pa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&ru(t[r])&&(n[r]=Pa({},n[r]));return n}function tE(t){t!=null&&this.set(t)}var iR;Object.keys?iR=Object.keys:iR=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var uX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function cX(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return es(r)?r.call(e,n):r}function Ko(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var nE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,zg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,uC={},$c={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&($c[t]=i),e&&($c[e[0]]=function(){return Ko(i.apply(this,arguments),e[1],e[2])}),n&&($c[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function hX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function dX(t){var e=t.match(nE),n,r;for(n=0,r=e.length;n<r;n++)$c[e[n]]?e[n]=$c[e[n]]:e[n]=hX(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=es(e[s])?e[s].call(i,t):e[s];return o}}function Op(t,e){return t.isValid()?(e=bD(e,t.localeData()),uC[e]=uC[e]||dX(e),uC[e](t)):t.localeData().invalidDate()}function bD(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(zg.lastIndex=0;n>=0&&zg.test(t);)t=t.replace(zg,r),zg.lastIndex=0,n-=1;return t}var fX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function gX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(nE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var mX="Invalid date";function pX(){return this._invalidDate}var wX="%d",vX=/\d{1,2}/;function yX(t){return this._ordinal.replace("%d",t)}var CX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function bX(t,e,n,r){var i=this._relativeTime[n];return es(i)?i(t,e,n,r):i.replace(/%d/i,t)}function SX(t,e){var n=this._relativeTime[t>0?"future":"past"];return es(n)?n(e):n.replace(/%s/i,e)}var Vx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function xi(t){return typeof t=="string"?Vx[t]||Vx[t.toLowerCase()]:void 0}function rE(t){var e={},n,r;for(r in t)it(t,r)&&(n=xi(r),n&&(e[n]=t[r]));return e}var RX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function EX(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:RX[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var SD=/\d/,ti=/\d\d/,RD=/\d{3}/,iE=/\d{4}/,Tv=/[+-]?\d{6}/,Dt=/\d\d?/,ED=/\d\d\d\d?/,TD=/\d\d\d\d\d\d?/,Mv=/\d{1,3}/,oE=/\d{1,4}/,_v=/[+-]?\d{1,6}/,dh=/\d+/,Pv=/[+-]?\d+/,TX=/Z|[+-]\d\d:?\d\d/gi,xv=/Z|[+-]\d\d(?::?\d\d)?/gi,MX=/[+-]?\d+(\.\d{1,3})?/,ug=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,fh=/^[1-9]\d?/,sE=/^([1-9]\d|\d)/,vw;vw={};function ue(t,e,n){vw[t]=es(e)?e:function(r,i){return r&&n?n:e}}function _X(t,e){return it(vw,t)?vw[t](e._strict,e._locale):new RegExp(PX(t))}function PX(t){return Fs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Fs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function wi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ge(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=wi(e)),n}var oR={};function vt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Bs(e)&&(r=function(o,s){s[e]=Ge(o)}),i=t.length,n=0;n<i;n++)oR[t[n]]=r}function cg(t,e){vt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function xX(t,e,n){e!=null&&it(oR,t)&&oR[t](e,n._a,n,t)}function Iv(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Os=1,Lo=2,Mn=3,eo=4,As=5,ql=6,IX=7,OX=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Ko(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Pv);ue("YY",Dt,ti);ue("YYYY",oE,iE);ue("YYYYY",_v,Tv);ue("YYYYYY",_v,Tv);vt(["YYYYY","YYYYYY"],Xn);vt("YYYY",function(t,e){e[Xn]=t.length===2?Z.parseTwoDigitYear(t):Ge(t)});vt("YY",function(t,e){e[Xn]=Z.parseTwoDigitYear(t)});vt("Y",function(t,e){e[Xn]=parseInt(t,10)});function Ud(t){return Iv(t)?366:365}Z.parseTwoDigitYear=function(t){return Ge(t)+(Ge(t)>68?1900:2e3)};var MD=gh("FullYear",!0);function AX(){return Iv(this.year())}function gh(t,e){return function(n){return n!=null?(_D(this,t,n),Z.updateOffset(this,e),this):Rf(this,t)}}function Rf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function _D(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Iv(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function HX(t){return t=xi(t),es(this[t])?this[t]():this}function NX(t,e){if(typeof t=="object"){t=rE(t);var n=EX(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=xi(t),es(this[t]))return this[t](e);return this}function DX(t,e){return(t%e+e)%e}var an;Array.prototype.indexOf?an=Array.prototype.indexOf:an=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function aE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=DX(e,12);return t+=(e-n)/12,n===1?Iv(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Dt,fh);ue("MM",Dt,ti);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});vt(["M","MM"],function(t,e){e[Os]=Ge(t)-1});vt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Os]=i:Ne(n).invalidMonth=t});var kX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),PD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),xD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,$X=ug,LX=ug;function FX(t,e){return t?ro(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||xD).test(e)?"format":"standalone"][t.month()]:ro(this._months)?this._months:this._months.standalone}function VX(t,e){return t?ro(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[xD.test(e)?"format":"standalone"][t.month()]:ro(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function BX(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Qo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:null):(i=an.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:(i=an.call(this._longMonthsParse,s),i!==-1?i:null)):(i=an.call(this._longMonthsParse,s),i!==-1?i:(i=an.call(this._shortMonthsParse,s),i!==-1?i:null))}function WX(t,e,n){var r,i,o;if(this._monthsParseExact)return BX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Qo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function ID(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ge(e);else if(e=t.localeData().monthsParse(e),!Bs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,aE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function OD(t){return t!=null?(ID(this,t),Z.updateOffset(this,!0),this):Rf(this,"Month")}function jX(){return aE(this.year(),this.month())}function UX(t){return this._monthsParseExact?(it(this,"_monthsRegex")||AD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=$X),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function zX(t){return this._monthsParseExact?(it(this,"_monthsRegex")||AD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=LX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function AD(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Qo([2e3,i]),s=Fs(this.monthsShort(o,"")),a=Fs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function YX(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Ef(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function yw(t,e,n){var r=7+e-n,i=(7+Ef(t,0,r).getUTCDay()-e)%7;return-i+r-1}function HD(t,e,n,r,i){var o=(7+n-r)%7,s=yw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Ud(l)+a):a>Ud(t)?(l=t+1,u=a-Ud(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Tf(t,e,n){var r=yw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Vs(s,e,n)):i>Vs(t.year(),e,n)?(o=i-Vs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Vs(t,e,n){var r=yw(t,e,n),i=yw(t+1,e,n);return(Ud(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Dt,fh);ue("ww",Dt,ti);ue("W",Dt,fh);ue("WW",Dt,ti);cg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ge(t)});function GX(t){return Tf(t,this._week.dow,this._week.doy).week}var KX={dow:0,doy:6};function qX(){return this._week.dow}function XX(){return this._week.doy}function JX(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function ZX(t){var e=Tf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Dt);ue("e",Dt);ue("E",Dt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});cg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ne(n).invalidWeekday=t});cg(["d","e","E"],function(t,e,n,r){e[r]=Ge(t)});function QX(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function e6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function lE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var t6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ND="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),n6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),r6=ug,i6=ug,o6=ug;function s6(t,e){var n=ro(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?lE(n,this._week.dow):t?n[t.day()]:n}function a6(t){return t===!0?lE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function l6(t){return t===!0?lE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function u6(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Qo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1||(i=an.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=an.call(this._minWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function c6(t,e,n){var r,i,o;if(this._weekdaysParseExact)return u6.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Qo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function h6(t){if(!this.isValid())return t!=null?this:NaN;var e=Rf(this,"Day");return t!=null?(t=QX(t,this.localeData()),this.add(t-e,"d")):e}function d6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function f6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=e6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function g6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||uE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=r6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function m6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||uE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=i6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function p6(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||uE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=o6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function uE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Qo([2e3,1]).day(o),a=Fs(this.weekdaysMin(s,"")),l=Fs(this.weekdaysShort(s,"")),u=Fs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function cE(){return this.hours()%12||12}function w6(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,cE);Ce("k",["kk",2],0,w6);Ce("hmm",0,0,function(){return""+cE.apply(this)+Ko(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+cE.apply(this)+Ko(this.minutes(),2)+Ko(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Ko(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Ko(this.minutes(),2)+Ko(this.seconds(),2)});function DD(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}DD("a",!0);DD("A",!1);function kD(t,e){return e._meridiemParse}ue("a",kD);ue("A",kD);ue("H",Dt,sE);ue("h",Dt,fh);ue("k",Dt,fh);ue("HH",Dt,ti);ue("hh",Dt,ti);ue("kk",Dt,ti);ue("hmm",ED);ue("hmmss",TD);ue("Hmm",ED);ue("Hmmss",TD);vt(["H","HH"],Mn);vt(["k","kk"],function(t,e,n){var r=Ge(t);e[Mn]=r===24?0:r});vt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});vt(["h","hh"],function(t,e,n){e[Mn]=Ge(t),Ne(n).bigHour=!0});vt("hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r)),Ne(n).bigHour=!0});vt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r,2)),e[As]=Ge(t.substr(i)),Ne(n).bigHour=!0});vt("Hmm",function(t,e,n){var r=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r))});vt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Mn]=Ge(t.substr(0,r)),e[eo]=Ge(t.substr(r,2)),e[As]=Ge(t.substr(i))});function v6(t){return(t+"").toLowerCase().charAt(0)==="p"}var y6=/[ap]\.?m?\.?/i,C6=gh("Hours",!0);function b6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var $D={calendar:uX,longDateFormat:fX,invalidDate:mX,ordinal:wX,dayOfMonthOrdinalParse:vX,relativeTime:CX,months:kX,monthsShort:PD,week:KX,weekdays:t6,weekdaysMin:n6,weekdaysShort:ND,meridiemParse:y6},$t={},Nh={},Mf;function S6(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Bx(t){return t&&t.toLowerCase().replace("_","-")}function R6(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Bx(t[e]).split("-"),n=o.length,r=Bx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Ov(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&S6(o,r)>=n-1)break;n--}e++}return Mf}function E6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Ov(t){var e=null,n;if($t[t]===void 0&&typeof ew<"u"&&ew&&ew.exports&&E6(t))try{e=Mf._abbr,n=require,n("./locale/"+t),Da(e)}catch{$t[t]=null}return $t[t]}function Da(t,e){var n;return t&&(Tr(e)?n=Gs(t):n=hE(t,e),n?Mf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Mf._abbr}function hE(t,e){if(e!==null){var n,r=$D;if(e.abbr=t,$t[t]!=null)CD("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=$t[t]._config;else if(e.parentLocale!=null)if($t[e.parentLocale]!=null)r=$t[e.parentLocale]._config;else if(n=Ov(e.parentLocale),n!=null)r=n._config;else return Nh[e.parentLocale]||(Nh[e.parentLocale]=[]),Nh[e.parentLocale].push({name:t,config:e}),null;return $t[t]=new tE(rR(r,e)),Nh[t]&&Nh[t].forEach(function(i){hE(i.name,i.config)}),Da(t),$t[t]}else return delete $t[t],null}function T6(t,e){if(e!=null){var n,r,i=$D;$t[t]!=null&&$t[t].parentLocale!=null?$t[t].set(rR($t[t]._config,e)):(r=Ov(t),r!=null&&(i=r._config),e=rR(i,e),r==null&&(e.abbr=t),n=new tE(e),n.parentLocale=$t[t],$t[t]=n),Da(t)}else $t[t]!=null&&($t[t].parentLocale!=null?($t[t]=$t[t].parentLocale,t===Da()&&Da(t)):$t[t]!=null&&delete $t[t]);return $t[t]}function Gs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Mf;if(!ro(t)){if(e=Ov(t),e)return e;t=[t]}return R6(t)}function M6(){return iR($t)}function dE(t){var e,n=t._a;return n&&Ne(t).overflow===-2&&(e=n[Os]<0||n[Os]>11?Os:n[Lo]<1||n[Lo]>aE(n[Xn],n[Os])?Lo:n[Mn]<0||n[Mn]>24||n[Mn]===24&&(n[eo]!==0||n[As]!==0||n[ql]!==0)?Mn:n[eo]<0||n[eo]>59?eo:n[As]<0||n[As]>59?As:n[ql]<0||n[ql]>999?ql:-1,Ne(t)._overflowDayOfYear&&(e<Xn||e>Lo)&&(e=Lo),Ne(t)._overflowWeeks&&e===-1&&(e=IX),Ne(t)._overflowWeekday&&e===-1&&(e=OX),Ne(t).overflow=e),t}var _6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,P6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,x6=/Z|[+-]\d\d(?::?\d\d)?/,Yg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],cC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],I6=/^\/?Date\((-?\d+)/i,O6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,A6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function LD(t){var e,n,r=t._i,i=_6.exec(r)||P6.exec(r),o,s,a,l,u=Yg.length,c=cC.length;if(i){for(Ne(t).iso=!0,e=0,n=u;e<n;e++)if(Yg[e][1].exec(i[1])){s=Yg[e][0],o=Yg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(cC[e][1].exec(i[3])){a=(i[2]||" ")+cC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(x6.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),gE(t)}else t._isValid=!1}function H6(t,e,n,r,i,o){var s=[N6(t),PD.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function N6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function D6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function k6(t,e,n){if(t){var r=ND.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ne(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function $6(t,e,n){if(t)return A6[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function FD(t){var e=O6.exec(D6(t._i)),n;if(e){if(n=H6(e[4],e[3],e[2],e[5],e[6],e[7]),!k6(e[1],n,t))return;t._a=n,t._tzm=$6(e[8],e[9],e[10]),t._d=Ef.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ne(t).rfc2822=!0}else t._isValid=!1}function L6(t){var e=I6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(LD(t),t._isValid===!1)delete t._isValid;else return;if(FD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Pi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function vc(t,e,n){return t??e??n}function F6(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function fE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=F6(t),t._w&&t._a[Lo]==null&&t._a[Os]==null&&V6(t),t._dayOfYear!=null&&(s=vc(t._a[Xn],i[Xn]),(t._dayOfYear>Ud(s)||t._dayOfYear===0)&&(Ne(t)._overflowDayOfYear=!0),n=Ef(s,0,t._dayOfYear),t._a[Os]=n.getUTCMonth(),t._a[Lo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Mn]===24&&t._a[eo]===0&&t._a[As]===0&&t._a[ql]===0&&(t._nextDay=!0,t._a[Mn]=0),t._d=(t._useUTC?Ef:YX).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ne(t).weekdayMismatch=!0)}}function V6(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=vc(e.GG,t._a[Xn],Tf(Nt(),1,4).year),r=vc(e.W,1),i=vc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Tf(Nt(),o,s),n=vc(e.gg,t._a[Xn],u.year),r=vc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Vs(n,o,s)?Ne(t)._overflowWeeks=!0:l!=null?Ne(t)._overflowWeekday=!0:(a=HD(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function gE(t){if(t._f===Z.ISO_8601){LD(t);return}if(t._f===Z.RFC_2822){FD(t);return}t._a=[],Ne(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=bD(t._f,t._locale).match(nE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(_X(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ne(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),$c[o]?(r?Ne(t).empty=!1:Ne(t).unusedTokens.push(o),xX(o,r,t)):t._strict&&!r&&Ne(t).unusedTokens.push(o);Ne(t).charsLeftOver=a-l,e.length>0&&Ne(t).unusedInput.push(e),t._a[Mn]<=12&&Ne(t).bigHour===!0&&t._a[Mn]>0&&(Ne(t).bigHour=void 0),Ne(t).parsedDateParts=t._a.slice(0),Ne(t).meridiem=t._meridiem,t._a[Mn]=B6(t._locale,t._a[Mn],t._meridiem),u=Ne(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),fE(t),dE(t)}function B6(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function W6(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ne(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=eE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],gE(e),Q0(e)&&(s=!0),o+=Ne(e).charsLeftOver,o+=Ne(e).unusedTokens.length*10,Ne(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Pa(t,n||e)}function j6(t){if(!t._d){var e=rE(t._i),n=e.day===void 0?e.date:e.day;t._a=vD([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),fE(t)}}function U6(t){var e=new lg(dE(VD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function VD(t){var e=t._i,n=t._f;return t._locale=t._locale||Gs(t._l),e===null||n===void 0&&e===""?Ev({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),io(e)?new lg(dE(e)):(ag(e)?t._d=e:ro(n)?W6(t):n?gE(t):z6(t),Q0(t)||(t._d=null),t))}function z6(t){var e=t._i;Tr(e)?t._d=new Date(Z.now()):ag(e)?t._d=new Date(e.valueOf()):typeof e=="string"?L6(t):ro(e)?(t._a=vD(e.slice(0),function(n){return parseInt(n,10)}),fE(t)):ru(e)?j6(t):Bs(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function BD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ru(t)&&Z0(t)||ro(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,U6(o)}function Nt(t,e,n,r){return BD(t,e,n,r,!1)}var Y6=Pi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ev()}),G6=Pi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Nt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ev()});function WD(t,e){var n,r;if(e.length===1&&ro(e[0])&&(e=e[0]),!e.length)return Nt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function K6(){var t=[].slice.call(arguments,0);return WD("isBefore",t)}function q6(){var t=[].slice.call(arguments,0);return WD("isAfter",t)}var X6=function(){return Date.now?Date.now():+new Date},Dh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function J6(t){var e,n=!1,r,i=Dh.length;for(e in t)if(it(t,e)&&!(an.call(Dh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Dh[r]]){if(n)return!1;parseFloat(t[Dh[r]])!==Ge(t[Dh[r]])&&(n=!0)}return!0}function Z6(){return this._isValid}function Q6(){return ao(NaN)}function Av(t){var e=rE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=J6(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Gs(),this._bubble()}function Ap(t){return t instanceof Av}function sR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function e7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ge(t[s])!==Ge(e[s])&&o++;return o+i}function jD(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Ko(~~(n/60),2)+e+Ko(~~n%60,2)})}jD("Z",":");jD("ZZ","");ue("Z",xv);ue("ZZ",xv);vt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=mE(xv,t)});var t7=/([\+\-]|\d\d)/gi;function mE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(t7)||["-",0,0],o=+(i[1]*60)+Ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function pE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(io(t)||ag(t)?t.valueOf():Nt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Nt(t).local()}function aR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function n7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=mE(xv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=aR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?YD(this,ao(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:aR(this)}function r7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function i7(t){return this.utcOffset(0,t)}function o7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(aR(this),"m")),this}function s7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=mE(TX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function a7(t){return this.isValid()?(t=t?Nt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function l7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function u7(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return eE(t,this),t=VD(t),t._a?(e=t._isUTC?Qo(t._a):Nt(t._a),this._isDSTShifted=this.isValid()&&e7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function c7(){return this.isValid()?!this._isUTC:!1}function h7(){return this.isValid()?this._isUTC:!1}function UD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var d7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,f7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ao(t,e){var n=t,r=null,i,o,s;return Ap(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Bs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=d7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ge(r[Lo])*i,h:Ge(r[Mn])*i,m:Ge(r[eo])*i,s:Ge(r[As])*i,ms:Ge(sR(r[ql]*1e3))*i}):(r=f7.exec(t))?(i=r[1]==="-"?-1:1,n={y:tl(r[2],i),M:tl(r[3],i),w:tl(r[4],i),d:tl(r[5],i),h:tl(r[6],i),m:tl(r[7],i),s:tl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=g7(Nt(n.from),Nt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Av(n),Ap(t)&&it(t,"_locale")&&(o._locale=t._locale),Ap(t)&&it(t,"_isValid")&&(o._isValid=t._isValid),o}ao.fn=Av.prototype;ao.invalid=Q6;function tl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Wx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function g7(t,e){var n;return t.isValid()&&e.isValid()?(e=pE(e,t),t.isBefore(e)?n=Wx(t,e):(n=Wx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function zD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(CD(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ao(n,r),YD(this,i,t),this}}function YD(t,e,n,r){var i=e._milliseconds,o=sR(e._days),s=sR(e._months);t.isValid()&&(r=r??!0,s&&ID(t,Rf(t,"Month")+s*n),o&&_D(t,"Date",Rf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var m7=zD(1,"add"),p7=zD(-1,"subtract");function GD(t){return typeof t=="string"||t instanceof String}function w7(t){return io(t)||ag(t)||GD(t)||Bs(t)||y7(t)||v7(t)||t===null||t===void 0}function v7(t){var e=ru(t)&&!Z0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||it(t,o);return e&&n}function y7(t){var e=ro(t),n=!1;return e&&(n=t.filter(function(r){return!Bs(r)&&GD(t)}).length===0),e&&n}function C7(t){var e=ru(t)&&!Z0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||it(t,o);return e&&n}function b7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function S7(t,e){arguments.length===1&&(arguments[0]?w7(arguments[0])?(t=arguments[0],e=void 0):C7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Nt(),r=pE(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(es(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Nt(n)))}function R7(){return new lg(this)}function E7(t,e){var n=io(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function T7(t,e){var n=io(t)?t:Nt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function M7(t,e,n,r){var i=io(t)?t:Nt(t),o=io(e)?e:Nt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function _7(t,e){var n=io(t)?t:Nt(t),r;return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function P7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function x7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function I7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=pE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=xi(e),e){case"year":o=Hp(this,r)/12;break;case"month":o=Hp(this,r);break;case"quarter":o=Hp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:wi(o)}function Hp(t,e){if(t.date()<e.date())return-Hp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function O7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function A7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Op(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):es(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Op(n,"Z")):Op(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function H7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function N7(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Op(this,t);return this.localeData().postformat(e)}function D7(t,e){return this.isValid()&&(io(t)&&t.isValid()||Nt(t).isValid())?ao({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function k7(t){return this.from(Nt(),t)}function $7(t,e){return this.isValid()&&(io(t)&&t.isValid()||Nt(t).isValid())?ao({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function L7(t){return this.to(Nt(),t)}function KD(t){var e;return t===void 0?this._locale._abbr:(e=Gs(t),e!=null&&(this._locale=e),this)}var qD=Pi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function XD(){return this._locale}var Cw=1e3,Lc=60*Cw,bw=60*Lc,JD=(365*400+97)*24*bw;function Fc(t,e){return(t%e+e)%e}function ZD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-JD:new Date(t,e,n).valueOf()}function QD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-JD:Date.UTC(t,e,n)}function F7(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?QD:ZD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Fc(e+(this._isUTC?0:this.utcOffset()*Lc),bw);break;case"minute":e=this._d.valueOf(),e-=Fc(e,Lc);break;case"second":e=this._d.valueOf(),e-=Fc(e,Cw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function V7(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?QD:ZD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=bw-Fc(e+(this._isUTC?0:this.utcOffset()*Lc),bw)-1;break;case"minute":e=this._d.valueOf(),e+=Lc-Fc(e,Lc)-1;break;case"second":e=this._d.valueOf(),e+=Cw-Fc(e,Cw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function B7(){return this._d.valueOf()-(this._offset||0)*6e4}function W7(){return Math.floor(this.valueOf()/1e3)}function j7(){return new Date(this.valueOf())}function U7(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function z7(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Y7(){return this.isValid()?this.toISOString():null}function G7(){return Q0(this)}function K7(){return Pa({},Ne(this))}function q7(){return Ne(this).overflow}function X7(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",wE);ue("NN",wE);ue("NNN",wE);ue("NNNN",a9);ue("NNNNN",l9);vt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ne(n).era=i:Ne(n).invalidEra=t});ue("y",dh);ue("yy",dh);ue("yyy",dh);ue("yyyy",dh);ue("yo",u9);vt(["y","yy","yyy","yyyy"],Xn);vt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function J7(t,e){var n,r,i,o=this._eras||Gs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function Z7(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function Q7(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function e9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function t9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function n9(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function r9(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function i9(t){return it(this,"_erasNameRegex")||vE.call(this),t?this._erasNameRegex:this._erasRegex}function o9(t){return it(this,"_erasAbbrRegex")||vE.call(this),t?this._erasAbbrRegex:this._erasRegex}function s9(t){return it(this,"_erasNarrowRegex")||vE.call(this),t?this._erasNarrowRegex:this._erasRegex}function wE(t,e){return e.erasAbbrRegex(t)}function a9(t,e){return e.erasNameRegex(t)}function l9(t,e){return e.erasNarrowRegex(t)}function u9(t,e){return e._eraYearOrdinalRegex||dh}function vE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Fs(u[i].name),a=Fs(u[i].abbr),l=Fs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Hv(t,e){Ce(0,[t,t.length],0,e)}Hv("gggg","weekYear");Hv("ggggg","weekYear");Hv("GGGG","isoWeekYear");Hv("GGGGG","isoWeekYear");ue("G",Pv);ue("g",Pv);ue("GG",Dt,ti);ue("gg",Dt,ti);ue("GGGG",oE,iE);ue("gggg",oE,iE);ue("GGGGG",_v,Tv);ue("ggggg",_v,Tv);cg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ge(t)});cg(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function c9(t){return ek.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function h9(t){return ek.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function d9(){return Vs(this.year(),1,4)}function f9(){return Vs(this.isoWeekYear(),1,4)}function g9(){var t=this.localeData()._week;return Vs(this.year(),t.dow,t.doy)}function m9(){var t=this.localeData()._week;return Vs(this.weekYear(),t.dow,t.doy)}function ek(t,e,n,r,i){var o;return t==null?Tf(this,r,i).year:(o=Vs(t,r,i),e>o&&(e=o),p9.call(this,t,e,n,r,i))}function p9(t,e,n,r,i){var o=HD(t,e,n,r,i),s=Ef(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",SD);vt("Q",function(t,e){e[Os]=(Ge(t)-1)*3});function w9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Dt,fh);ue("DD",Dt,ti);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});vt(["D","DD"],Lo);vt("Do",function(t,e){e[Lo]=Ge(t.match(Dt)[0])});var tk=gh("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Mv);ue("DDDD",RD);vt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ge(t)});function v9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Dt,sE);ue("mm",Dt,ti);vt(["m","mm"],eo);var y9=gh("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Dt,sE);ue("ss",Dt,ti);vt(["s","ss"],As);var C9=gh("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Mv,SD);ue("SS",Mv,ti);ue("SSS",Mv,RD);var xa,nk;for(xa="SSSS";xa.length<=9;xa+="S")ue(xa,dh);function b9(t,e){e[ql]=Ge(("0."+t)*1e3)}for(xa="S";xa.length<=9;xa+="S")vt(xa,b9);nk=gh("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function S9(){return this._isUTC?"UTC":""}function R9(){return this._isUTC?"Coordinated Universal Time":""}var ee=lg.prototype;ee.add=m7;ee.calendar=S7;ee.clone=R7;ee.diff=I7;ee.endOf=V7;ee.format=N7;ee.from=D7;ee.fromNow=k7;ee.to=$7;ee.toNow=L7;ee.get=HX;ee.invalidAt=q7;ee.isAfter=E7;ee.isBefore=T7;ee.isBetween=M7;ee.isSame=_7;ee.isSameOrAfter=P7;ee.isSameOrBefore=x7;ee.isValid=G7;ee.lang=qD;ee.locale=KD;ee.localeData=XD;ee.max=G6;ee.min=Y6;ee.parsingFlags=K7;ee.set=NX;ee.startOf=F7;ee.subtract=p7;ee.toArray=U7;ee.toObject=z7;ee.toDate=j7;ee.toISOString=A7;ee.inspect=H7;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=Y7;ee.toString=O7;ee.unix=W7;ee.valueOf=B7;ee.creationData=X7;ee.eraName=e9;ee.eraNarrow=t9;ee.eraAbbr=n9;ee.eraYear=r9;ee.year=MD;ee.isLeapYear=AX;ee.weekYear=c9;ee.isoWeekYear=h9;ee.quarter=ee.quarters=w9;ee.month=OD;ee.daysInMonth=jX;ee.week=ee.weeks=JX;ee.isoWeek=ee.isoWeeks=ZX;ee.weeksInYear=g9;ee.weeksInWeekYear=m9;ee.isoWeeksInYear=d9;ee.isoWeeksInISOWeekYear=f9;ee.date=tk;ee.day=ee.days=h6;ee.weekday=d6;ee.isoWeekday=f6;ee.dayOfYear=v9;ee.hour=ee.hours=C6;ee.minute=ee.minutes=y9;ee.second=ee.seconds=C9;ee.millisecond=ee.milliseconds=nk;ee.utcOffset=n7;ee.utc=i7;ee.local=o7;ee.parseZone=s7;ee.hasAlignedHourOffset=a7;ee.isDST=l7;ee.isLocal=c7;ee.isUtcOffset=h7;ee.isUtc=UD;ee.isUTC=UD;ee.zoneAbbr=S9;ee.zoneName=R9;ee.dates=Pi("dates accessor is deprecated. Use date instead.",tk);ee.months=Pi("months accessor is deprecated. Use month instead",OD);ee.years=Pi("years accessor is deprecated. Use year instead",MD);ee.zone=Pi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",r7);ee.isDSTShifted=Pi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",u7);function E9(t){return Nt(t*1e3)}function T9(){return Nt.apply(null,arguments).parseZone()}function rk(t){return t}var ot=tE.prototype;ot.calendar=cX;ot.longDateFormat=gX;ot.invalidDate=pX;ot.ordinal=yX;ot.preparse=rk;ot.postformat=rk;ot.relativeTime=bX;ot.pastFuture=SX;ot.set=lX;ot.eras=J7;ot.erasParse=Z7;ot.erasConvertYear=Q7;ot.erasAbbrRegex=o9;ot.erasNameRegex=i9;ot.erasNarrowRegex=s9;ot.months=FX;ot.monthsShort=VX;ot.monthsParse=WX;ot.monthsRegex=zX;ot.monthsShortRegex=UX;ot.week=GX;ot.firstDayOfYear=XX;ot.firstDayOfWeek=qX;ot.weekdays=s6;ot.weekdaysMin=l6;ot.weekdaysShort=a6;ot.weekdaysParse=c6;ot.weekdaysRegex=g6;ot.weekdaysShortRegex=m6;ot.weekdaysMinRegex=p6;ot.isPM=v6;ot.meridiem=b6;function Sw(t,e,n,r){var i=Gs(),o=Qo().set(r,e);return i[n](o,t)}function ik(t,e,n){if(Bs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Sw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Sw(t,r,n,"month");return i}function yE(t,e,n,r){typeof t=="boolean"?(Bs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Bs(e)&&(n=e,e=void 0),e=e||"");var i=Gs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Sw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Sw(e,(s+o)%7,r,"day");return a}function M9(t,e){return ik(t,e,"months")}function _9(t,e){return ik(t,e,"monthsShort")}function P9(t,e,n){return yE(t,e,n,"weekdays")}function x9(t,e,n){return yE(t,e,n,"weekdaysShort")}function I9(t,e,n){return yE(t,e,n,"weekdaysMin")}Da("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Pi("moment.lang is deprecated. Use moment.locale instead.",Da);Z.langData=Pi("moment.langData is deprecated. Use moment.localeData instead.",Gs);var os=Math.abs;function O9(){var t=this._data;return this._milliseconds=os(this._milliseconds),this._days=os(this._days),this._months=os(this._months),t.milliseconds=os(t.milliseconds),t.seconds=os(t.seconds),t.minutes=os(t.minutes),t.hours=os(t.hours),t.months=os(t.months),t.years=os(t.years),this}function ok(t,e,n,r){var i=ao(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function A9(t,e){return ok(this,t,e,1)}function H9(t,e){return ok(this,t,e,-1)}function jx(t){return t<0?Math.floor(t):Math.ceil(t)}function N9(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=jx(lR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=wi(t/1e3),r.seconds=i%60,o=wi(i/60),r.minutes=o%60,s=wi(o/60),r.hours=s%24,e+=wi(s/24),l=wi(sk(e)),n+=l,e-=jx(lR(l)),a=wi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function sk(t){return t*4800/146097}function lR(t){return t*146097/4800}function D9(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=xi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+sk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(lR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Ks(t){return function(){return this.as(t)}}var ak=Ks("ms"),k9=Ks("s"),$9=Ks("m"),L9=Ks("h"),F9=Ks("d"),V9=Ks("w"),B9=Ks("M"),W9=Ks("Q"),j9=Ks("y"),U9=ak;function z9(){return ao(this)}function Y9(t){return t=xi(t),this.isValid()?this[t+"s"]():NaN}function Tu(t){return function(){return this.isValid()?this._data[t]:NaN}}var G9=Tu("milliseconds"),K9=Tu("seconds"),q9=Tu("minutes"),X9=Tu("hours"),J9=Tu("days"),Z9=Tu("months"),Q9=Tu("years");function e8(){return wi(this.days()/7)}var Es=Math.round,Pc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function t8(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function n8(t,e,n,r){var i=ao(t).abs(),o=Es(i.as("s")),s=Es(i.as("m")),a=Es(i.as("h")),l=Es(i.as("d")),u=Es(i.as("M")),c=Es(i.as("w")),h=Es(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,t8.apply(null,d)}function r8(t){return t===void 0?Es:typeof t=="function"?(Es=t,!0):!1}function i8(t,e){return Pc[t]===void 0?!1:e===void 0?Pc[t]:(Pc[t]=e,t==="s"&&(Pc.ss=e-1),!0)}function o8(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Pc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Pc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=n8(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var hC=Math.abs;function Nu(t){return(t>0)-(t<0)||+t}function Nv(){if(!this.isValid())return this.localeData().invalidDate();var t=hC(this._milliseconds)/1e3,e=hC(this._days),n=hC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=wi(t/60),i=wi(r/60),t%=60,r%=60,o=wi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Nu(this._months)!==Nu(a)?"-":"",c=Nu(this._days)!==Nu(a)?"-":"",h=Nu(this._milliseconds)!==Nu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ze=Av.prototype;Ze.isValid=Z6;Ze.abs=O9;Ze.add=A9;Ze.subtract=H9;Ze.as=D9;Ze.asMilliseconds=ak;Ze.asSeconds=k9;Ze.asMinutes=$9;Ze.asHours=L9;Ze.asDays=F9;Ze.asWeeks=V9;Ze.asMonths=B9;Ze.asQuarters=W9;Ze.asYears=j9;Ze.valueOf=U9;Ze._bubble=N9;Ze.clone=z9;Ze.get=Y9;Ze.milliseconds=G9;Ze.seconds=K9;Ze.minutes=q9;Ze.hours=X9;Ze.days=J9;Ze.weeks=e8;Ze.months=Z9;Ze.years=Q9;Ze.humanize=o8;Ze.toISOString=Nv;Ze.toString=Nv;Ze.toJSON=Nv;Ze.locale=KD;Ze.localeData=XD;Ze.toIsoString=Pi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Nv);Ze.lang=qD;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Pv);ue("X",MX);vt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});vt("x",function(t,e,n){n._d=new Date(Ge(t))});//! moment.js
Z.version="2.30.1";sX(Nt);Z.fn=ee;Z.min=K6;Z.max=q6;Z.now=X6;Z.utc=Qo;Z.unix=E9;Z.months=M9;Z.isDate=ag;Z.locale=Da;Z.invalid=Ev;Z.duration=ao;Z.isMoment=io;Z.weekdays=P9;Z.parseZone=T9;Z.localeData=Gs;Z.isDuration=Ap;Z.monthsShort=_9;Z.weekdaysMin=I9;Z.defineLocale=hE;Z.updateLocale=T6;Z.locales=M6;Z.weekdaysShort=x9;Z.normalizeUnits=xi;Z.relativeTimeRounding=r8;Z.relativeTimeThreshold=i8;Z.calendarFormat=b7;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function lk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function uR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function zd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Sn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ba(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function _(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function uk(t){return Sn(t,(e,n)=>e+n,0)}function s8(t){return Sn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function a8(t){return Sn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function l8(t){return t.length?uk(t)/t.length:0}function ck(t){return Sn(t,(e,n)=>e.concat(Array.isArray(n)?ck(n):n),[])}function hk(t){const e=[];return _(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function cR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function u8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>s.includes(a))}),o}function c8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return _(i,s=>{_(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function hR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const h8=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:l8,arrayEach:_,arrayFilter:Ba,arrayFlatten:ck,arrayMap:Ue,arrayMax:s8,arrayMin:a8,arrayReduce:Sn,arraySum:uk,arrayUnique:hk,extendArray:uR,getDifferenceOfArrays:cR,getIntersectionOfArrays:u8,getUnionOfArrays:c8,pivot:zd,stringToArray:hR,to2dArray:lk},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Sn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Tt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Ht(t){return typeof t>"u"}function Yt(t){return t===null||t===""||Ht(t)}function dk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Dd="length",Yd=t=>parseInt(t,16),Ux=t=>parseInt(t,10),Rw=(t,e,n)=>t.substr(e,n),Gd=t=>t.codePointAt(0)-65,dR=t=>`${t}`.replace(/\-/g,""),d8=t=>Yd(Rw(dR(t),Yd("12"),Gd("F")))/(Yd(Rw(dR(t),Gd("B"),~~![][Dd]))||9),f8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let zx=!1;const Yx={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Gx={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function fk(t,e){const n=!Yt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=dR(t||"");const l=g8(t);if(n||r||l)if(l){const u=Z("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=d8(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(f8()&&(s="valid",a="valid"),!zx&&s!=="valid"&&(Yx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Yx[s]({keyValidityDate:o,hotVersion:i})),zx=!0),a!=="valid"&&e.parentNode&&Gx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Gx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function g8(t){let e=[][Dd],n=e;if(t[Dd]!==Gd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Gd(i.shift());o;o=Gd(i.shift()||"A"))--o<""[Dd]?n=n|(Ux(`${Ux(Yd(r)+(Yd(Rw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Rw(t,o,o?i[Dd]===1?9:8:6);return n===e}const m8=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:fk,isDefined:le,isEmpty:Yt,isRegExp:dk,isUndefined:Ht,stringify:Tt},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function p8(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Tt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function CE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function bE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function SE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function fR(t){return Dv(`${t}`,{ALLOWED_TAGS:[]})}function Dv(t,e){return oX.sanitize(t,e)}const w8=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:p8,isPercentValue:bE,randomString:CE,sanitize:Dv,stripTags:fR,substitute:SE,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),Mu=t=>["tabindex",t],v8=()=>["role","treegrid"],Hs=()=>["role","presentation"],y8=()=>["role","gridcell"],C8=()=>["role","rowheader"],gk=()=>["role","rowgroup"],b8=()=>["role","columnheader"],gR=()=>["role","row"],S8=()=>["role","menu"],R8=()=>["role","menuitem"],E8=()=>["role","menuitemcheckbox"],T8=()=>["role","combobox"],mk=()=>["role","listbox"],M8=()=>["role","option"],_8=()=>["role","checkbox"],P8=()=>["scope","col"],x8=()=>["scope","row"],I8=()=>["type","text"],_f=t=>["aria-label",t],_u=()=>["aria-hidden","true"],O8=()=>["aria-disabled","true"],A8=()=>["aria-multiselectable","true"],pk=t=>["aria-haspopup",t],wk=t=>["aria-rowcount",t],kv=t=>["aria-colcount",t],vk=t=>["aria-rowindex",t],RE=t=>["aria-colindex",t],bi=t=>["aria-expanded",t],H8=t=>["aria-sort",t],Kx=()=>["aria-readonly","true"],qx=()=>["aria-invalid","true"],yk=t=>["aria-checked",t],EE=()=>["aria-selected","true"],N8=()=>["aria-autocomplete","list"],D8=t=>["aria-controls",t],k8=t=>["aria-activedescendant",t],$8=t=>["aria-live",t],L8=t=>["aria-relevant",t],F8=t=>["aria-setsize",t],V8=t=>["aria-posinset",t];function Ck(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Kd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function bk(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function uu(t){return bk(t)&&t.parent}function B8(t){return!!Object.getPrototypeOf(t.parent)}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function kd(t,e,n){const r=[];let i=t;for(;i&&(i=Wa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Sk(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function ka(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Rk(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ga(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Ek(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Tk(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=Ek(e),e.length>0&&t.classList.add(...e)}function we(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Tk(e,!0);n=Ek(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Pu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Tk(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function TE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)TE(e[n])}}function qo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Mk=/(<(.*)>|&(.*);)/;function xu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Mk.test(e)?t.innerHTML=n?Dv(e):e:ja(t,e)}function ja(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(qo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function cu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return cu(r.host.impl);if(r.host)return cu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function _k(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Ln(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function ME(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function $v(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Lv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ME(e):t.scrollTop}function _E(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?$v(e):t.scrollLeft}function Pf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Pk(t){return t.scrollHeight-t.clientHeight}function xk(t){return t.scrollWidth-t.clientWidth}function Xc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function xf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function W8(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Qt(t){return t.offsetWidth}function un(t){return t.offsetHeight}function Vc(t){return t.clientHeight||t.innerHeight}function PE(t){return t.clientWidth||t.innerWidth}function j8(t,e,n){t.addEventListener(e,n,!1)}function U8(t,e,n){t.removeEventListener(e,n,!1)}function xE(t){return t.selectionStart?t.selectionStart:0}function Ik(t){return t.selectionEnd?t.selectionEnd:0}function z8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function mR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function hg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let dC;function Y8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function _n(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return dC===void 0&&(dC=Y8(t)),dC}function IE(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function OE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Fv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function G8(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function dg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function qd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Vv(t){return qd(t)&&t.hasAttribute("data-hot-input")===!1}function K8(t){const e=t.ownerDocument.activeElement;Vv(e)||t.select()}function AE(t){return!t.parentNode}function Ok(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function HE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,..._u()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function NE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&we(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Ak(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HE(t,n),e(),NE(t,n)}function zo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const q8=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Mk,addClass:q,addEvent:j8,clearTextSelection:mR,closest:Wa,closestDown:kd,empty:qo,fastInnerHTML:xu,fastInnerText:ja,findFirstParentWithClass:Sk,getCaretPosition:xE,getCssTransform:G8,getFrameElement:bk,getMaximumScrollLeft:xk,getMaximumScrollTop:Pk,getParent:Ck,getParentWindow:uu,getScrollLeft:_E,getScrollTop:Lv,getScrollableElement:Pf,getScrollbarWidth:_n,getSelectionEndPosition:Ik,getSelectionText:z8,getStyle:xf,getTrimmingContainer:Xc,getWindowScrollLeft:$v,getWindowScrollTop:ME,hasAccessToParentWindow:B8,hasClass:ve,hasHorizontalScrollbar:OE,hasVerticalScrollbar:IE,hasZeroHeight:_k,index:Rk,innerHeight:Vc,innerWidth:PE,isChildOf:ka,isDetached:AE,isHTMLElement:zo,isInput:qd,isInternalElement:Kd,isOutsideInput:Vv,isVisible:cu,makeElementContentEditableAndSelectItsContent:HE,matchesCSSRules:W8,observeVisibilityChangeOnce:Ok,offset:Ln,outerHeight:un,outerWidth:Qt,overlayContainsElement:ga,removeAttribute:Pu,removeClass:we,removeContentEditableFromElementAndDeselect:NE,removeEvent:U8,removeTextNodes:TE,resetCssTransform:dg,runWithSelectedContendEditableElement:Ak,selectElementIfAllowed:K8,setAttribute:be,setCaretPosition:hg,setOverlayPosition:Fv},Symbol.toStringTag,{value:"Module"}));function ut(t){return typeof t=="function"}function Hk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function X8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Hk(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function fg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function J8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Sn(i,(u,c)=>c(u),r.apply(this,a))}}function DE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Nk(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Z8(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Ew(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const Q8=Object.freeze(Object.defineProperty({__proto__:null,curry:Nk,curryRight:Z8,debounce:fg,fastCall:Ew,isFunction:ut,partial:DE,pipe:J8,throttle:Hk,throttleAfterHits:X8},Symbol.toStringTag,{value:"Module"}));var eJ=dn,Xx=TN,tJ=Cn,Jx=yu,nJ=Rv,Zx=eJ([].push),rJ=function(t){if(tJ(t))return t;if(Xx(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?Zx(n,i):(typeof i=="number"||Jx(i)==="Number"||Jx(i)==="String")&&Zx(n,nJ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(Xx(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},iJ=Ct,Dk=ah,kk=ig,oJ=yn,gg=dn,$k=Nn,Qx=Cn,eI=H0,Lk=X0,sJ=rJ,aJ=A0,lJ=String,$a=Dk("JSON","stringify"),Gg=gg(/./.exec),tI=gg("".charAt),uJ=gg("".charCodeAt),cJ=gg("".replace),hJ=gg(1 .toString),dJ=/[\uD800-\uDFFF]/g,nI=/^[\uD800-\uDBFF]$/,rI=/^[\uDC00-\uDFFF]$/,iI=!aJ||$k(function(){var t=Dk("Symbol")("stringify detection");return $a([t])!=="[null]"||$a({a:t})!=="{}"||$a(Object(t))!=="{}"}),oI=$k(function(){return $a("\uDF06\uD834")!=='"\\udf06\\ud834"'||$a("\uDEAD")!=='"\\udead"'}),fJ=function(t,e){var n=Lk(arguments),r=sJ(e);if(!(!Qx(r)&&(t===void 0||eI(t))))return n[1]=function(i,o){if(Qx(r)&&(o=oJ(r,this,lJ(i),o)),!eI(o))return o},kk($a,null,n)},gJ=function(t,e,n){var r=tI(n,e-1),i=tI(n,e+1);return Gg(nI,t)&&!Gg(rI,i)||Gg(rI,t)&&!Gg(nI,r)?"\\u"+hJ(uJ(t,0),16):t};$a&&iJ({target:"JSON",stat:!0,arity:3,forced:iI||oI},{stringify:function(e,n,r){var i=Lk(arguments),o=kk(iI?fJ:$a,null,i);return oI&&typeof o=="string"?cJ(o,dJ,gJ):o}});function Jc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Jc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Jc(n[0])]:e[r]=[]:e[r]=null)})),e}function Fk(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function cn(t,e,n){const r=Array.isArray(n);return ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function mg(t,e){ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),mg(t[r],e[r])):t[r]=e[r]})}function Qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function oo(t){const e={};return ke(t,(n,r)=>{e[r]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _(n,i=>{t.MIXINS.push(i.MIXIN_NAME),ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let v=g;return(Array.isArray(v)||De(v))&&(v=Qn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Bv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function De(t){return Object.prototype.toString.call(t)==="[object Object]"}function ts(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Vk(t,e){const n=e.split(".");let r=t;return ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Np(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(ln(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Wv(t){if(!De(t))return 0;const e=function(n){let r=0;return De(n)?ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const mJ=Object.freeze(Object.defineProperty({__proto__:null,clone:oo,createObjectPropListener:Hr,deepClone:Qn,deepExtend:mg,deepObjectSize:Wv,defineGetter:ts,duckSchema:Jc,extend:cn,getProperty:Vk,hasOwnProperty:ln,inherit:Fk,isObject:De,isObjectEqual:Bv,mixin:mt,objectEach:ke,setProperty:Np},Symbol.toStringTag,{value:"Module"}));function If(t){return window.requestAnimationFrame(t)}function Of(t){window.cancelAnimationFrame(t)}function kE(){return"ontouchstart"in window}function Bk(){return typeof window<"u"}let Du;function Wk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Du||(typeof Intl=="object"?Du=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Du=(n,r)=>`${n}`.localeCompare(r):Du=(n,r)=>n===r?0:n>r?-1:1,Du)}const pJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Of,getComparisonFunction:Wk,isCSR:Bk,isTouchSupported:kE,requestAnimationFrame:If},Symbol.toStringTag,{value:"Module"})),di=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},qs={chrome:di((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:di(t=>/CriOS/.test(t)),edge:di(t=>/Edge/.test(t)),edgeWebKit:di(t=>/EdgiOS/.test(t)),firefox:di(t=>/Firefox/.test(t)),firefoxWebKit:di(t=>/FxiOS/.test(t)),mobile:di(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:di((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},mh={mac:di(t=>/^Mac/.test(t)),win:di(t=>/^Win/.test(t)),linux:di(t=>/^Linux/.test(t)),ios:di(t=>/iPhone|iPad|iPod/i.test(t))};function jk(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(qs,n=>{let{test:r}=n;return void r(t,e)})}function Uk(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(mh,e=>{let{test:n}=e;return void n(t)})}Bk()&&(jk(),Uk());function $E(){return qs.chrome.value}function zk(){return qs.chromeWebKit.value}function Dp(){return qs.firefox.value}function Yk(){return qs.firefoxWebKit.value}function Af(){return qs.safari.value}function Gk(){return qs.edge.value}function wJ(){return qs.edgeWebKit.value}function jo(){return qs.mobile.value}function LE(){return mh.ios.value}function FE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&mh.mac.value}function pR(){return mh.win.value}function Tw(){return mh.mac.value}function vJ(){return mh.linux.value}const yJ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:$E,isChromeWebKit:zk,isEdge:Gk,isEdgeWebKit:wJ,isFirefox:Dp,isFirefoxWebKit:Yk,isIOS:LE,isIpadOS:FE,isLinuxOS:vJ,isMacOS:Tw,isMobileBrowser:jo,isSafari:Af,isWindowsOS:pR,setBrowserMeta:jk,setPlatformMeta:Uk},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Dp()?182:174,AUDIO_MUTE:Dp()?181:173,AUDIO_UP:Dp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},CJ=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function Kk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function VE(t){return CJ.includes(t)}function bJ(t){const e=[];return Tw()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function qk(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function ph(t,e){const n=e.split("|");let r=!1;return _(n,i=>{if(t===de[i])return r=!0,!1}),r}const SJ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:bJ,isCtrlMetaKey:qk,isFunctionKey:VE,isKey:ph,isPrintableChar:Kk},Symbol.toStringTag,{value:"Module"}));function Ii(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Sa(t){return t.isImmediatePropagationEnabled===!1}function Ua(t){return t.button===2}function jv(t){return t.button===0}function Xk(t){return t instanceof TouchEvent}function Jk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!zo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const RJ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Sa,isLeftClick:jv,isRightClick:Ua,isTouchEvent:Xk,offsetRelativeTo:Jk,stopImmediatePropagation:Ii},Symbol.toStringTag,{value:"Module"}));function nt(){le(console)&&console.warn(...arguments)}function BE(){le(console)&&console.error(...arguments)}const Yl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],fC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),gC=new Map([[]]);var EJ=ch,TJ=function(t,e,n){for(var r=0,i=arguments.length>2?n:EJ(e),o=new t(i);i>r;)o[r]=e[r++];return o},MJ=vn,_J=function(t,e){var n=MJ[t],r=n&&n.prototype;return r&&r[e]},PJ=so,xJ=UN,IJ=Ys.f,wR=PJ("unscopables"),vR=Array.prototype;vR[wR]===void 0&&IJ(vR,wR,{configurable:!0,value:xJ(null)});var Uv=function(t){vR[wR][t]=!0},OJ=Ct,AJ=dn,HJ=Dr,NJ=Qf,DJ=TJ,kJ=_J,$J=Uv,LJ=Array,FJ=AJ(kJ("Array","sort"));OJ({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&HJ(e);var n=NJ(this),r=DJ(LJ,n);return FJ(r,e)}});$J("toSorted");var VJ=Ct,BJ=yn,WJ=hh,jJ=Dr,UJ=bn,zJ=Zo,YJ=ei,GJ=Ka,mC=GJ("find",TypeError);VJ({target:"Iterator",proto:!0,real:!0,forced:mC},{find:function(e){UJ(this);try{jJ(e)}catch(i){YJ(this,"throw",i)}if(mC)return BJ(mC,this,e);var n=zJ(this),r=0;return WJ(n,function(i,o){if(e(i,r++))return o(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function KJ(t,e){Zk(t,e),e.add(t)}function pC(t,e,n){Zk(t,e),e.set(t,n)}function Zk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sI(t,e,n){return t.set(Mw(t,e),n),n}function $n(t,e){return t.get(Mw(t,e))}function Mw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qJ=100;var Vr=new WeakMap,yc=new WeakMap,wC=new WeakMap,vC=new WeakSet;class aI{constructor(){KJ(this,vC),pC(this,Vr,new Map),pC(this,yc,new Map),pC(this,wC,new Set),Yl.forEach(e=>Mw(vC,this,lI).call(this,e))}getHooks(e){var n;return(n=$n(Vr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};$n(Vr,this).has(e)||(Mw(vC,this,lI).call(this,e),Yl.push(e));const i=$n(Vr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=$n(wC,this).has(e);!u&&o!==0&&(u=!0,$n(wC,this).add(e)),u&&i.length>1&&$n(Vr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return $n(Vr,this).has(e)&&$n(Vr,this).get(e).length>0}remove(e,n){if(!$n(Vr,this).has(e))return!1;const r=$n(Vr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=$n(yc,this).get(e);return i.skip=!0,o+=1,o>qJ&&($n(Vr,this).set(e,r.filter(s=>!s.skip)),o=0),$n(yc,this).set(e,o),!0}return!1}destroy(){$n(Vr,this).clear(),$n(yc,this).clear(),sI(Vr,this,null),sI(yc,this,null)}}function lI(t){$n(Vr,this).set(t,[]),$n(yc,this).set(t,0)}function XJ(t,e,n){return(e=JJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const QJ=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){XJ(this,"globalBucket",new aI)}static getSingleton(){return tZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new aI),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.add(e,o,r)):(fC.has(e)&&nt(SE(QJ,{hookName:e,removedInVersion:fC.get(e)})),gC.has(e)&&nt(gC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?_(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Ew(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Ew(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Yl.push(e)}deregister(e){this.isRegistered(e)&&Yl.splice(Yl.indexOf(e),1)}isDeprecated(e){return gC.has(e)||fC.has(e)}isRegistered(e){return Yl.indexOf(e)>=0}getRegistered(){return Yl}}const eZ=new oe;function tZ(){return eZ}const yC=new Map;function lo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";yC.has(t)||yC.set(t,new Map);const e=yC.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const yR=new WeakMap,{register:nZ,getItem:Qk,hasItem:e$,getNames:rZ,getValues:i0e}=lo("editors");function iZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function t$(t,e){let n;if(typeof t=="function")yR.get(t)||Mr(null,t),n=yR.get(t);else if(typeof t=="string")n=Qk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function _w(t){if(typeof t=="function")return t;if(!e$(t))throw Error(`No registered editor found under "${t}" name`);return Qk(t).getConstructor()}function Mr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new iZ(e);typeof t=="string"&&nZ(t,n),yR.set(e,n)}function oZ(t,e,n){return(e=sZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sZ(t){var e=aZ(t,"string");return typeof e=="symbol"?e:e+""}function aZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let kp=0;class Ei{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;oZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,lZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),kp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),kp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),kp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function lZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ii(this)},t}function uZ(){return kp}function cZ(t,e){hZ(t,e),e.add(t)}function hZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){return(e=dZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dZ(t){var e=fZ(t,"string");return typeof e=="symbol"?e:e+""}function fZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kg=new WeakSet;class CR{constructor(e,n,r){cZ(this,Kg),nl(this,"hot",void 0),nl(this,"tableMeta",void 0),nl(this,"selection",void 0),nl(this,"eventManager",void 0),nl(this,"destroyed",!1),nl(this,"activeEditor",void 0),nl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Ei(e),this.hot.addHook("afterDocumentKeyDown",i=>CC(Kg,this,uI).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>CC(Kg,this,uI).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>CC(Kg,this,gZ).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=t$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function uI(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Sa(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!VE(n)&&!qk(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function gZ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const cI=new WeakMap;CR.getInstance=function(t,e,n){let r=cI.get(t);return r||(r=new CR(t,e,n),cI.set(t,r)),r};function mZ(t,e){n$(t,e),e.add(t)}function kh(t,e,n){n$(t,e),e.set(t,n)}function n$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(Ps(t,e))}function $h(t,e,n){return t.set(Ps(t,e),n),n}function Ps(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bc=Object.freeze({CELL:"cell",MIXED:"mixed"});var wn=new WeakMap,qg=new WeakMap,Xg=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,wa=new WeakSet;class pZ{constructor(e){var n=this;mZ(this,wa),kh(this,wn,void 0),kh(this,qg,void 0),kh(this,Xg,1),kh(this,Jg,null),kh(this,Zg,new Map);const r=e.getSettings();$h(wn,this,e),$h(qg,this,r.imeFastEdit?Bc.MIXED:Bc.CELL),St(wn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,vZ).call(n,...o)}),St(wn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,hI).call(n,...o)}),St(wn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,hI).call(n,...o)}),St(wn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ps(wa,n,wZ).call(n,...o)})}getFocusMode(){return St(qg,this)}setFocusMode(e){Object.values(Bc).includes(e)?$h(qg,this,e):nt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return St(Xg,this)}setRefocusDelay(e){$h(Xg,this,e)}setRefocusElementGetter(e){$h(Jg,this,e)}getRefocusElement(){var e;return typeof St(Jg,this)=="function"?St(Jg,this).call(this):(e=St(wn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=St(wn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=St(wn,this).runHooks("modifyFocusedElement",s.row,s.col,r);zo(a)||(a=r),a&&!((o=St(wn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Ps(wa,this,WE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:St(Xg,this);if(St(wn,this).getSettings().imeFastEdit&&!((e=St(wn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=St(wn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),St(Zg,this).has(n)||St(Zg,this).set(n,fg(()=>{if(!St(wn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),St(Zg,this).get(n)()}}}function WE(t){var e;const n=(e=St(wn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!St(wn,this).selection.isCellVisible(n)){t(null);return}const r=St(wn,this).getCell(n.row,n.col,!0);r===null?St(wn,this).addHookOnce("afterScroll",()=>{t(St(wn,this).getCell(n.row,n.col,!0))}):t(r)}function hI(){Ps(wa,this,WE).call(this,t=>{const{activeElement:e}=St(wn,this).rootDocument;e&&Vv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function wZ(){Ps(wa,this,WE).call(this,t=>{this.getFocusMode()===Bc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function vZ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Bc.MIXED:Bc.CELL)}var yZ=Mi,CZ=yu,bZ=so,SZ=bZ("match"),RZ=function(t){var e;return yZ(t)&&((e=t[SZ])!==void 0?!!e:CZ(t)==="RegExp")},EZ=bn,TZ=function(){var t=EZ(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},MZ=yn,_Z=_i,PZ=eg,xZ=TZ,dI=RegExp.prototype,IZ=function(t){var e=t.flags;return e===void 0&&!("flags"in dI)&&!_Z(t,"flags")&&PZ(dI,t)?MZ(xZ,t):e},jE=dn,OZ=lh,AZ=Math.floor,bC=jE("".charAt),HZ=jE("".replace),SC=jE("".slice),NZ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,DZ=/\$([$&'`]|\d{1,2})/g,kZ=function(t,e,n,r,i,o){var s=n+t.length,a=r.length,l=DZ;return i!==void 0&&(i=OZ(i),l=NZ),HZ(o,l,function(u,c){var h;switch(bC(c,0)){case"$":return"$";case"&":return t;case"`":return SC(e,0,n);case"'":return SC(e,s);case"<":h=i[SC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=AZ(d/10);return f===0?u:f<=a?r[f-1]===void 0?bC(c,1):r[f-1]+bC(c,1):u}h=r[d-1]}return h===void 0?"":h})},$Z=Ct,LZ=yn,UE=dn,fI=Zf,FZ=Cn,VZ=Mi,BZ=RZ,Lh=Rv,WZ=tg,jZ=IZ,UZ=kZ,zZ=so,YZ=zZ("replace"),GZ=TypeError,RC=UE("".indexOf);UE("".replace);var gI=UE("".slice),KZ=Math.max;$Z({target:"String",proto:!0},{replaceAll:function(e,n){var r=fI(this),i,o,s,a,l,u,c,h,d,f,g=0,v="";if(VZ(e)){if(i=BZ(e),i&&(o=Lh(fI(jZ(e))),!~RC(o,"g")))throw new GZ("`.replaceAll` does not allow non-global regexes");if(s=WZ(e,YZ),s)return LZ(s,e,r,n)}for(a=Lh(r),l=Lh(e),u=FZ(n),u||(n=Lh(n)),c=l.length,h=KZ(1,c),d=RC(a,l);d!==-1;)f=u?Lh(n(l,d,a)):UZ(l,a,d,[],void 0,n),v+=gI(a,g,d)+f,g=d+c,d=d+h>a.length?-1:RC(a,l,d+h);return g<a.length&&(v+=gI(a,g)),v}});var qZ=Ct,XZ=hh,JZ=Dr,ZZ=bn,QZ=Zo,eQ=ei,tQ=Ka,nQ=ig,rQ=Nn,r$=TypeError,i$=rQ(function(){[].keys().reduce(function(){},void 0)}),EC=!i$&&tQ("reduce",r$);qZ({target:"Iterator",proto:!0,real:!0,forced:i$||EC},{reduce:function(e){ZZ(this);try{JZ(e)}catch(s){eQ(this,"throw",s)}var n=arguments.length<2,r=n?void 0:arguments[1];if(EC)return nQ(EC,this,n?[e]:[e,r]);var i=QZ(this),o=0;if(XZ(i,function(s){n?(n=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),n)throw new r$("Reduce of empty iterator with no initial value");return r}});const o$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},iQ=new RegExp(Object.keys(o$).map(t=>`(${t})`).join("|"),"gi");function oQ(t){return(t&&t.nodeName||"")==="TABLE"}function bR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][y],{hidden:x,rowspan:P,colspan:T}=t.getCellMeta(d-h,y-c);if(!x){const O=[];if(P&&O.push(`rowspan="${P}"`),T&&O.push(`colspan="${T}"`),Yt(M))C=`<td ${O.join(" ")}></td>`;else{const G=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${O.join(" ")}>${G}</td>`}}}g.push(C)}const v=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function SR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Yt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function s$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const P=x.match(/<td\b[^>]*?>/g)[0],T=/<p.*?>/g,O=x.substring(P.length,x.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(T,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!oQ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,x)=>M+x.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(x=>{const P=x.querySelector("td")!==null;return P&&h.push(x),!P});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((x,P)=>{const T=Array.from(P.cells).reduce((O,G,U)=>{if(a&&U===0)return O;const{colSpan:V,innerHTML:X}=G,ne=V>1?{label:X,colspan:V}:X;return O.push(ne),O},[]);return x.push(T),x},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((x,P,T)=>(a&&T===0||x.push(P.innerHTML),x),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((M,x)=>(M.push(...Array.from(x.rows)),M),[]),...c];g=v.length;const y=new Array(g);for(let M=0;M<g;M++)y[M]=new Array(u);const E=[],C=[];for(let M=0;M<g;M++){const x=v[M],P=Array.from(x.cells),T=P.length;for(let O=0;O<T;O++){const G=P[O],{nodeName:U,innerHTML:V,rowSpan:X,colSpan:ne}=G,Q=y[M].findIndex(te=>te===void 0);if(U==="TD"){if(X>1||ne>1){for(let Re=M;Re<M+X;Re++)if(Re<g)for(let Ae=Q;Ae<Q+ne;Ae++)y[Re][Ae]=null;const pe=G.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||E.push({col:Q,row:M,rowspan:X,colspan:ne})}let te="";s&&/excel/gi.test(s.content)?te=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[M][Q]=te.replace(iQ,pe=>o$[pe])}else C.push(V)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const sQ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:SR,htmlToGridSettings:s$,instanceToHTML:bR},Symbol.toStringTag,{value:"Module"}));function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function a$(t){return Gn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function RR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function zE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ye(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const aQ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ye,isNumeric:Gn,isNumericLike:a$,rangeEach:fe,rangeEachReverse:RR,valueAccordingPercent:zE},Symbol.toStringTag,{value:"Module"})),ER="asc",lQ="desc",mI=new Map([[ER,[-1,1]],[lQ,[1,-1]]]),uQ=t=>`The priority '${t}' is already declared in a map.`,cQ=t=>`The priority '${t}' is not a number.`;function hQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ut(t)?t:uQ,e=ut(e)?e:cQ;function r(o,s){if(!Gn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ER;const[s,a]=mI.get(o)||mI.get(ER);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const dQ=t=>`The id '${t}' is already declared in a map.`;function zv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ut(t)?t:dQ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const fQ=t=>`'${t}' value is already declared in a unique set.`;function gQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ut(t)?t:fQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const YE=t=>`There is already registered "${t}" plugin.`,mQ=t=>`There is already registered plugin on priority "${t}".`,pQ=t=>`The priority "${t}" is not a number.`,l$=hQ({errorPriorityExists:mQ,errorPriorityNaN:pQ}),u$=gQ({errorItemExists:YE}),TR=zv({errorIdExists:YE});function GE(){return[...l$.getItems(),...u$.getItems()]}function pg(t){const e=Zn(t);return TR.getItem(e)}function wQ(t){return!!pg(t)}function Ke(t,e,n){[t,e,n]=yQ(t,e,n),pg(t)===void 0&&vQ(t,e,n)}function vQ(t,e,n){const r=Zn(t);if(TR.hasItem(r))throw new Error(YE(r));n===void 0?u$.addItem(r):l$.addItem(n,r),TR.addItem(r,e)}function yQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:CQ,getItem:bQ,hasItem:c$,getNames:SQ,getValues:o0e}=lo("renderers");function Pw(t){if(typeof t=="function")return t;if(!c$(t))throw Error(`No registered renderer found under "${t}" name`);return bQ(t)}function Wr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),CQ(t,e)}const{register:RQ,getItem:EQ,hasItem:h$,getNames:TQ,getValues:s0e}=lo("validators");function KE(t){if(typeof t=="function")return t;if(!h$(t))throw Error(`No registered validator found under "${t}" name`);return EQ(t)}function Gl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),RQ(t,e)}var MQ=Ct,_Q=lh,PQ=ch,xQ=ng,IQ=Uv;MQ({target:"Array",proto:!0},{at:function(e){var n=_Q(this),r=PQ(n),i=xQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});IQ("at");var OQ=Ct,AQ=dn,HQ=Zf,NQ=ng,DQ=Rv,kQ=Nn,$Q=AQ("".charAt),LQ=kQ(function(){return"𠮷".at(-2)!=="\uD842"});OQ({target:"String",proto:!0,forced:LQ},{at:function(e){var n=DQ(HQ(this)),r=n.length,i=NQ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:$Q(n,o)}});function Fh(t,e,n){return(e=FQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FQ(t){var e=VQ(t,"string");return typeof e=="symbol"?e:e+""}function VQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BQ{constructor(){Fh(this,"count",0),Fh(this,"startColumn",null),Fh(this,"endColumn",null),Fh(this,"startPosition",null),Fh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Vh(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=jQ(t,"string");return typeof e=="symbol"?e:e+""}function jQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UQ{constructor(){Vh(this,"count",0),Vh(this,"startRow",null),Vh(this,"endRow",null),Vh(this,"startPosition",null),Vh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Bh(t,e,n){return(e=zQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zQ(t){var e=YQ(t,"string");return typeof e=="symbol"?e:e+""}function YQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d${constructor(){Bh(this,"count",0),Bh(this,"startColumn",null),Bh(this,"endColumn",null),Bh(this,"startPosition",null),Bh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wh(t,e,n){return(e=GQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f${constructor(){Wh(this,"count",0),Wh(this,"startRow",null),Wh(this,"endRow",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jh(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(){jh(this,"count",0),jh(this,"startColumn",0),jh(this,"endColumn",0),jh(this,"startPosition",0),jh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Uh(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eee{constructor(){Uh(this,"count",0),Uh(this,"startRow",0),Uh(this,"endRow",0),Uh(this,"startPosition",0),Uh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function pI(t,e,n){return(e=tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return typeof e=="symbol"?e:e+""}function nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ree extends d${constructor(){super(...arguments),pI(this,"columnStartOffset",0),pI(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function wI(t,e,n){return(e=iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class see extends f${constructor(){super(...arguments),wI(this,"rowStartOffset",0),wI(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function vI(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g${constructor(e){vI(this,"calculationTypes",[]),vI(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Hi(t,e,n){return(e=uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uee(t){var e=cee(t,"string");return typeof e=="symbol"?e:e+""}function cee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zc=50;class hee extends g${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Hi(this,"viewportWidth",0),Hi(this,"scrollOffset",0),Hi(this,"zeroBasedScrollOffset",0),Hi(this,"totalColumns",0),Hi(this,"columnWidthFn",null),Hi(this,"columnWidth",0),Hi(this,"overrideFn",null),Hi(this,"inlineStartOffset",0),Hi(this,"totalCalculatedWidth",0),Hi(this,"startPositions",[]),Hi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Zc:n}}function ii(t,e,n){return(e=dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dee(t){var e=fee(t,"string");return typeof e=="symbol"?e:e+""}function fee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gee extends g${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ii(this,"viewportHeight",0),ii(this,"scrollOffset",0),ii(this,"zeroBasedScrollOffset",0),ii(this,"totalRows",0),ii(this,"rowHeightFn",null),ii(this,"rowHeight",0),ii(this,"overrideFn",null),ii(this,"horizontalScrollbarHeight",0),ii(this,"innerViewportHeight",0),ii(this,"totalCalculatedHeight",0),ii(this,"startPositions",[]),ii(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function mee(t,e,n){pee(t,e),e.set(t,n)}function pee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yI(t,e,n){return(e=wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=vee(t,"string");return typeof e=="symbol"?e:e+""}function vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ku(t,e){return t.get(m$(t,e))}function CI(t,e,n){return t.set(m$(t,e),n),n}function m$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ss=new WeakMap;class hu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;yI(this,"row",null),yI(this,"col",null),mee(this,ss,!1),CI(ss,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ku(ss,this)}isSouthEastOf(e){return this.row>=e.row&&(ku(ss,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ku(ss,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ku(ss,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ku(ss,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof hu&&CI(ss,this,e.isRtl()),this}clone(){return new hu(this.row,this.col,ku(ss,this))}toObject(){return{row:this.row,col:this.col}}}function yee(t,e,n){Cee(t,e),e.set(t,n)}function Cee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TC(t,e,n){return(e=bee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bee(t){var e=See(t,"string");return typeof e=="symbol"?e:e+""}function See(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oi(t,e){return t.get(p$(t,e))}function Ree(t,e,n){return t.set(p$(t,e),n),n}function p$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pr=new WeakMap;class wg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;TC(this,"highlight",null),TC(this,"from",null),TC(this,"to",null),yee(this,pr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Ree(pr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return oi(pr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return oi(pr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return oi(pr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return oi(pr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return oi(pr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return oi(pr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return oi(pr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return oi(pr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof hu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(oi(pr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(oi(pr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new wg(this.highlight,this.from,this.to,oi(pr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new hu(e,n,oi(pr,this))}}function fo(t,e,n){Eee(t,e),e.set(t,n)}function Eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(w$(t,e))}function Qs(t,e,n){return t.set(w$(t,e),n),n}function w$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var si=new WeakMap,MC=new WeakMap,In=new WeakMap,$u=new WeakMap,Qg=new WeakMap,Ni=new WeakMap,_C=new WeakMap,zh=new WeakMap,rl=new WeakMap,go=new WeakMap;let v$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;fo(this,si,void 0),fo(this,MC,void 0),fo(this,In,void 0),fo(this,$u,void 0),fo(this,Qg,void 0),fo(this,Ni,void 0),fo(this,_C,void 0),fo(this,zh,void 0),fo(this,rl,[null,null]),fo(this,go,[null,null]),Qs(si,this,r),Qs(MC,this,n),Qs(In,this,o),Qs($u,this,s),Qs(Qg,this,a),Qs(Ni,this,i),Qs(_C,this,e),this.registerEvents()}registerEvents(){ge(Ni,this).addEventListener(ge(In,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Ni,this).addEventListener(ge(In,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Ni,this).addEventListener(ge(In,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Ni,this).addEventListener(ge(In,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Ni,this).addEventListener(ge(In,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Ni,this).addEventListener(ge(In,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(si,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(si,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Ni,this).addEventListener(ge(In,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Ni,this).addEventListener(ge(In,this).holder,"mousedown",r=>this.onMouseDown(r))};jo()?e():(kE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(zh,this)&&r){const[i,o]=[r.row,ge(zh,this).from.row],[s,a]=[r.col,ge(zh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(In,this).TABLE,i=kd(e,["TD","TH"],r);return i?(n.coords=ge(In,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=ge($u,this).getFocusSelection().cellRange.highlight,n.TD=ge(In,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&ge($u,this).getAreaSelection().cellRange&&(n.coords=ge($u,this).getAreaSelection().cellRange.to,n.TD=ge(In,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(MC,this).rootDocument.activeElement,r=DE(Ck,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?ge(si,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(si,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(go,this)[0]=o.TD,clearTimeout(ge(rl,this)[0]),ge(rl,this)[0]=setTimeout(()=>{ge(go,this)[0]=null},1e3))}onContextMenu(e){if(ge(si,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(si,this).has("onCellMouseOver"))return;const n=ge(In,this).TABLE,r=kd(e.target,["TD","TH"],n),i=ge(Qg,this)||this;r&&r!==i.lastMouseOver&&ka(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(In,this).getCoords(r),r))}onMouseOut(e){if(!ge(si,this).has("onCellMouseOut"))return;const n=ge(In,this).TABLE,r=kd(e.target,["TD","TH"],n),i=kd(e.relatedTarget,["TD","TH"],n),o=ge(Qg,this)||this;r&&r!==i&&ka(r,n)&&(this.callListener("onCellMouseOut",e,ge(In,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(si,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(go,this)[0]&&n.TD===ge(go,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(go,this)[0]=null,ge(go,this)[1]=null):n.TD===ge(go,this)[0]&&(ge(go,this)[1]=n.TD,clearTimeout(ge(rl,this)[1]),ge(rl,this)[1]=setTimeout(()=>{ge(go,this)[1]=null},500)))}onTouchStart(e){Qs(zh,this,ge($u,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(si,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];LE()&&(zk()||Yk())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(si,this).getSettingPure(e);o&&o(n,r,i,ge(_C,this).call(this))}destroy(){clearTimeout(ge(rl,this)[0]),clearTimeout(ge(rl,this)[1]),ge(Ni,this).destroy()}};function PC(t,e,n){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _ee{constructor(e,n,r){PC(this,"offset",void 0),PC(this,"total",void 0),PC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function xC(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iee{constructor(e,n,r){xC(this,"offset",void 0),xC(this,"total",void 0),xC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function em(t,e,n){return(e=Oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:e+""}function Aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hee{constructor(){em(this,"currentSize",0),em(this,"nextSize",0),em(this,"currentOffset",0),em(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Nee=0,bI=1,MR=2;function IC(t,e,n){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ee{constructor(){IC(this,"size",new Hee),IC(this,"workingSpace",Nee),IC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=bI,e.workingSpace=MR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=MR,e.workingSpace=bI,this.sharedSize=e.getViewSize()}}var SI=Sv,Lee=TypeError,Fee=function(t,e){if(!delete t[e])throw new Lee("Cannot delete property "+SI(e)+" of "+SI(t))},Vee=Ct,Bee=lh,Wee=ch,jee=MN,Uee=Fee,zee=_N,Yee=[].unshift(0)!==1,Gee=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Kee=Yee||!Gee();Vee({target:"Array",proto:!0,arity:1,forced:Kee},{unshift:function(e){var n=Bee(this),r=Wee(n),i=arguments.length;if(i){zee(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Uee(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return jee(n,r+i)}});function qee(t,e,n){return(e=Xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Jee(t,"string");return typeof e=="symbol"?e:e+""}function Jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RI{constructor(e,n){qee(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Zee(t,e,n){return(e=Qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tte{constructor(e){Zee(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new RI(o,n),l=new RI(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(MR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Lu(t,e,n){return(e=nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nte(t){var e=rte(t,"string");return typeof e=="symbol"?e:e+""}function rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y${constructor(e,n){Lu(this,"rootNode",void 0),Lu(this,"nodesPool",void 0),Lu(this,"sizeSet",new $ee),Lu(this,"collectedNodes",[]),Lu(this,"viewDiffer",new tte(this.sizeSet)),Lu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class C$ extends y${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function EI(t,e,n){return(e=ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=ote(t,"string");return typeof e=="symbol"?e:e+""}function ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ste{constructor(e){EI(this,"nodeType",void 0),EI(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Yh(t,e,n){return(e=ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ate(t){var e=lte(t,"string");return typeof e=="symbol"?e:e+""}function lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vg{constructor(e,n){Yh(this,"nodesPool",null),Yh(this,"nodeType",void 0),Yh(this,"rootNode",void 0),Yh(this,"table",null),Yh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new ste(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TI(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hte extends vg{constructor(){super("TH"),TI(this,"orderViews",new WeakMap),TI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new C$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Pu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[C8(),x8(),RE(h+1),Mu(-1)]),n[h](a,d,h)}u.end()}}}class dte extends vg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&qo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[gk()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(s,[gR(),vk(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Pu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[RE(a+1+this.table.rowHeadersCount),Mu(-1),b8(),...a>=0?[P8()]:[gR()]]),r[n](l,u,n)}}}}let MI=!1;class fte extends vg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!MI&&e>1e3&&(MI=!0,nt(ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function gte(t,e,n){return(e=mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mte(t){var e=pte(t,"string");return typeof e=="symbol"?e:e+""}function pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let _I=!1;class wte extends vg{constructor(e){super("TR",e),gte(this,"orderView",void 0),this.orderView=new y$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!_I&&e>1e3&&(_I=!0,nt(ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[gk()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(o,[gR(),vk(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,Fu.rowEven)||(we(o,Fu.rowOdd),q(o,Fu.rowEven)):ve(o,Fu.rowOdd)||(we(o,Fu.rowEven),q(o,Fu.rowOdd))}this.orderView.end()}}function PI(t,e,n){return(e=vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cte extends vg{constructor(){super("TD"),PI(this,"orderViews",new WeakMap),PI(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new C$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Pu(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;be(g,[...g.hasAttribute("role")?[]:[y8()],Mu(-1),RE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function mn(t,e,n){return(e=bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:e+""}function Ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rte{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(this,"rootNode",void 0),mn(this,"rootDocument",void 0),mn(this,"rowHeaders",null),mn(this,"columnHeaders",null),mn(this,"colGroup",null),mn(this,"rows",null),mn(this,"cells",null),mn(this,"rowFilter",null),mn(this,"columnFilter",null),mn(this,"rowUtils",null),mn(this,"columnUtils",null),mn(this,"rowsToRender",0),mn(this,"columnsToRender",0),mn(this,"rowHeaderFunctions",[]),mn(this,"rowHeadersCount",0),mn(this,"columnHeaderFunctions",[]),mn(this,"columnHeadersCount",0),mn(this,"cellRenderer",void 0),mn(this,"activeOverlayName",void 0),mn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Ete{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Rte(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new hte,columnHeaders:new dte(n),colGroup:new fte(r),rows:new wte(i),cells:new Cte}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function OC(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _te{constructor(e,n){OC(this,"dataAccessObject",void 0),OC(this,"wtSettings",void 0),OC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function xI(t,e,n){return(e=Pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pte(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ite{constructor(e,n){xI(this,"dataAccessObject",void 0),xI(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function mo(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=Ate(t,"string");return typeof e=="symbol"?e:e+""}function Ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wh{constructor(e,n,r,i,o){mo(this,"wtSettings",null),mo(this,"domBindings",void 0),mo(this,"TBODY",null),mo(this,"THEAD",null),mo(this,"COLGROUP",null),mo(this,"hasTableHeight",!0),mo(this,"hasTableWidth",!0),mo(this,"isTableVisible",!1),mo(this,"tableOffset",0),mo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,TE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Ite(this.dataAccessObject,this.wtSettings),this.columnUtils=new _te(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Ete({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",be(r,[Mu(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[Hs()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[Hs()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Ln(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Ln(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Iee(f,o,c),this.columnFilter=new _ee(g,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Fo)||this.is(La))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Fo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Vc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Fo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Wa(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=Rk(r),s=n.cellIndex;ga(gu,n,this.wtRootElement)||ga(du,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ga(La,n,this.wtRootElement)||ga(Fo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),ga(gu,n,this.wtRootElement)||ga(fu,n,this.wtRootElement)||ga(La,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Vc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?un:Vc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Qt(this.TABLE)}getHeight(){return un(this.TABLE)}getTotalWidth(){const e=Qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=un(this.hider);return e!==0?e:this.getHeight()}isVisible(){return cu(this.TABLE)}_modifyRowHeaderWidth(e){let n=ut(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Hte="stickyRowsBottom",qE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ts(qE,"MIXIN_NAME",Hte,{writable:!1,enumerable:!1});const Nte="stickyColumnsStart",Yv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ts(Yv,"MIXIN_NAME",Nte,{writable:!1,enumerable:!1});class XE extends wh{constructor(e,n,r,i){super(e,n,r,i,La)}}mt(XE,qE);mt(XE,Yv);const du="top",Fo="bottom",fu="inline_start",gu="top_inline_start_corner",La="bottom_inline_start_corner",b$=[du,Fo,fu,gu,La],Dte=new Map([[du,`ht_clone_${du}`],[Fo,`ht_clone_${Fo}`],[fu,`ht_clone_${fu} ht_clone_left`],[gu,`ht_clone_${gu} ht_clone_top_left_corner`],[La,`ht_clone_${La} ht_clone_bottom_left_corner`]]);function kte(t,e){$te(t,e),e.add(t)}function $te(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lte(t,e,n){return(e=Fte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=Vte(t,"string");return typeof e=="symbol"?e:e+""}function Vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gh=new WeakSet;class Bte{constructor(e){kte(this,Gh),Lte(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return tm(Gh,this,OI).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return tm(Gh,this,OI).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return tm(Gh,this,II).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return tm(Gh,this,II).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function II(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ln(r.wtRootElement).left;const u=Math.abs(_E(s,s));if(l>u){const c=PE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function OI(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ln(n.wtRootElement),a=Lv(o,o);if(s.top>a){const l=Vc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ai(t,e,n){return(e=Wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wte(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JE{get eventManager(){return new Ei(this)}constructor(e,n){ai(this,"wtTable",void 0),ai(this,"wtScroll",void 0),ai(this,"wtViewport",void 0),ai(this,"wtOverlays",void 0),ai(this,"selectionManager",void 0),ai(this,"wtEvent",void 0),ai(this,"guid",`wt_${CE()}`),ai(this,"drawInterrupted",!1),ai(this,"drawn",!1),ai(this,"activeOverlayName","master"),ai(this,"domBindings",void 0),ai(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Bte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ja(r,e[n])}])}}createCellCoords(e,n){return new hu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new wg(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||_k(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function AI(t,e,n){return(e=Ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ute(t){var e=zte(t,"string");return typeof e=="symbol"?e:e+""}function zte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yte extends JE{constructor(e,n,r){super(e,n),AI(this,"cloneSource",void 0),AI(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new v$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Gte(t,e,n){return(e=Kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kte(t){var e=qte(t,"string");return typeof e=="symbol"?e:e+""}function qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yg{constructor(e,n,r,i,o){Gte(this,"wtSettings",null),ts(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Xc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Xc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Pf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){nt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+_n())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(b$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Dte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&be(o,[Hs()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===du||u==="vertical"&&this.type===fu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Pf(e.TABLE),new Yte(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Xte extends yg{constructor(e,n,r,i,o,s){super(e,n,La,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new XE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else dg(n),this.repositionOverlay();let r=un(this.clone.wtTable.TABLE);const i=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}}const Jte="calculatedColumns",Gv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ts(Gv,"MIXIN_NAME",Jte,{writable:!1,enumerable:!1});class ZE extends wh{constructor(e,n,r,i){super(e,n,r,i,Fo)}}mt(ZE,qE);mt(ZE,Gv);function Zte(t,e,n){return(e=Qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qte(t){var e=ene(t,"string");return typeof e=="symbol"?e:e+""}function ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tne extends yg{constructor(e,n,r,i){super(e,n,Fo,r,i),Zte(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_n(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo($v(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=_n(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Lv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(we(s,"innerBorderBottom"),o=a)}return o}}const nne="calculatedRows",QE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ts(QE,"MIXIN_NAME",nne,{writable:!1,enumerable:!1});class eT extends wh{constructor(e,n,r,i){super(e,n,r,i,fu)}}mt(eT,QE);mt(eT,Yv);const rne="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Ew(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ts(Fn,"MIXIN_NAME",rne,{writable:!1,enumerable:!1});let S$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(S$,Fn);const R$="active-header",tT="header",nT="area",Xd="focus",ine="fill",one="row",sne="column",ane="custom-selection",rT=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var lne=Uv;lne("flat");function une(t,e){E$(t,e),e.add(t)}function HI(t,e,n){E$(t,e),e.set(t,n)}function E$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e){return t.get(Jd(t,e))}function NI(t,e,n){return t.set(Jd(t,e),n),n}function Jd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vi=new WeakMap,Un=new WeakMap,nm=new WeakSet;class cne{constructor(){une(this,nm),HI(this,Vi,void 0),HI(this,Un,void 0)}setActiveOverlay(e){return NI(Un,this,e),this}setActiveSelection(e){return NI(Vi,this,e),this}scan(){const e=Wt(Vi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Wt(Vi,this).getCorners(),{wtTable:s}=Wt(Un,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const v=Wt(Un,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Wt(Vi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(g=s.getColumnHeader(v,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Wt(Vi,this).getCorners(),{wtTable:s}=Wt(Un,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const v=Wt(Un,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Wt(Vi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(g=s.getRowHeader(v,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Wt(Un,this);Jd(nm,this,hne).call(this,(r,i)=>{const o=n.getCell(Wt(Un,this).createCellCoords(r,i)),s=Wt(Un,this).getSetting("onAfterDrawSelection",r,i,Wt(Vi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Wt(Vi,this).getCorners(),{wtTable:i}=Wt(Un,this);Jd(nm,this,DI).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Wt(Un,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Wt(Vi,this).getCorners(),{wtTable:i}=Wt(Un,this);Jd(nm,this,DI).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Wt(Un,this).createCellCoords(o,s));e(a)}})}}function hne(t){let[e,n,r,i]=Wt(Vi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Wt(Un,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Wt(Un,this).createCellCoords(e,n));if(!zo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function DI(t){const{wtTable:e}=Wt(Un,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class kI{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=rT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ii(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),jo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};ke(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};ke(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),M=Math.min(parseInt(i+o-v/4,10),y-v-f*2);h[l]=`${C}px`,d[l]=`${M}px`;const x=Math.min(parseInt(r+s,10),E-g-f*2),P=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${x}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!zo(g)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Ln(g),E=u?Ln(v):y,C=Ln(s.TABLE),M=y.top,x=y.left,P=this.wot.wtSettings.getSetting("rtlMode");let T=0,O=0;if(P){const Re=Qt(s.TABLE),Ae=Qt(g),st=l.innerWidth-C.left-Re;O=x+Ae-E.left,T=l.innerWidth-x-Ae-st-1}else O=E.left+Qt(v)-x,T=x-C.left-1;if(this.isEntireColumnSelected(n,i)){const Re=n,Ae=this.getDimensionsFromHeader("columns",r,o,Re,C);let st=null;Ae&&([st,T,O]=Ae),st&&(g=st)}let G=M-C.top-1,U=E.top+un(v)-M;if(this.isEntireRowSelected(r,o)){const Re=r,Ae=this.getDimensionsFromHeader("rows",n,i,Re,C);let st=null;Ae&&([st,G,U]=Ae),st&&(g=st)}const V=l.getComputedStyle(g);parseInt(V.borderTopWidth,10)>0&&(G+=1,U=U>0?U-1:0),parseInt(V[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,O=O>0?O-1:0);const X=P?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[X]=`${T}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[X]=`${T}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+U-ne}px`,this.bottomStyle[X]=`${T}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[X]=`${T+O-ne}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[pe,et]=[i,o];if(te&&Array.isArray(te)&&([,,pe,et]=te),jo()||!Q||this.isPartRange(pe,et))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${T+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=Xc(s.TABLE);const Ae=Re===l;Ae&&(Re=a.documentElement);const st=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Pn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),at=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ae?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,p=0;P?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=m+Qt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=PE(Re)),w&&(this.cornerStyle[X]=`${Math.floor(T+O+this.cornerCenterPointOffset-Pn-st)}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(Ae?v.getBoundingClientRect().top:v.offsetTop)+un(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Vc(Re),A=this.wot.stylesHandler.isClassicTheme();if(p){const L=Math.floor(G+U+this.cornerCenterPointOffset-at-st);A?(this.cornerStyle.top=`${L}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${L-1}px`}}this.cornerStyle.display="block"}jo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,T,O,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return un(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),v=l(r,y-i),!g||!v)return!1;const E=Ln(g),C=Ln(v);return g&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(ve(this[e],"hidden")&&we(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):we(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",jo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function dne(t,e){T$(t,e),e.add(t)}function Vu(t,e,n){T$(t,e),e.set(t,n)}function T$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(iT(t,e))}function $I(t,e,n){return t.set(iT(t,e),n),n}function iT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,_r=new WeakMap,AC=new WeakMap,$d=new WeakMap,HC=new WeakMap,il=new WeakMap,LI=new WeakSet;class fne{constructor(e){dne(this,LI),Vu(this,zn,void 0),Vu(this,_r,void 0),Vu(this,AC,new cne),Vu(this,$d,new WeakMap),Vu(this,HC,new WeakSet),Vu(this,il,new Map),$I(_r,this,e)}setActiveOverlay(e){return $I(zn,this,e),$e(AC,this).setActiveOverlay($e(zn,this)),$e($d,this).has($e(zn,this))||$e($d,this).set($e(zn,this),new Set),this}getFocusSelection(){return $e(_r,this)!==null?$e(_r,this).getFocus():null}getAreaSelection(){return $e(_r,this)!==null?$e(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(il,this).has(e)){const r=$e(il,this).get(e);if(r.has($e(zn,this)))return r.get($e(zn,this));const i=new kI($e(zn,this),e.settings);return r.set($e(zn,this),i),i}const n=new kI($e(zn,this),e.settings);return $e(il,this).set(e,new Map([[$e(zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=$e(il,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){$e(il,this).get(e).forEach(n=>n.destroy()),$e(il,this).delete(e)}render(e){if($e(_r,this)===null)return;e&&iT(LI,this,gne).call(this);const n=Array.from($e(_r,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;$e(HC,this).has(s)||($e(HC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&$e(AC,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const v=r.get(g);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();$e(zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>$e($d,this).get($e(zn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=$e(_r,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,$e(_r,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function gne(){const t=$e($d,this).get($e(zn,this)),e=$e(zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=$e(zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=$e(_r,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=$e(_r,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=$e(_r,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...$e(_r,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)we(o[a],n),Pu(o[a],s)}),t.clear()}class mne extends yg{constructor(e,n,r,i){super(e,n,fu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new eT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Fv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),dg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,ME(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=rT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=_n(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,xk(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(_E(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?we(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(we(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const pne="stickyRowsTop",oT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ts(oT,"MIXIN_NAME",pne,{writable:!1,enumerable:!1});class sT extends wh{constructor(e,n,r,i){super(e,n,r,i,gu)}}mt(sT,oT);mt(sT,Yv);function FI(t,e,n){return(e=wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wne(t){var e=vne(t,"string");return typeof e=="symbol"?e:e+""}function vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yne extends yg{constructor(e,n,r,i,o,s){super(e,n,gu,r,i),FI(this,"topOverlay",void 0),FI(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new sT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Fv(e,`${i}px`,`${o}px`)}else dg(e);let n=un(this.clone.wtTable.TABLE);const r=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class aT extends wh{constructor(e,n,r,i){super(e,n,r,i,du)}}mt(aT,oT);mt(aT,Gv);function Cne(t,e,n){return(e=bne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bne(t){var e=Sne(t,"string");return typeof e=="symbol"?e:e+""}function Sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rne extends yg{constructor(e,n,r,i){super(e,n,du,r,i),Cne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Fv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),dg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo($v(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=_n(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=un(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=rT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=_n(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Pk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Lv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?we(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(we(i,"innerBorderTop"),a=h)}}return a}}function rm(t,e,n){Ene(t,e),e.set(t,n)}function Ene(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(t,e,n){return(e=Tne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tne(t){var e=Mne(t,"string");return typeof e=="symbol"?e:e+""}function Mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ol(t,e,n){return t.set(M$(t,e),n),n}function ls(t,e){return t.get(M$(t,e))}function M$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bu=new WeakMap,im=new WeakMap,Wu=new WeakMap,om=new WeakMap;class _ne{constructor(e,n,r,i,o,s){as(this,"wot",null),rm(this,Bu,[]),as(this,"topOverlay",null),as(this,"bottomOverlay",null),as(this,"inlineStartOverlay",null),as(this,"topInlineStartCornerOverlay",null),as(this,"bottomInlineStartCornerOverlay",null),as(this,"browserLineHeight",void 0),as(this,"wtSettings",null),rm(this,im,!1),rm(this,Wu,0),rm(this,om,null),as(this,"resizeObserver",new ResizeObserver(c=>{If(()=>{!Array.isArray(c)||!c.length||(ol(Wu,this,ls(Wu,this)+1),ls(Wu,this)===100&&(nt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ls(om,this)!==null&&clearTimeout(ls(om,this)),ol(om,this,setTimeout(()=>{ol(Wu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=_n(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Pf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ls(Bu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Rne(...e),this.bottomOverlay=new tne(...e),this.inlineStartOverlay=new mne(...e),this.topInlineStartCornerOverlay=new yne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Xte(...e,this.bottomOverlay,this.inlineStartOverlay),ol(Bu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ol(im,this,ls(Bu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ls(Bu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ls(Bu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!$E())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{If(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ol(Wu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ph(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!ls(im,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ol(im,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Pf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function VI(t,e,n){return(e=Pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pne(t){var e=xne(t,"string");return typeof e=="symbol"?e:e+""}function xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ine{constructor(e){VI(this,"settings",{}),VI(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ja(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class lT extends wh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Xc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=xf(e,"height",n),o=xf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=cu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}mt(lT,QE);mt(lT,Gv);class One{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new eee:new see],["fullyVisible",()=>new UQ],["partiallyVisible",()=>new f$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new JQ:new ree],["fullyVisible",()=>new BQ],["partiallyVisible",()=>new d$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=un(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Ln(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=un(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=_n(this.domBindings.rootDocument),new gee({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=_n(this.domBindings.rootDocument)),new hee({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function Ane(t,e){_$(t,e),e.add(t)}function sl(t,e,n){_$(t,e),e.set(t,n)}function _$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(qi(t,e))}function Ki(t,e,n){return t.set(qi(t,e),n),n}function qi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BI=23;var Po=new WeakMap,xs=new WeakMap,uT=new WeakMap,_R=new WeakMap,ma=new WeakMap,Ld=new WeakMap,Hf=new WeakMap,Oo=new WeakSet;class Hne{constructor(e){Ane(this,Oo),sl(this,Po,void 0),sl(this,xs,void 0),sl(this,uT,void 0),sl(this,_R,void 0),sl(this,ma,!0),sl(this,Ld,{}),sl(this,Hf,{}),Ki(xs,this,e.rootTable.parentElement.parentElement),Ki(_R,this,e.rootDocument)}isClassicTheme(){return At(ma,this)}getCSSVariableValue(e){var n;if(At(ma,this))return null;if(At(Ld,this)[`--ht-${e}`])return At(Ld,this)[`--ht-${e}`];const r=(n=qi(Oo,this,$ne).call(this,`--ht-${e}`))!==null&&n!==void 0?n:qi(Oo,this,P$).call(this,`--ht-${e}`);if(r!==null)return At(Ld,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=At(Hf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(At(ma,this))return BI;const e=qi(Oo,this,Nne).call(this);return!e&&ve(At(xs,this),"ht-wrapper")?(nt(`The "${At(Po,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Ki(ma,this,!0),this.useTheme(),BI):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){qi(Oo,this,WI).call(this),Ki(ma,this,!0),Ki(Po,this,e||void 0);return}e&&e!==At(Po,this)&&(At(Po,this)&&qi(Oo,this,Lne).call(this),Ki(Po,this,e),Ki(ma,this,!1),qi(Oo,this,Dne).call(this),qi(Oo,this,WI).call(this))}getThemeName(){return At(Po,this)}removeClassNames(){ve(At(xs,this),At(Po,this))&&we(At(xs,this),At(Po,this))}}function Nne(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Dne(){we(At(xs,this),/ht-theme-.*/g),q(At(xs,this),At(Po,this))}function WI(){this.isClassicTheme()||Ki(uT,this,getComputedStyle(At(xs,this)));const t=qi(Oo,this,kne).call(this,["box-sizing","border-bottom-width"]);At(Hf,this).td={...At(Hf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function kne(t){const e=At(_R,this),n=At(xs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function $ne(t){const e=Math.ceil(parseFloat(qi(Oo,this,P$).call(this,t)));return Number.isNaN(e)?null:e}function P$(t){const e=At(uT,this).getPropertyValue(t);return e===""?null:e}function Lne(){Ki(Hf,this,{}),Ki(Ld,this,{}),Ki(ma,this,!0)}class Fne extends JE{constructor(e,n){super(e,new Ine(n)),this.stylesHandler=new Hne(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new lT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new One(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new fne(this.wtSettings.getSetting("selections")),this.wtEvent=new v$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new _ne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),we(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!b$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class cT{constructor(e){e instanceof JE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new cT(n);return()=>r},this._wot=new Fne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function jI(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Vne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const Bne=new Map([["mousedown",jI],["mouseover",Vne],["touchstart",jI]]);function UI(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Bne.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:jv(t)||t.type==="touchstart",isRightClick:Ua(t)})}const x$=new WeakMap,hT=Symbol("rootInstance");function Wne(t){x$.set(t,!0)}function jne(t){return t===hT}function $p(t){return x$.has(t)}function Une(t,e){I$(t,e),e.add(t)}function ea(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(t,e,n){return(e=zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:e+""}function Yne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nn(t,e){return t.get(Wc(t,e))}function wr(t,e,n){return t.set(Wc(t,e),n),n}function Wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var NC=new WeakMap,sm=new WeakMap,am=new WeakMap,us=new WeakMap,Di=new WeakMap,DC=new WeakMap,kC=new WeakMap,ju=new WeakMap,Fd=new WeakSet;class Gne{constructor(e){Une(this,Fd),ta(this,"hot",void 0),ta(this,"eventManager",void 0),ta(this,"settings",void 0),ta(this,"THEAD",void 0),ta(this,"TBODY",void 0),ta(this,"_wt",void 0),ta(this,"activeWt",void 0),ea(this,NC,0),ea(this,sm,0),ta(this,"postponedAdjustElementsSize",!1),ea(this,am,!1),ea(this,us,void 0),ea(this,Di,void 0),ea(this,DC,0),ea(this,kC,0),ea(this,ju,null),this.hot=e,this.eventManager=new Ei(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Wc(Fd,this,qne).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),wr(Di,this,n.createElement("TABLE")),q(nn(Di,this),"htCore"),this.hot.getSettings().tableClassName&&q(nn(Di,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(nn(Di,this),[Hs()]),be(e,[v8(),wk(-1),kv(this.hot.countCols()),A8()])),this.THEAD=n.createElement("THEAD"),nn(Di,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),nn(Di,this).appendChild(this.TBODY),this.hot.table=nn(Di,this),this.hot.container.insertBefore(nn(Di,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{wr(am,this,!0),this.isTextSelectionAllowed(a.target)||(mR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{wr(am,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{nn(am,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&mR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&jv(a)&&r.finish(),wr(us,this,!1);const l=Vv(n.activeElement);qd(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ua(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Ua(a)&&(r.finish(),wr(us,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),wr(us,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(nn(us,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=_n(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=uu(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=uu(s);this.eventManager.addEventListener(nn(Di,this),"selectstart",a=>{this.settings.fragmentSelection||qd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&we(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:nn(Di,this),isDataViewInstance:()=>$p(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),wr(sm,this,o.length),this.hot.getSettings().ariaTags&&Wc(Fd,this,O$).call(this)===this.hot.countCols()&&Wc(Fd,this,Kne).call(this,nn(sm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),wr(NC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,v,f),this.hot.runHooks("afterRenderer",a,l,u,g,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&cu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,wr(us,this,!0),wr(ju,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Sa(o)&&(UI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,wr(us,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Sa(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Sa(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Sa(o)&&(nn(us,this)&&(!nn(ju,this)||nn(ju,this).x!==o.clientX||nn(ju,this).y!==o.clientY)&&UI(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,wr(ju,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Sa(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,v,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new cT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(qd(e))return!0;const n=ka(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return nn(us,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){qo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(qo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...Hs()),be(l,...Hs())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?xu(e,r(n,i)):(ja(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){wr(DC,this,e),wr(kC,this,n)}getLastSize(){return{width:nn(DC,this),height:nn(kC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return nn(NC,this)}getRowHeadersCount(){return nn(sm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function O$(){return parseInt(this.hot.rootElement.getAttribute(kv()[0]),10)}function Kne(t){const e=Wc(Fd,this,O$).call(this)+t;be(this.hot.rootElement,...kv(e))}function qne(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):we(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):we(t,"htHasScrollX")}var Xne=Ct,Jne=yn,Zne=hh,Qne=Dr,ere=bn,tre=Zo,nre=ei,rre=Ka,$C=rre("every",TypeError);Xne({target:"Iterator",proto:!0,real:!0,forced:$C},{every:function(e){ere(this);try{Qne(e)}catch(i){nre(this,"throw",i)}if($C)return Jne($C,this,e);var n=tre(this),r=0;return!Zne(n,function(i,o){if(!e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const A$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",PR=A$.length;function Kv(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%PR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/PR,10);return n}function ire(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=PR**r*(A$.indexOf(t[n])+1);return e-=1,e}function ore(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Kv(i)+(r+1));n.push(o)}return n}function sre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Kv(i)+(r+1);n.push(o)}return n}function are(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function dT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function fT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&De(t[0])&&(e=Wv(t[0]))),e}function H$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function N$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const lre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:fT,createEmptySpreadsheetData:are,createSpreadsheetData:ore,createSpreadsheetObjectData:sre,dataRowToChangesArray:dT,isArrayOfArrays:H$,isArrayOfObjects:N$,spreadsheetColumnIndex:ire,spreadsheetColumnLabel:Kv},Symbol.toStringTag,{value:"Module"}));function Kh(t,e,n){return(e=ure(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ure(t){var e=cre(t,"string");return typeof e=="symbol"?e:e+""}function cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Kh(this,"hot",void 0),Kh(this,"data",void 0),Kh(this,"dataType","array"),Kh(this,"colToProp",()=>{}),Kh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return _(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||ut(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Np(l,d,f):l[d]=f}})}else ke(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Np(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Np(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Vk(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Hr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return fT(this.data)}destroy(){this.data=null,this.hot=null}}var dre=Ct,fre=yn,gre=hh,mre=Dr,pre=bn,wre=Zo,vre=ei,yre=Ka,LC=yre("some",TypeError);dre({target:"Iterator",proto:!0,real:!0,forced:LC},{some:function(e){pre(this);try{mre(e)}catch(i){vre(this,"throw",i)}if(LC)return fre(LC,this,e);var n=wre(this),r=0;return gre(n,function(i,o){if(e(i,r++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function zI(t,e,n){return(e=Cre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cre(t){var e=bre(t,"string");return typeof e=="symbol"?e:e+""}function bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;zI(this,"indexedValues",[]),zI(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ut(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(Iu,Fn);function gT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ut(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function mT(t,e){return Ba(t,(n,r)=>e.includes(r)===!1)}class qa extends Iu{insert(e,n){this.indexedValues=gT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=mT(this.indexedValues,e),super.remove(e)}}class qv extends qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function pT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Nf(t,e){return Ba(t,n=>e.includes(n)===!1)}function wT(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function vT(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function Sre(t,e,n){return(e=Rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rre(t){var e=Ere(t,"string");return typeof e=="symbol"?e:e+""}function Ere(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xv extends Iu{constructor(){super(...arguments),Sre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Nf(this.orderOfIndexes,[e]),ut(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=gT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=vT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=mT(this.indexedValues,e),this.orderOfIndexes=Nf(this.orderOfIndexes,e),this.orderOfIndexes=wT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Cg extends qa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const YI=new Map([["indexesSequence",{getListWithInsertedItems:pT,getListWithRemovedItems:Nf}],["physicallyIndexed",{getListWithInsertedItems:gT,getListWithRemovedItems:mT}]]),D$=t=>{if(YI.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return YI.get(t)};class k$ extends Iu{constructor(){super(e=>e)}insert(e,n){const r=vT(this.indexedValues,n);this.indexedValues=pT(r,e,n),super.insert(e,n)}remove(e){const n=Nf(this.indexedValues,e);this.indexedValues=wT(n,e),super.remove(e)}}const GI=new Map([["hiding",qv],["index",Iu],["linkedPhysicalIndexToValue",Xv],["physicalIndexToValue",qa],["trimming",Cg]]);function Tre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!GI.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(GI.get(t))(e)}function Mre(t,e,n){return(e=_re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Pre(t,"string");return typeof e=="symbol"?e:e+""}function Pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let xR=0;class yT{constructor(){Mre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),xR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),xR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ht(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(yT,Fn);function xre(){return xR}function FC(t,e,n){return(e=Ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ire(t){var e=Ore(t,"string");return typeof e=="symbol"?e:e+""}function Ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KI extends yT{constructor(e,n){super(),FC(this,"mergedValuesCache",[]),FC(this,"aggregationFunction",void 0),FC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Are(t,e,n){Hre(t,e),e.set(t,n)}function Hre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nre(t,e,n){return t.set($$(t,e),n),n}function Dre(t,e){return t.get($$(t,e))}function $$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var VC=new WeakMap;class L${constructor(){Are(this,VC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Dre(VC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Nre(VC,this,e)}}mt(L$,Fn);function qI(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function qh(t,e,n){kre(t,e),e.set(t,n)}function kre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function li(t,e){return t.get(F$(t,e))}function lm(t,e,n){return t.set(F$(t,e),n),n}function F$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var um=new WeakMap,Xh=new WeakMap,cm=new WeakMap,hm=new WeakMap,dm=new WeakMap;class $re{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qh(this,um,new Set),qh(this,Xh,[]),qh(this,cm,[]),qh(this,hm,!1),qh(this,dm,!1),lm(dm,this,e??!1)}createObserver(){const e=new L$;return li(um,this).add(e),e.addLocalHook("unsubscribe",()=>{li(um,this).delete(e)}),e._writeInitialChanges(qI(li(Xh,this),li(cm,this))),e}emit(e){let n=li(cm,this);(!li(hm,this)||li(Xh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(li(dm,this)):lm(Xh,this,new Array(e.length).fill(li(dm,this))),li(hm,this)||(lm(hm,this,!0),n=li(Xh,this)));const r=qI(n,e);li(um,this).forEach(i=>i._write(r)),lm(cm,this,e)}}function nr(t,e,n){return(e=Lre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lre(t){var e=Fre(t,"string");return typeof e=="symbol"?e:e+""}function Fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IR{constructor(){nr(this,"indexesSequence",new k$),nr(this,"trimmingMapsCollection",new KI(e=>e.some(n=>n===!0),!1)),nr(this,"hidingMapsCollection",new KI(e=>e.some(n=>n===!0),!1)),nr(this,"variousMapsCollection",new yT),nr(this,"hidingChangesObservable",new $re({initialIndexValue:!1})),nr(this,"notTrimmedIndexesCache",[]),nr(this,"notHiddenIndexesCache",[]),nr(this,"isBatched",!1),nr(this,"indexesSequenceChanged",!1),nr(this,"indexesChangeSource",void 0),nr(this,"trimmedIndexesChanged",!1),nr(this,"hiddenIndexesChanged",!1),nr(this,"renderablePhysicalIndexesCache",[]),nr(this,"fromPhysicalToVisualIndexesCache",new Map),nr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Tre(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Cg?this.trimmingMapsCollection.register(e,n):n instanceof qv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Nf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(pT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}mt(IR,Fn);function Vre(t,e){return ke(e,(n,r)=>{Ht(t[r])&&(t[r]=n)}),t}function V$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function B$(t){le(t)&&BE(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Bre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Wre,getValues:jre}=lo("phraseFormatters");function Ure(t,e){Wre(t,e)}function zre(){return jre()}Ure("pluralize",Bre);const W$="ContextMenu:items",Ie=W$,CT=`${Ie}.noItems`,bT=`${Ie}.insertRowAbove`,ST=`${Ie}.insertRowBelow`,RT=`${Ie}.insertColumnOnTheLeft`,ET=`${Ie}.insertColumnOnTheRight`,TT=`${Ie}.removeRow`,MT=`${Ie}.removeColumn`,_T=`${Ie}.undo`,PT=`${Ie}.redo`,xw=`${Ie}.readOnly`,xT=`${Ie}.clearColumn`,IT=`${Ie}.copy`,OT=`${Ie}.copyWithHeaders`,AT=`${Ie}.copyWithGroupHeaders`,HT=`${Ie}.copyHeadersOnly`,NT=`${Ie}.cut`,DT=`${Ie}.freezeColumn`,kT=`${Ie}.unfreezeColumn`,$T=`${Ie}.mergeCells`,LT=`${Ie}.unmergeCells`,FT=`${Ie}.addComment`,VT=`${Ie}.editComment`,BT=`${Ie}.removeComment`,WT=`${Ie}.readOnlyComment`,jT=`${Ie}.align`,UT=`${Ie}.align.left`,zT=`${Ie}.align.center`,YT=`${Ie}.align.right`,GT=`${Ie}.align.justify`,KT=`${Ie}.align.top`,qT=`${Ie}.align.middle`,XT=`${Ie}.align.bottom`,JT=`${Ie}.borders`,ZT=`${Ie}.borders.top`,QT=`${Ie}.borders.right`,eM=`${Ie}.borders.bottom`,tM=`${Ie}.borders.left`,nM=`${Ie}.borders.remove`,rM=`${Ie}.nestedHeaders.insertChildRow`,iM=`${Ie}.nestedHeaders.detachFromParent`,oM=`${Ie}.hideColumn`,sM=`${Ie}.showColumn`,aM=`${Ie}.hideRow`,lM=`${Ie}.showRow`,gr="Filters:",Gt=`${gr}conditions`,Jv=`${Gt}.none`,uM=`${Gt}.isEmpty`,cM=`${Gt}.isNotEmpty`,hM=`${Gt}.isEqualTo`,dM=`${Gt}.isNotEqualTo`,fM=`${Gt}.beginsWith`,gM=`${Gt}.endsWith`,mM=`${Gt}.contains`,pM=`${Gt}.doesNotContain`,Yre=`${Gt}.byValue`,wM=`${Gt}.greaterThan`,vM=`${Gt}.greaterThanOrEqualTo`,yM=`${Gt}.lessThan`,CM=`${Gt}.lessThanOrEqualTo`,bM=`${Gt}.isBetween`,SM=`${Gt}.isNotBetween`,RM=`${Gt}.after`,EM=`${Gt}.before`,TM=`${Gt}.today`,MM=`${Gt}.tomorrow`,_M=`${Gt}.yesterday`,PM=`${gr}labels.filterByCondition`,xM=`${gr}labels.filterByValue`,IM=`${gr}labels.conjunction`,Zv=`${gr}labels.disjunction`,Iw=`${gr}values.blankCells`,OM=`${gr}buttons.selectAll`,AM=`${gr}buttons.clear`,HM=`${gr}buttons.ok`,NM=`${gr}buttons.cancel`,DM=`${gr}buttons.placeholder.search`,kM=`${gr}buttons.placeholder.value`,$M=`${gr}buttons.placeholder.secondValue`,LM="CheckboxRenderer:",FM=`${LM}checked`,VM=`${LM}unchecked`,Gre=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:FM,CHECKBOX_RENDERER_NAMESPACE:LM,CHECKBOX_UNCHECKED:VM,CONTEXTMENU_ITEMS_ADD_COMMENT:FT,CONTEXTMENU_ITEMS_ALIGNMENT:jT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:XT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:zT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:GT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:UT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:qT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:YT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:KT,CONTEXTMENU_ITEMS_BORDERS:JT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:eM,CONTEXTMENU_ITEMS_BORDERS_LEFT:tM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:QT,CONTEXTMENU_ITEMS_BORDERS_TOP:ZT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:xT,CONTEXTMENU_ITEMS_COPY:IT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:HT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:AT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:OT,CONTEXTMENU_ITEMS_CUT:NT,CONTEXTMENU_ITEMS_EDIT_COMMENT:VT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:DT,CONTEXTMENU_ITEMS_HIDE_COLUMN:oM,CONTEXTMENU_ITEMS_HIDE_ROW:aM,CONTEXTMENU_ITEMS_INSERT_LEFT:RT,CONTEXTMENU_ITEMS_INSERT_RIGHT:ET,CONTEXTMENU_ITEMS_MERGE_CELLS:$T,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:iM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:rM,CONTEXTMENU_ITEMS_NO_ITEMS:CT,CONTEXTMENU_ITEMS_READ_ONLY:xw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:WT,CONTEXTMENU_ITEMS_REDO:PT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:nM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:MT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:BT,CONTEXTMENU_ITEMS_REMOVE_ROW:TT,CONTEXTMENU_ITEMS_ROW_ABOVE:bT,CONTEXTMENU_ITEMS_ROW_BELOW:ST,CONTEXTMENU_ITEMS_SHOW_COLUMN:sM,CONTEXTMENU_ITEMS_SHOW_ROW:lM,CONTEXTMENU_ITEMS_UNDO:_T,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:kT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:LT,CONTEXT_MENU_ITEMS_NAMESPACE:W$,FILTERS_BUTTONS_CANCEL:NM,FILTERS_BUTTONS_CLEAR:AM,FILTERS_BUTTONS_OK:HM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:DM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:$M,FILTERS_BUTTONS_PLACEHOLDER_VALUE:kM,FILTERS_BUTTONS_SELECT_ALL:OM,FILTERS_CONDITIONS_AFTER:RM,FILTERS_CONDITIONS_BEFORE:EM,FILTERS_CONDITIONS_BEGINS_WITH:fM,FILTERS_CONDITIONS_BETWEEN:bM,FILTERS_CONDITIONS_BY_VALUE:Yre,FILTERS_CONDITIONS_CONTAINS:mM,FILTERS_CONDITIONS_EMPTY:uM,FILTERS_CONDITIONS_ENDS_WITH:gM,FILTERS_CONDITIONS_EQUAL:hM,FILTERS_CONDITIONS_GREATER_THAN:wM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:vM,FILTERS_CONDITIONS_LESS_THAN:yM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:CM,FILTERS_CONDITIONS_NAMESPACE:Gt,FILTERS_CONDITIONS_NONE:Jv,FILTERS_CONDITIONS_NOT_BETWEEN:SM,FILTERS_CONDITIONS_NOT_CONTAIN:pM,FILTERS_CONDITIONS_NOT_EMPTY:cM,FILTERS_CONDITIONS_NOT_EQUAL:dM,FILTERS_CONDITIONS_TODAY:TM,FILTERS_CONDITIONS_TOMORROW:MM,FILTERS_CONDITIONS_YESTERDAY:_M,FILTERS_DIVS_FILTER_BY_CONDITION:PM,FILTERS_DIVS_FILTER_BY_VALUE:xM,FILTERS_LABELS_CONJUNCTION:IM,FILTERS_LABELS_DISJUNCTION:Zv,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:Iw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const j$={languageCode:"en-US",[CT]:"No available options",[bT]:"Insert row above",[ST]:"Insert row below",[RT]:"Insert column left",[ET]:"Insert column right",[TT]:["Remove row","Remove rows"],[MT]:["Remove column","Remove columns"],[_T]:"Undo",[PT]:"Redo",[xw]:"Read only",[xT]:"Clear column",[jT]:"Alignment",[UT]:"Left",[zT]:"Center",[YT]:"Right",[GT]:"Justify",[KT]:"Top",[qT]:"Middle",[XT]:"Bottom",[DT]:"Freeze column",[kT]:"Unfreeze column",[JT]:"Borders",[ZT]:"Top",[QT]:"Right",[eM]:"Bottom",[tM]:"Left",[nM]:"Remove border(s)",[FT]:"Add comment",[VT]:"Edit comment",[BT]:"Delete comment",[WT]:"Read-only comment",[$T]:"Merge cells",[LT]:"Unmerge cells",[IT]:"Copy",[OT]:["Copy with header","Copy with headers"],[AT]:["Copy with group header","Copy with group headers"],[HT]:["Copy header only","Copy headers only"],[NT]:"Cut",[rM]:"Insert child row",[iM]:"Detach from parent",[oM]:["Hide column","Hide columns"],[sM]:["Show column","Show columns"],[aM]:["Hide row","Hide rows"],[lM]:["Show row","Show rows"],[Jv]:"None",[uM]:"Is empty",[cM]:"Is not empty",[hM]:"Is equal to",[dM]:"Is not equal to",[fM]:"Begins with",[gM]:"Ends with",[mM]:"Contains",[pM]:"Does not contain",[wM]:"Greater than",[vM]:"Greater than or equal to",[yM]:"Less than",[CM]:"Less than or equal to",[bM]:"Is between",[SM]:"Is not between",[RM]:"After",[EM]:"Before",[TM]:"Today",[MM]:"Tomorrow",[_M]:"Yesterday",[Iw]:"Blank cells",[PM]:"Filter by condition",[xM]:"Filter by value",[IM]:"And",[Zv]:"Or",[OM]:"Select all",[AM]:"Clear",[HM]:"OK",[NM]:"Cancel",[DM]:"Search",[kM]:"Value",[$M]:"Second value",[FM]:"Checked",[VM]:"Unchecked"},Kre=Gre,OR=j$.languageCode,{register:qre,getItem:U$,hasItem:Xre,getValues:Jre}=lo("languagesDictionaries");z$(j$);function z$(t,e){let n=t,r=e;return De(t)&&(r=t,n=r.languageCode),Zre(n,r),qre(n,Qn(r)),Qn(r)}function Zre(t,e){t!==OR&&Vre(e,U$(OR))}function Y$(t){return BM(t)?Qn(U$(t)):null}function BM(t){return Xre(t)}function Qre(){return Jre()}function G$(t,e,n){const r=Y$(t);if(r===null)return null;const i=r[e];if(Ht(i))return null;const o=eie(i,n);return Array.isArray(o)?o[0]:o}function eie(t,e){let n=t;return _(zre(),r=>{n=r(t,e)}),n}function tie(t){let e=V$(t);return BM(e)||(e=OR,B$(t)),e}function nie(t,e,n){return(e=rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rie(t){var e=iie(t,"string");return typeof e=="symbol"?e:e+""}function iie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xs extends S${constructor(e,n){super(e,null),nie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function BC(t){let{activeHeaderClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:R$})}function oie(t){let{areaCornerVisible:e,...n}=t;return new Xs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:nT})}function sie(t){let{...e}=t;return new Xs({className:"highlight",...e,selectionType:nT})}function aie(t){let{columnClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:sne})}function lie(t){let{cellCornerVisible:e,...n}=t;return new Xs({className:"current",headerAttributes:[EE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Xd})}function uie(t){let{border:e,visualCellRange:n,...r}=t;return new Xs({...e,...r,selectionType:ane},n)}function cie(t){let{...e}=t;return new Xs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:ine})}function XI(t){let{headerClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:tT})}function hie(t){let{rowClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:one})}function die(t,e){fie(t,e),e.add(t)}function fie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return(e=gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gie(t){var e=mie(t,"string");return typeof e=="symbol"?e:e+""}function mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var po=new WeakSet;class pie{constructor(e){die(this,po),vr(this,"options",void 0),vr(this,"layerLevel",0),vr(this,"focus",void 0),vr(this,"fill",void 0),vr(this,"layeredAreas",new Map),vr(this,"areas",new Map),vr(this,"rowHeaders",new Map),vr(this,"columnHeaders",new Map),vr(this,"activeRowHeaders",new Map),vr(this,"activeColumnHeaders",new Map),vr(this,"activeCornerHeaders",new Map),vr(this,"rowHighlights",new Map),vr(this,"columnHighlights",new Map),vr(this,"customSelections",[]),this.options=e,this.focus=lie(e),this.fill=cie(e)}isEnabledFor(e,n){let r=e;e===Xd&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return cs(po,this,hs).call(this,this.layeredAreas,oie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return cs(po,this,hs).call(this,this.areas,sie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return cs(po,this,hs).call(this,this.rowHeaders,XI)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return cs(po,this,hs).call(this,this.columnHeaders,XI)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return cs(po,this,hs).call(this,this.activeRowHeaders,BC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return cs(po,this,hs).call(this,this.activeColumnHeaders,BC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return cs(po,this,hs).call(this,this.activeCornerHeaders,BC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return cs(po,this,hs).call(this,this.rowHighlights,hie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return cs(po,this,hs).call(this,this.columnHighlights,aie)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(uie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),_(this.areas.values(),e=>void e.clear()),_(this.layeredAreas.values(),e=>void e.clear()),_(this.rowHeaders.values(),e=>void e.clear()),_(this.columnHeaders.values(),e=>void e.clear()),_(this.activeRowHeaders.values(),e=>void e.clear()),_(this.activeColumnHeaders.values(),e=>void e.clear()),_(this.activeCornerHeaders.values(),e=>void e.clear()),_(this.rowHighlights.values(),e=>void e.clear()),_(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function hs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function JI(t,e,n){return(e=wie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wie(t){var e=vie(t,"string");return typeof e=="symbol"?e:e+""}function vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yie{constructor(e){JI(this,"ranges",[]),JI(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Cie(t,e){K$(t,e),e.add(t)}function WC(t,e,n){K$(t,e),e.set(t,n)}function K$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(pn(t,e))}function fm(t,e,n){return t.set(pn(t,e),n),n}function pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gm=new WeakMap,Rt=new WeakMap,to=new WeakMap,En=new WeakSet;class AR{constructor(e,n){Cie(this,En),WC(this,gm,void 0),WC(this,Rt,void 0),WC(this,to,{x:0,y:0}),fm(gm,this,e),fm(Rt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Je(Rt,this).createCellCoords(e,n);let o=Je(gm,this).current().highlight;const s=Je(Rt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=pn(En,this,q$).call(this),{row:h,col:d}=pn(En,this,QI).call(this,o),f=Je(Rt,this).fixedRowsBottom(),g=Je(Rt,this).minSpareRows(),v=Je(Rt,this).minSpareCols(),y=Je(Rt,this).autoWrapRow(),E=Je(Rt,this).autoWrapCol(),C=Je(Rt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const P=Hr(r&&g>0&&f===0),T=C.col+1,O=Je(Rt,this).createCellCoords(C.row-c,T>=u?T-u:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,Uu).call(this,O),T>=u),P.value?this.runLocalHooks("insertRowRequire",Je(Rt,this).countRenderableRows()):E&&C.assign(O)}else if(C.row<0){const P=Hr(E),T=C.col-1,O=Je(Rt,this).createCellCoords(c+C.row,T<0?u+T:T);this.runLocalHooks("beforeColumnWrap",P,pn(En,this,Uu).call(this,O),T<0),E&&C.assign(O)}if(C.col>=u){const P=Hr(r&&v>0),T=C.row+1,O=Je(Rt,this).createCellCoords(T>=c?T-c:T,C.col-u);this.runLocalHooks("beforeRowWrap",P,pn(En,this,Uu).call(this,O),T>=c),P.value?this.runLocalHooks("insertColRequire",Je(Rt,this).countRenderableColumns()):y&&C.assign(O)}else if(C.col<0){const P=Hr(y),T=C.row-1,O=Je(Rt,this).createCellCoords(T<0?c+T:T,u+C.col);this.runLocalHooks("beforeRowWrap",P,pn(En,this,Uu).call(this,O),T<0),y&&C.assign(O)}const{rowDir:M,colDir:x}=pn(En,this,ZI).call(this,C);a=M,l=x,o=pn(En,this,Uu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Je(Rt,this).createCellCoords(e,n),i=Je(gm,this).current(),o=Je(Rt,this).visualToRenderableCoords(i.highlight),s=pn(En,this,jC).call(this,i.to.row,i.from.row),a=pn(En,this,UC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=pn(En,this,QI).call(this,i.highlight),f=Je(Rt,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const x=f.col-d;f.col=pn(En,this,UC).call(this,g.col,v.col)+x}else if(r.col>0&&a<=d&&f.col>d){const x=pn(En,this,UC).call(this,v.col,g.col),P=Math.max(f.col-x,1);f.col=x+P}if(r.row<0&&s>=h&&f.row<h){const x=f.row-h;f.row=pn(En,this,jC).call(this,g.row,y.row)+x}else if(r.row>0&&s<=h&&f.row>h){const x=pn(En,this,jC).call(this,y.row,g.row),P=Math.max(f.row-x,1);f.row=x+P}const{rowDir:E,colDir:C}=pn(En,this,ZI).call(this,f);u=E,c=C;const M=pn(En,this,Uu).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;fm(to,this,{x:n,y:r})}resetOffsetSize(){fm(to,this,{x:0,y:0})}}function ZI(t){const{width:e,height:n}=pn(En,this,q$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function q$(){return{width:Je(to,this).x+Je(Rt,this).countRenderableColumns(),height:Je(to,this).y+Je(Rt,this).countRenderableRows()}}function jC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(to,this).y+n}function UC(t,e){const n=Je(Rt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(to,this).x+n}function QI(t){const{row:e,col:n}=Je(Rt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(Rt,this).createCellCoords(Je(to,this).y+e,Je(to,this).x+n)}function Uu(t){const e=t.clone();return e.col=t.col-Je(to,this).x,e.row=t.row-Je(to,this).y,Je(Rt,this).renderableToVisualCoords(e)}mt(AR,Fn);const Qv=0,ey=1,X$=2,WM=3,bie=[WM,X$],Sie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],zC=Symbol("root"),eO=Symbol("child");function Qc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zC;if(e!==zC&&e!==eO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===zC;let i=Qv;if(n){const o=t[0];t.length===0?i=ey:r&&o instanceof wg?i=WM:r&&Array.isArray(o)?i=Qc(o,eO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Sie[l].includes(typeof a))&&(i=X$)}return i}function Df(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===WM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ht(u)&&(u=a),Ht(c)&&(c=l),!r){const f=a,g=l,v=u,y=c;a=Math.min(f,v),l=Math.min(g,y),u=Math.max(f,v),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Rie(t){const e=Qc(t.getSelected());if(e===Qv||e===ey)return[];const n=Df(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Eie(t){const e=Qc(t.getSelected());if(e===Qv||e===ey)return[];const n=Df(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function zu(t,e,n){Tie(t,e),e.set(t,n)}function Tie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e,n){return(e=Mie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mie(t){var e=_ie(t,"string");return typeof e=="symbol"?e:e+""}function _ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function It(t,e){return t.get(J$(t,e))}function wo(t,e,n){return t.set(J$(t,e),n),n}function J$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,ll=new WeakMap,mm=new WeakMap,Jh=new WeakMap,pm=new WeakMap,Zh=new WeakMap;class Z${constructor(e,n){var r=this;al(this,"settings",void 0),al(this,"tableProps",void 0),al(this,"inProgress",!1),al(this,"selectedRange",new yie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),al(this,"highlight",void 0),zu(this,Bn,void 0),zu(this,ll,void 0),al(this,"selectedByRowHeader",new Set),al(this,"selectedByColumnHeader",new Set),zu(this,mm,!1),zu(this,Jh,!1),zu(this,pm,"unknown"),zu(this,Zh,-1),this.settings=e,this.tableProps=n,this.highlight=new pie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[EE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),wo(Bn,this,new AR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),wo(ll,this,new AR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),It(Bn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),It(Bn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),It(Bn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),It(Bn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),It(Bn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),It(Bn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),It(Bn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),It(Bn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),It(ll,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),It(ll,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){wo(pm,this,e)}markEndSource(){wo(pm,this,"unknown")}getSelectionSource(){return It(pm,this)}setExpectedLayers(e){wo(Zh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,wo(Zh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ht(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();wo(mm,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ht(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=It(Zh,this)===-1||this.selectedRange.size()===It(Zh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(_(this.highlight.getAreas(),g=>void g.clear()),_(this.highlight.getLayeredAreas(),g=>void g.clear()),_(this.highlight.getRowHeaders(),g=>void g.clear()),_(this.highlight.getColumnHeaders(),g=>void g.clear()),_(this.highlight.getActiveRowHeaders(),g=>void g.clear()),_(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),_(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),_(this.highlight.getRowHighlights(),g=>void g.clear()),_(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(nT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(tT,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(M).commit(),d.add(y).add(E).commit(),f.add(C).add(M).commit())}const g=!It(Jh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!It(Jh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Xd,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(wo(mm,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?It(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):It(Bn,this).resetOffsetSize(),this.setRangeStart(It(Bn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?It(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):It(Bn,this).resetOffsetSize(),this.setRangeEnd(It(Bn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?It(ll,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):It(ll,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=It(ll,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ye(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ye(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ye(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ye(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ye(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ye(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&It(mm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;wo(Jh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ye(d.row,u,o-1),Ye(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),wo(Jh,this,!1)}selectCells(e){var n=this;const r=Qc(e);if(r===ey)return!1;if(r===Qv)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Df(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),_(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ye(r.row,u,s-1),g=Ye(r.col,Math.min(i,o),Math.max(i,o))):(f=Ye(r,u,s-1),g=i);const v=this.tableProps.createCellCoords(f,g),y=l===0?0:Ye(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),M=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,M,v),C.row=y,M.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",C,M,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ye(r.row,Math.min(e,n),Math.max(e,n)),d=Ye(r.col,a,o-1)):(h=e,d=Ye(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ye(f.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=v,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ye(s.row,-1/0,e-1),col:Ye(s.col,-1/0,n-1)}),i.assign({row:Ye(i.row,-1/0,e-1),col:Ye(i.col,-1/0,n-1)}),o.assign({row:Ye(o.row,0,e-1),col:Ye(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(Xd,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Xd,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}mt(Z$,Fn);const tO=/^(\r\n|\n\r|\r|\n)/,Pie=/^[^\t\r\n]+/,nO=/^\t/;function xie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(nO))t=t.replace(nO,""),n+=1,e[r][n]="";else if(t.match(tO))t=t.replace(tO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Pie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Zd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ul(t,e,n){return(e=Iie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iie(t){var e=Oie(t,"string");return typeof e=="symbol"?e:e+""}function Oie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ul(this,"hot",void 0),ul(this,"metaManager",void 0),ul(this,"tableMeta",void 0),ul(this,"dataSource",void 0),ul(this,"duckSchema",void 0),ul(this,"colToPropCache",void 0),ul(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Wv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(De(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return fT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Jc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Qn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},mg(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const v=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];uR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return lk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];uR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&ln(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Hr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Hr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&ln(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,xc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===xc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Zd(this.getRange(e,n,xc.DESTINATION_RENDERER))}getCopyableText(e,n){return Zd(this.getRange(e,n,xc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Aie,getItem:Hie,hasItem:Q$,getNames:Nie,getValues:u0e}=lo("cellTypes");function jM(t){if(!Q$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Hie(t)}function ci(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Mr(t,n),r&&Wr(t,r),i&&Gl(t,i),Aie(t,e)}function Die(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ln(e,t)}function ty(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?jM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!De(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ke(r,(o,s)=>{if(Die(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),cn(t,i)}function kie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Fk(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Lp(t){return Number.isInteger(t)&&t>=0}function Fp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function wm(t){return t==null}const eL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Yt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Yt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Bv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function rO(t,e,n){return(e=$ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fie(){return class{}}class Vie{constructor(e){rO(this,"metaCtor",Fie()),rO(this,"meta",void 0),this.meta=this.metaCtor.prototype,cn(this.meta,eL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;cn(this.meta,e),ty(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Bie(t,e,n){return(e=Wie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wie(t){var e=jie(t,"string");return typeof e=="symbol"?e:e+""}function jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uie{constructor(e){Bie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){cn(this.meta,e),ty(this.meta,e,e)}}function vm(t,e,n){return(e=zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zie(t){var e=Yie(t,"string");return typeof e=="symbol"?e:e+""}function Yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ow{constructor(e){vm(this,"valueFactory",void 0),vm(this,"data",[]),vm(this,"index",[]),vm(this,"holes",new Set),this.valueFactory=e}obtain(e){Fp(()=>Lp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Fp(()=>Lp(e)||wm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=wm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Fp(()=>Lp(e)||wm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(wm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function iO(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qie=["data","width"];class Xie{constructor(e){iO(this,"globalMeta",void 0),iO(this,"metas",new Ow(()=>this._createMeta())),this.globalMeta=e,this.metas=new Ow(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);cn(r,n),ty(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return kie(this.globalMeta.getMetaConstructor(),qie).prototype}}function oO(t,e,n){return(e=Jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jie(t){var e=Zie(t,"string");return typeof e=="symbol"?e:e+""}function Zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qie{constructor(e){oO(this,"columnMeta",void 0),oO(this,"metas",new Ow(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);cn(i,r),ty(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Fp(()=>Lp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ow(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class tL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Vie(e),this.tableMeta=new Uie(this.globalMeta),this.columnMeta=new Xie(this.globalMeta),this.cellMeta=new Qie(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(tL,Fn);function sO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Zn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ut(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new xc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let v,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Qn(g),t.push(v);else if(i.dataType==="array")v=Qn(g[0]),t.push(v);else{v=[];for(let C=0,M=d.startCols;C<M;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[wk(-1),kv(i.countCols()+(i.view?i.countRowHeaders():0))])}function aO(t,e,n){return(e=eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:e+""}function toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class noe{constructor(e){var n=this;aO(this,"metaManager",void 0),aO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=ln(e,"type")?e.type:null;let c=ut(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function roe(t,e,n){ioe(t,e),e.set(t,n)}function ioe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YC(t,e,n){return(e=ooe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ooe(t){var e=soe(t,"string");return typeof e=="symbol"?e:e+""}function soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aoe(t,e){return t.get(loe(t,e))}function loe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lO=new WeakMap;class uoe{constructor(e){YC(this,"metaManager",void 0),YC(this,"usageTracker",new Set),YC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),roe(this,lO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,aoe(lO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const nL="gridDefault",Xa="editorManager.handlingEditor",coe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},hoe="hooksRefRegisterer",rL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){_(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ts(rL,"MIXIN_NAME",hoe,{writable:!1,enumerable:!1});function ki(t,e,n){return(e=doe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function doe(t){var e=foe(t,"string");return typeof e=="symbol"?e:e+""}function foe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const goe="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class vh{static get EDITOR_TYPE(){return goe}constructor(e){ki(this,"hot",void 0),ki(this,"state",Jt.VIRGIN),ki(this,"_opened",!1),ki(this,"_fullEditMode",!1),ki(this,"_closeCallback",null),ki(this,"TD",null),ki(this,"row",null),ki(this,"col",null),ki(this,"prop",null),ki(this,"originalValue",null),ki(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Jt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Tt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Jt.FINISHED,this.discardEditor(s)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ln(n),a=Qt(n),l=Ln(this.hot.rootElement),u=Qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,M=s.top===l.top?0:1;let x=s.top-l.top-M-E,P=0;this.hot.isRtl()?P=o.innerWidth-s.left-a-g-1+C:P=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(x+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const T=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&O<=0||O===V)&&(x+=1),G<=0&&(P+=1);const X=i.rowsRenderCalculator.startPosition,ne=i.columnsRenderCalculator.startPosition,Q=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),pe=_n(this.hot.rootDocument);let et=n.offsetTop;if(["inline_start","master"].includes(y)&&(et+=X-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:K,wtTable:J}=r.bottomOverlay.clone;et+=K.getWorkspaceHeight()-J.getHeight()-pe}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=ne-Q-a):["top","master","bottom"].includes(y)&&(Re+=ne-Q);const Ae=o.getComputedStyle(this.TD),st=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Pn=parseInt(Ae[st],10)>0?0:1,at=parseInt(Ae.borderTopWidth,10)>0?0:1,m=Qt(n)+Pn,w=un(n)+at,p=IE(c)?pe:0,A=OE(h)?pe:0,L=this.hot.view.maximumVisibleElementWidth(Re)-p+Pn,j=Math.max(this.hot.view.maximumVisibleElementHeight(et)-A+at,this.hot.view.getDefaultRowHeight());return{top:x,start:P,height:w,maxHeight:j,width:m,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt(vh,rL);const moe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Jt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},poe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},woe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},voe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},yoe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ii(e))}};function Coe(){return[coe,moe,poe,woe,voe,yoe]}const boe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Soe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Roe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Eoe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Toe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},Moe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},_oe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Poe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},xoe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Ioe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Ooe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Aoe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Hoe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Noe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Doe(){return[boe,Soe,Roe,Eoe,Toe,Moe,_oe,Poe,xoe,Ioe,Ooe,Aoe,Hoe,Noe]}const koe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},$oe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Loe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Foe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},Voe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Boe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Woe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},joe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Uoe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},zoe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Yoe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Goe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},Koe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},qoe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Xoe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Joe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Zoe(){return[koe,$oe,Loe,Foe,Voe,Boe,Woe,joe,Uoe,zoe,Yoe,Goe,Koe,qoe,Xoe,Joe]}const Qoe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},ese={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},tse={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},nse={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},rse={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},ise=[...Coe(),...Doe(),...Zoe(),Qoe,ese,tse,nse,rse];function iL(t){const e={};return ise.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function ose(t){const e=t.getShortcutManager().addContext("editor"),n=iL(t),r={group:Xa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function sse(t){const e=t.getShortcutManager().addContext("grid"),n=iL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:nL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Xa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function ase(t){[sse,ose].forEach(e=>e(t))}function lse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=uO(t),i=uO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function uO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[_f("Focus catcher")]),n}function use(t){const e=cse(t);let n;const{activate:r,deactivate:i}=lse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:HR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:NR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:nL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?HR(t):NR(t)),u(),!1;h.preventDefault()},position:"after"}])}function HR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function NR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function cse(t){return e=>{if(!e)return null;const n=HR(t),r=NR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function yh(t){zo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function ny(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,v=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&y?r.highlight.row:v?f:y?g:E.row}}}function hse(t){return e=>{const n=ny(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;yh(t.getCell(r?-1:0,n,!0))})}}function dse(){return()=>{}}function fse(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;yh(t.getCell(n,r,!0))})}}function gse(t){return e=>{const n=ny(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;yh(t.getCell(i,o,!0))})}}function mse(t){return e=>{const n=ny(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;yh(t.getCell(i,o,!0))})}}function pse(t){return e=>{const n=ny(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;yh(t.getCell(n,r?-1:0,!0))})}}function wse(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{yh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function vse(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=fse(t):e.isSelectedByCorner()?s=dse():e.isSelectedByRowHeader()?s=pse(t):e.isSelectedByColumnHeader()?s=hse(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=gse(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=wse(t):e.getSelectedRange().size()>1&&(s=mse(t)),(o=s)===null||o===void 0||o(i)}}}const cO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ym=t=>t.map(e=>{const n=e.toLowerCase();return cO.has(n)?cO.get(n):n}).sort().join("+"),yse=t=>t.split("+"),hO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),GC=t=>{let{which:e,key:n}=t;if(hO.has(e))return hO.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},oL=Symbol("shortcut-context");function sL(t){return De(t)&&t.__kindOf===oL}const Cse=t=>{const e=zv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:v,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ht(c))throw new Error("You need to define the shortcut's group.");if(ut(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(v)&&(C.relativeToGroup=v,C.position=y),sL(E)&&(C.forwardToContext=E),l.forEach(M=>{const x=ym(M);if(e.hasItem(x)){const T=e.getItem(x);let O=T.findIndex(G=>G.group===v);O!==-1?y==="before"?O-=1:O+=1:O=T.length,T.splice(O,0,C)}else e.addItem(x,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=ym(l);e.removeItem(u)};return{__kindOf:oL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=ym(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=ym(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(yse(h)):(d.length=0,d.push(...f))})}}};function bse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Sse=["meta","alt","shift","control"],Qh=bse(),ed=[];let Cm=0;function Rse(t,e,n,r,i){const o=f=>Sse.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),g&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Sa(f))return;const v=GC(f);let y=[];o(v)||(y=s(f));const E=[v].concat(y);!i(f,E)&&(Tw()&&y.includes("meta")||!Tw()&&y.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=GC(f);o(g)&&Qh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=GC(f);o(g)&&Qh.release(g)}},c=()=>{Qh.releaseAll()};return{mount:()=>{let f=t;for(Cm+=1;f;)Cm===1&&(f.document.documentElement.addEventListener("keydown",l),ed.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),ed.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=uu(f)},unmount:()=>{let f=t;for(Cm-=1;f;){if(Cm===0){for(let g=0;g<ed.length;g++){const{event:v,listener:y}=ed[g];f.document.documentElement.removeEventListener(v,y)}ed.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=uu(f)}},isPressed:f=>Qh.isPressed(f),releasePressedKeys:()=>Qh.releaseAll()}}const Ese=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=zv({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const v=Cse(g);return o.addItem(g,v),v},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ht`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=sL(y)?y:u(y);let C=!1;if(!E.hasShortcut(v))return C;const M=E.getShortcuts(v);for(let x=0;x<M.length;x++){const{callback:P,runOnlyIf:T,preventDefault:O,stopPropagation:G,captureCtrl:U,forwardToContext:V}=M[x];if(T(g)===!0){if(h=U,C=P(g,v)===!1,h=!1,O&&g.preventDefault(),G&&(Ii(g),g.stopPropagation()),C)break;V&&d(g,v,V)}}return C},f=Rse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function dO(t){const{classNames:e}=Sk(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let KC=null;const qC=new Map;function aL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ei(o);let a,l,u,c,h,d,f=!0;jne(i)&&Wne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=tie(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[w]=m;return!(oe.getSingleton().isRegistered(w)||oe.getSingleton().isDeprecated(w))})),E=new tL(o,y,[noe,uoe]),C=E.getTableMeta(),M=E.getGlobalMeta(),x=zv();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),$p(this)&&(fk(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${CE()}`,qC.set(this.guid,this),this.columnIndexMapper=new IR,this.rowIndexMapper=new IR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new hre(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},T=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},O=(m,w)=>{const p=w>m?1:-1,A=Math.min(m,w),L=Math.max(m,w),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},G=(m,w)=>{const p=w>m?1:-1,A=Math.min(m,w),L=Math.max(m,w),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return j===null||p===1&&j>L||p===-1&&j<A?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new Z$(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,w)=>o._createCellCoords(m,w),createCellRange:(m,w,p)=>o._createCellRange(m,w,p),visualToRenderableCoords:P,renderableToVisualCoords:T,findFirstNonHiddenRenderableRow:O,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(m,w)=>m<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,w).disableVisualSelection});this.selection=U;const V=m=>{let{hiddenIndexesChanged:w}=m;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("afterSetRangeEnd",(m,w)=>{const p=Hr(!1),A=this.selection.getSelectedRange(),{from:L,to:j}=A.current(),K=A.size()-1;this.runHooks("afterSelection",L.row,L.col,j.row,j.col,p,K),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),j.row,o.colToProp(j.col),p,K),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const J=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();J&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(we(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(we(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const w=Hr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const w=m.length-1,{from:p,to:A}=m[w];this.runHooks("afterSelectionEnd",p.row,p.col,A.row,A.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),A.row,o.colToProp(A.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const w=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),we(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const j=K=>{if(K.length===0)return[];const J=[...K];return J.sort((R,S)=>{let[$]=R,[I]=S;return $===I?0:$>I?1:-1}),Sn(J,(R,S)=>{let[$,I]=S;const N=R[R.length-1],[W,H]=N,D=W+H;if($<=D){const B=Math.max(I-(D-$),0);N[1]+=B}else R.push([$,I]);return R},[J[0]])};switch(m){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(C.maxRows===K)return;const J=m==="insert_row_below"?"below":"above";w=w??(J==="below"?K:0);const{delta:b,startPhysicalIndex:R}=a.createRow(w,p,{source:A,mode:J});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:$,startPhysicalIndex:I}=a.createCol(w,p,{source:A,mode:S});if($){if(Array.isArray(C.colHeaders)){const H=[o.toVisualColumn(I),0];H.length+=$,Array.prototype.splice.apply(C.colHeaders,H)}U.shiftColumns(o.toVisualColumn(I),$)}break;case"remove_row":const N=H=>{let D=0;_(H,B=>{let[F,Y]=B;const ae=Yt(F)?o.countRows()-1:Math.max(F-D,0);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeRow(F,Y,A))return;if(U.isSelected()){const{row:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}const _e=o.countRows(),Fe=C.fixedRowsTop;Fe>=ae+1&&(C.fixedRowsTop-=Math.min(Y,Fe-ae));const ze=C.fixedRowsBottom;ze&&ae>=_e-ze&&(C.fixedRowsBottom-=Math.min(Y,ze)),_e===0?U.deselect():A==="ContextMenu.removeRow"?U.refresh():U.shiftRows(F,-Y),D+=Y})};Array.isArray(w)?N(j(w)):N([[w,p]]);break;case"remove_col":const W=H=>{let D=0;_(H,B=>{let[F,Y]=B;const ae=Yt(F)?o.countCols()-1:Math.max(F-D,0);let ce=o.toPhysicalColumn(ae);if(Number.isInteger(F)&&(F=Math.max(F-D,0)),!a.removeCol(F,Y,A))return;if(U.isSelected()){const{col:Me}=o.getSelectedRangeLast().highlight;Me>=F&&Me<=F+Y-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():A==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns(F,-Y);const ze=C.fixedColumnsStart;ze>=ae+1&&(C.fixedColumnsStart-=Math.min(Y,ze-ae)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,Y)),D+=Y})};Array.isArray(w)?W(j(w)):W([[w,p]]);break;default:throw new Error(`There is no such action "${m}"`)}L||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,w=C.minSpareRows,p=C.minCols,A=C.minSpareCols;if(m){const L=o.countRows();L<m&&a.createRow(L,m-L,{source:"auto"})}if(w){const L=o.countEmptyRows(!0);if(L<w){const j=w-L,K=Math.min(j,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),K,{source:"auto"})}}{let L;(p||A)&&(L=o.countEmptyCols(!0));let j=o.countCols();if(p&&!C.columns&&j<p){const K=p-j;L+=K,a.createCol(j,K,{source:"auto"})}if(A&&!C.columns&&o.dataType==="array"&&L<A){j=o.countCols();const K=A-L,J=Math.min(K,C.maxCols-j);a.createCol(j,J,{source:"auto"})}}},populateFromArray(m,w,p,A,L){let j,K,J,b;const R=[],S={},$=[],I=m.row,N=m.col;if(K=w.length,K===0)return!1;let W=0,H=0;switch(De(p)&&(W=p.col-N+1,H=p.row-I+1),L){case"shift_down":const D=zd(w),B=D.length,F=Math.max(B,W),Y=o.getData().slice(I),ae=zd(Y).slice(N,N+F);for(J=0;J<F;J+=1)if(J<B){for(j=0,K=D[J].length;j<H-K;j+=1)D[J].push(D[J][j%K]);J<ae.length?$.push(D[J].concat(ae[J])):$.push(D[J].concat(new Array(Y.length).fill(null)))}else $.push(D[J%B].concat(ae[J]));o.populateFromArray(I,N,zd($));break;case"shift_right":const ce=w.length,_e=Math.max(ce,H),Fe=o.getData().slice(I).map(Pt=>Pt.slice(N));for(j=0;j<_e;j+=1)if(j<ce){for(J=0,b=w[j].length;J<W-b;J+=1)w[j].push(w[j][J%b]);if(j<Fe.length)for(let Pt=0;Pt<Fe[j].length;Pt+=1)w[j].push(Fe[j][Pt]);else w[j].push(...new Array(Fe[0].length).fill(null))}else w.push(w[j%K].slice(0,_e).concat(Fe[j]));o.populateFromArray(I,N,w);break;case"overwrite":default:S.row=m.row,S.col=m.col;let ze=0,Me=0,Ve=!0,_t;const Ai=function(gn){let bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const xt=w[gn%w.length];return bt!==null?xt[bt%xt.length]:xt},rs=w.length,ni=p?p.row-m.row+1:0;for(p?K=ni:K=Math.max(rs,ni),j=0;j<K&&!(p&&S.row>p.row&&ni>rs||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);j++){const Pt=j-ze,gn=Ai(Pt).length,bt=p?p.col-m.col+1:0;if(p?b=bt:b=Math.max(gn,bt),S.col=m.col,_t=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&_t.skipRowOnPaste){ze+=1,S.row+=1,K+=1;continue}for(Me=0,J=0;J<b&&!(p&&S.col>p.col&&bt>gn||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);J++){if(_t=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&_t.skipColumnOnPaste){Me+=1,S.col+=1,b+=1;continue}if(_t.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const xt=J-Me;let Be=Ai(Pt,xt),ri=o.getDataAtCell(S.row,S.col);if(Be!==null&&typeof Be=="object")if(Array.isArray(Be)&&ri===null&&(ri=[]),ri===null||typeof ri!="object")Ve=!1;else{const Ja=Jc(Array.isArray(ri)?ri:ri[0]||ri),Za=Jc(Array.isArray(Be)?Be:Be[0]||Be);Bv(Ja,Za)||Array.isArray(Ja)&&Array.isArray(Za)?Be=Qn(Be):Ve=!1}else ri!==null&&typeof ri=="object"&&(Ve=!1);Ve&&R.push([S.row,S.col,Be]),Ve=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function X(m){const w=V$(m);BM(w)?(o.runHooks("beforeLanguageChange",w),M.language=w,o.runHooks("afterLanguageChange",w)):B$(m)}function ne(m,w){const p=m==="className"?o.rootElement:o.table;if(f)q(p,w);else{let A=[],L=[];M[m]&&(A=Array.isArray(M[m])?M[m]:hR(M[m])),w&&(L=Array.isArray(w)?w:hR(w));const j=cR(A,L),K=cR(L,A);j.length&&we(p,j),K.length&&q(p,K)}M[m]=w}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(jo()||FE())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Gne(this);const m=C.themeName||dO(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=CR.getInstance(o,C,U),d=vse(o),h=new pZ(o),$p(this)&&use(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&Ok(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function Q(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const w=m.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):m}function pe(m,w,p){if(!m.length){p();return}const A=o.getActiveEditor(),L=new Q;let j=!0;L.onQueueEmpty=()=>{A&&j&&A.cancelChanges(),p()};for(let K=m.length-1;K>=0;K--){const[J,b]=m[K],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(J,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(L.addValidatorToQueue(),o.validateCell(m[K][3],S,function($,I){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&I.allowInvalid===!1&&(j=!1,m.splice($,1),I.valid=!0),L.removeValidatorFormQueue()}}(K,S),w))}L.checkIfQueueIsEmpty()}function et(m,w){for(let A=m.length-1;A>=0;A--){let L=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(C.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){L=!0;break}}L||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,w||"edit");const A=o.getActiveEditor();A&&le(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,w){return o.view._wt.createCellCoords(m,w)},this._createCellRange=function(m,w,p){return o.view._wt.createCellRange(m,w,p)},this.validateCell=function(m,w,p,A){let L=o.getCellValidator(w);function j(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(K);return}const b=w.visualCol,R=w.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const $=o.rowIndexMapper.getRenderableFromVisualIndex(R),I=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",$,I,S)}p(K)}dk(L)&&(L=function(K){return function(J,b){b(K.test(J))}}(L)),ut(L)?(m=o.runHooks("beforeValidate",m,w.visualRow,w.prop,A),o._registerImmediate(()=>{L.call(w,m,K=>{o&&(K=o.runHooks("afterValidate",K,m,w.visualRow,w.prop,A),w.valid=K,j(K),o.runHooks("postAfterValidate",K,m,w.visualRow,w.prop,A))})})):o._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function Re(m,w,p){return Array.isArray(m)?m:[[m,w,p]]}function Ae(m,w){const p=o.runHooks("beforeChange",m,w||"edit"),A=m.filter(j=>j!==null);if(p===!1||A.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let j=A.length-1;j>=0;j--){const[K,J,,b]=A[j],R=a.propToCol(J);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C};const{type:$,checkedTemplate:I,uncheckedTemplate:N}=S;if($==="numeric"&&typeof b=="string"&&a$(b)&&(A[j][3]=te(b)),$==="checkbox"){const W=Tt(b),H=W===Tt(I),D=W===Tt(N);(H||D)&&(A[j][3]=H?I:N)}}return A}this.setDataAtCell=function(m,w,p,A){const L=Re(m,w,p),j=[];let K=A,J,b,R;for(J=0,b=L.length;J<b;J++){if(typeof L[J]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[J][1]>=this.countCols()?R=L[J][1]:R=a.colToProp(L[J][1]),j.push([L[J][0],R,l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]])}!K&&typeof m=="object"&&(K=w);const S=Ae(j,K);o.runHooks("afterSetDataAtCell",S,K),pe(S,K,()=>{et(S,K)})},this.setDataAtRowProp=function(m,w,p,A){const L=Re(m,w,p),j=[];let K=A,J,b;for(J=0,b=L.length;J<b;J++)j.push([L[J][0],L[J][1],l.getAtCell(this.toPhysicalRow(L[J][0]),L[J][1]),L[J][2]]);!K&&typeof m=="object"&&(K=w);const R=Ae(j,A);o.runHooks("afterSetDataAtRowProp",R,K),pe(R,K,()=>{et(R,K)})},this.listen=function(){o&&!o.isListening()&&(qC.forEach(m=>{o!==m&&m.unlisten()}),KC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(KC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return KC===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,w,p,A,L,j,K){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const J=typeof A=="number"?o._createCellCoords(A,L):null;return u.populateFromArray(o._createCellCoords(m,w),p,J,j,K)},this.spliceCol=function(m,w,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceCol(m,w,p,...L)},this.spliceRow=function(m,w,p){for(var A=arguments.length,L=new Array(A>3?A-3:0),j=3;j<A;j++)L[j-3]=arguments[j];return a.spliceRow(m,w,p,...L)},this.getSelected=function(){if(U.isSelected())return Ue(U.getSelectedRange(),m=>{let{from:w,to:p}=m;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];_(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const A=p.getTopStartCorner(),L=p.getBottomEndCorner();fe(A.row,L.row,j=>{fe(A.col,L.col,K=>{this.getCellMeta(j,K).readOnly||w.push([j,K,null])})})}),w.length>0&&this.setDataAtCell(w,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const w=m();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(w),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const w=m();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:w,height:p}=m.getLastSize(),{width:A,height:L}=o.rootElement.getBoundingClientRect(),j=A!==w||L!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:A,height:L},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,L),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:A,height:L},j))},this.updateData=function(m,w){sO(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(m,w){sO(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let w=0;if(Array.isArray(m))w=m.length;else if(ut(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let A=0;A<p;A+=1)m(A)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:Wv(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,w,p,A){return Ht(m)?a.getAll():a.getRange(o._createCellCoords(m,w),o._createCellCoords(p,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,w,p,A){return a.getCopyableText(o._createCellCoords(m,w),o._createCellCoords(p,A))},this.getCopyableData=function(m,w){return a.getCopyable(m,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let A=!1,L,j;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&X(m.language);for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ne("className",m.className);else if(L==="tableClassName"&&o.table)ne("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(L)||oe.getSingleton().isDeprecated(L)){const S=m[L];ut(S)?(oe.getSingleton().addAsFixed(L,S,o),C[L]=S):Array.isArray(S)&&(oe.getSingleton().add(L,S,o),C[L]=S)}else!w&&ln(m,L)&&(M[L]=m[L]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const K=o.countCols(),J=C.columns;if(J&&ut(J)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),K>0)for(L=0,j=0;L<K;L++){if(J){const S=A?J(L):J[j];S&&E.updateColumnMeta(j,S)}j+=1}le(m.cell)&&ke(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(ut(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;ut(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),$=ln(m,"themeName");S&&$&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const I=$&&m.themeName||dO(o.rootElement);o.useTheme(I),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(ut(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,w,p,A,L){u.alter(m,w,p,A,L)},this.getCell=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=w,L=m;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||A===null||L===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,A),p)},this.getCoords=function(m){const w=this.view._wt.wtTable.getCoords(m);if(w===null)return null;const{row:p,col:A}=w;let L=p,j=A;return p>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(p)),A>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(L,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,w){return a.get(m,a.colToProp(w))},this.getDataAtRowProp=function(m,w){return a.get(m,w)},this.getDataAtCol=function(m){const w=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)w.push(p[A][L]);return w},this.getDataAtProp=function(m){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<p.length;A+=1)for(let L=0;L<p[A].length;L+=1)w.push(p[A][L]);return w},this.getSourceData=function(m,w,p,A){let L;return m===void 0?L=l.getData():L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,A)),L},this.getSourceDataArray=function(m,w,p,A){let L;return m===void 0?L=l.getData(!0):L=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,A),!0),L},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,w,p,A){const L=Re(m,w,p),j=this.hasHook("afterSetSourceDataAtCell"),K=[];j&&_(L,b=>{let[R,S,$]=b;K.push([R,S,l.getAtCell(R,S),$])}),_(L,b=>{let[R,S,$]=b;l.setAtCell(R,S,$)}),j&&this.runHooks("afterSetSourceDataAtCell",K,A),this.render();const J=o.getActiveEditor();J&&le(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,w){return l.getAtCell(m,w)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,w,p,A){const L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,w,p,A],[j,K]=L;let[,,J,b]=L,R=null,S=null;J===void 0&&(J=j),b===void 0&&(b=K);let $="mixed";return fe(Math.max(Math.min(j,J),0),Math.max(j,J),I=>{let N=!0;return fe(Math.max(Math.min(K,b),0),Math.max(K,b),W=>(S=this.getCellMeta(I,W).type,R?N=R===S:R=S,N)),$=N?S:"mixed",N}),$},this.removeCellMeta=function(m,w,p){const[A,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(w)];let j=E.getCellMetaKeyValue(A,L,p);o.runHooks("beforeRemoveCellMeta",m,w,p,j)!==!1&&(E.removeCellMeta(A,L,p),o.runHooks("afterRemoveCellMeta",m,w,p,j)),j=null},this.spliceCellsMeta=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,A=new Array(p>2?p-2:0),L=2;L<p;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(m),w),A.length>0&&_(A.reverse(),j=>{E.createRow(this.toPhysicalRow(m)),_(j,(K,J)=>this.setCellMetaObject(m,J,K))}),o.render()},this.setCellMetaObject=function(m,w,p){typeof p=="object"&&ke(p,(A,L)=>{this.setCellMeta(m,w,L,A)})},this.setCellMeta=function(m,w,p,A){if(o.runHooks("beforeSetCellMeta",m,w,p,A)===!1)return;let j=m,K=w;m<this.countRows()&&(j=this.toPhysicalRow(m)),w<this.countCols()&&(K=this.toPhysicalColumn(w)),E.setCellMeta(j,K,p,A),o.runHooks("afterSetCellMeta",m,w,p,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),L=this.toPhysicalColumn(w);return A===null&&(A=m),L===null&&(L=w),E.getCellMeta(A,L,{visualRow:m,visualColumn:w,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).renderer:m.renderer;return typeof p=="string"?Pw(p):Ht(p)?Pw("text"):p},this.getCellEditor=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).editor:m.editor;return typeof p=="string"?_w(p):Ht(p)?_w("text"):p},this.getCellValidator=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).validator:m.validator;return typeof p=="string"?KE(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,w){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,m)},this.validateColumns=function(m,w){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,m)},this._validateCells=function(m,w,p){const A=new Q;m&&(A.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(p!==void 0&&p.indexOf(j)===-1){j-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,j),o.getCellMeta(L,j),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),j-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let w=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],fe(o.countRows()-1,A=>{w.push(o.getRowHeader(A))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:ut(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,w=o.countCols();m<w;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const J=[],b=o.countCols();for(let R=0;R<b;R++)J.push(o.getColHeader(R));return J}let A=C.colHeaders;const L=function(J){const b=[],R=o.countCols();let S=0;for(;S<R;S++)ut(C.columns)&&C.columns(S)&&b.push(S);return b[J]},j=o.toPhysicalColumn(p),K=L(j);return C.colHeaders===!1?A=null:C.columns&&ut(C.columns)&&C.columns(K)&&C.columns(K).title?A=C.columns(K).title:C.columns&&C.columns[j]&&C.columns[j].title?A=C.columns[j].title:Array.isArray(C.colHeaders)&&C.colHeaders[j]!==void 0?A=C.colHeaders[j]:ut(C.colHeaders)?A=C.colHeaders(j):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(A=Kv(p)),A=o.runHooks("modifyColumnHeaderValue",A,m,w),A},this._getColWidthFromSettings=function(m){let w;if(m>=0&&(w=o.getCellMeta(0,m).width),(w===void 0||w===C.width)&&(w=C.colWidths),w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(m,w){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,w),p===void 0&&(p=Zc),p},this._getRowHeightFromSettings=function(m){const w=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(m,w){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return RR(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(m===!0)return!1}),w},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return RR(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(m===!0)return!1}),w},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,w,p,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ht(m)||Ht(w)?!1:this.selectCells([[m,w,p,A]],L,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const A=U.selectCells(m);return A&&p&&o.listen(),d.resume(),A},this.selectColumns=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,w,p)},this.selectRows=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,w,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,w,p)};const st=(m,w)=>m.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(m,w){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:A,col:L,considerHiddenIndexes:j}=m??{};let K=A,J=L;if(ut(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const $=Number.isInteger(A)&&A>=0,I=Number.isInteger(L)&&L>=0,N=$?st(this.rowIndexMapper,A):void 0,W=I?st(this.columnIndexMapper,L):void 0;if(N===null||W===null)return!1;K=$?o.rowIndexMapper.getRenderableFromVisualIndex(N):A,J=I?o.columnIndexMapper.getRenderableFromVisualIndex(W):L}const b=Number.isInteger(K),R=Number.isInteger(J);let S=!1;return b&&K>=0&&R&&J>=0?S=o.view.scrollViewport(o._createCellCoords(K,J),m.horizontalSnap,m.verticalSnap):b&&K>=0&&(R&&J<0||!R)?S=o.view.scrollViewportVertically(K,m.verticalSnap):R&&J>=0&&(b&&K<0||!b)&&(S=o.view.scrollViewportHorizontally(J,m.horizontalSnap)),ut(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ut(m)&&this.addHookOnce("afterScroll",m);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():ut(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),qC.delete(this.guid),$p(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}qo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),x.getItems().forEach(m=>{let[,w]=m;w.destroy()}),x.clear(),o.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(o),ke(o,(m,w,p)=>{ut(m)?p[w]=Pn(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function Pn(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return x.getItem(Zn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,w,p){oe.getSingleton().add(m,w,o,p)},this.hasHook=function(m){return oe.getSingleton().has(m,o)||oe.getSingleton().has(m)},this.addHookOnce=function(m,w,p){oe.getSingleton().once(m,w,o,p)},this.removeHook=function(m,w){oe.getSingleton().remove(m,w,o)},this.runHooks=function(m,w,p,A,L,j,K){return oe.getSingleton().run(o,m,w,p,A,L,j,K)},this.getTranslatedPhrase=function(m,w){return G$(C.language,m,w)},this.toHTML=()=>bR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",bR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){_(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){_(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const at=Ese({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&at.releasePressedKeys()}),this.getShortcutManager=function(){return at},this.getFocusManager=function(){return h},GE().forEach(m=>{const w=pg(m);x.addItem(m,new w(this))}),ase(o),at.setActiveContextName("grid"),oe.getSingleton().run(o,"construct")}function fO(t,e,n){t.addEventListener(e,n,!1)}function gO(t,e,n){t.removeEventListener(e,n,!1)}function bm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function lL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=bm(s).fontSize,o.style.fontFamily=bm(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=bm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=bm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>v?y.width=`${n.minWidth}px`:v>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(fO(s,"input",a),fO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){gO(s,"input",a),gO(s,"keydown",l)}}}function mO(t,e){const n=xE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}hg(e,i)}function cl(t,e,n){return(e=Tse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tse(t){var e=Mse(t,"string");return typeof e=="symbol"?e:e+""}function Mse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _se="ht_editor_visible",Sm="ht_editor_hidden",pO="textEditor",Pse="text";class Ou extends vh{static get EDITOR_TYPE(){return Pse}constructor(e){super(e),cl(this,"eventManager",new Ei(this)),cl(this,"autoResize",lL(this.hot.rootDocument)),cl(this,"TEXTAREA",void 0),cl(this,"textareaStyle",void 0),cl(this,"TEXTAREA_PARENT",void 0),cl(this,"textareaParentStyle",void 0),cl(this,"layerClass",void 0),this.eventManager=new Ei(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Kd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),hg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],Mu(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Sm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Gk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",we(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Sm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,Sm)&&we(this.TEXTAREA_PARENT,Sm),n?(this.layerClass=_se,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){LE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:pO},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;mO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;mO(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(pO)}}const xse="base";function bg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Kx())):a&&c.push(Kx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(qx())):(u.push(s.invalidCellClassName),a&&c.push(qx()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),we(e,u),q(e,l),Pu(e,c),be(e,h)}bg.RENDERER_TYPE=xse;const Ise="text";function Js(t,e,n,r,i,o,s){bg.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Tt(a),s.trimWhitespace&&(a=a.trim()),ja(e,a)}Js.RENDERER_TYPE=Ise;const Ose="text",uL={CELL_TYPE:Ose,editor:Ou,renderer:Js};ci(uL);Te.editors={BaseEditor:vh};function Te(t,e){const n=new aL(t,e||{},hT);return n.init(),n}Te.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new aL(t,e,hT)};Te.DefaultSettings=eL();Te.hooks=oe.getSingleton();Te.CellCoords=hu;Te.CellRange=wg;Te.packageName="handsontable";Te.buildDate="24/04/2025 10:59:00";Te.version="15.3.0";Te.languages={dictionaryKeys:Kre,getLanguageDictionary:Y$,getLanguagesDictionaries:Qre,registerLanguageDictionary:z$,getTranslatedPhrase:G$};const wO="handsontableEditor",Ase="handsontable";class UM extends Ou{static get EDITOR_TYPE(){return Ase}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),hg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&cn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:wO,relativeToGroup:Xa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ii(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wO)}}function Hse(t,e){cL(t,e),e.add(t)}function vO(t,e,n){cL(t,e),e.set(t,n)}function cL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rm(t,e,n){return(e=Nse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nse(t){var e=Dse(t,"string");return typeof e=="symbol"?e:e+""}function Dse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XC(t,e){return t.get(DR(t,e))}function DR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kse="autocomplete";var JC=new WeakMap,yO=new WeakMap,ZC=new WeakSet;class zM extends UM{constructor(){super(...arguments),Hse(this,ZC),Rm(this,"query",null),Rm(this,"strippedChoices",[]),Rm(this,"rawChoices",[]),vO(this,JC,this.hot.guid.slice(0,9)),vO(this,yO,fg(()=>{this.focus()},100)),Rm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=fR(Tt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return kse}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[I8(),T8(),pk("listbox"),N8()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[bi("false"),D8(`${XC(JC,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",XC(yO,this)),this.htEditor.updateSettings({colWidths:e?[Qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Js(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:v,locale:y}=this.cellProperties,E=this.query;let C=Tt(d),M,x;C&&!v&&(M=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),M!==-1&&(x=C.substr(M,E.length),C=C.replace(x,`<strong>${x}</strong>`))),n&&be(l,[M8(),...r?[F8(i)]:[],...r?[V8(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{be(h,[EE()]),be(this.TEXTAREA,...k8(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Hs()),be(this.htEditor.rootElement,[mk(),$8("polite"),L8("text"),["id",`${XC(JC,this)}-listbox-${o}-${s}`]]),be(this.TEXTAREA,...bi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[bi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=xE(this.TEXTAREA),r=Ik(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(zd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),hg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),DR(ZC,this,CO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),DR(ZC,this,CO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Tt(o));return Ue(r,o=>n?o:fR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Kk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function CO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+_n(this.hot.rootDocument)})}const $se="checkbox";class hL extends vh{static get EDITOR_TYPE(){return $se}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ia=()=>window,pi=()=>window.document,kR=(t,e)=>window.setTimeout(t,e),xo=function(t,e,n,r){t.addEventListener(e,n,!!r)},ds=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Lse=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Br=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},QC=function(t,e){Br(t,e)||(t.className=t.className===""?e:t.className+" "+e)},eb=function(t,e){t.className=Lse((" "+t.className+" ").replace(" "+e+" "," "))},YM=function(t){return/Array/.test(Object.prototype.toString.call(t))},zr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Fse=function(t){let e=t.getDay();return e===0||e===6},Vse=function(t){return t%4===0&&t%100!==0||t%400===0},bO=function(t,e){return[31,Vse(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Em=function(t){zr(t)&&t.setHours(0,0,0,0)},Tm=function(t,e){return t.getTime()===e.getTime()},Aw=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?zr(e[r])?n&&(t[r]=new Date(e[r].getTime())):YM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Aw({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},SO=function(t,e,n){let r=pi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Aw(r,n),t.dispatchEvent(r)},RO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},vo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},EO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Bse=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Wse=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},jse=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():Wse(o,i))+"</td>"},Use=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},zse=function(t){return"<tbody>"+t.join("")+"</tbody>"},Yse=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+EO(t,e)+'">'+EO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Gse=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,v=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",YM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Kse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Yse(t)+zse(e)+"</table>"};function $R(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ia().event;let o=i.target||i.srcElement;if(o)if(Br(o,"is-disabled")||(Br(o,"pika-button")&&!Br(o,"is-empty")&&!Br(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&kR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Br(o,"pika-prev")?e.prevMonth():Br(o,"pika-next")&&e.nextMonth()),Br(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ia().event;let o=i.target||i.srcElement;o&&(Br(o,"pika-select-month")?e.gotoMonth(o.value):Br(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Ia().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),zr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=pi().activeElement;do if(Br(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=kR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ia().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Br(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),xo(o,"change",e._onChange)));do if(Br(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=pi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),xo(e.el,"mousedown",e._onMouseDown,!0),xo(e.el,"touchend",e._onMouseDown,!0),xo(e.el,"change",e._onChange),n.keyboardInput&&xo(pi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?pi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),xo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;zr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",xo(n.trigger,"click",e._onInputClick),xo(n.trigger,"focus",e._onInputFocus),xo(n.trigger,"blur",e._onInputBlur)):this.show()}$R.prototype={config:function(t){this._o||(this._o=Aw({},vo,!0));let e=Aw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,zr(e.minDate)||(e.minDate=!1),zr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),YM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||vo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,zr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return zr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",SO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!zr(t))return;let n=this._o.minDate,r=this._o.maxDate;zr(n)&&t<n?t=n:zr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Em(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),SO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(zr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=RO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=RO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Em(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=vo.minDate,this._o.minYear=vo.minYear,this._o.minMonth=vo.minMonth,this._o.startRange=vo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Em(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=vo.maxDate,this._o.maxYear=vo.maxYear,this._o.maxMonth=vo.maxMonth,this._o.endRange=vo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Gse(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&kR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ia().innerWidth||pi().documentElement.clientWidth,i=Ia().innerHeight||pi().documentElement.clientHeight,o=pi().body.scrollTop||pi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ia().pageXOffset,a=l.bottom+Ia().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",QC(this.el,u?"left-aligned":"right-aligned"),QC(this.el,c?"bottom-aligned":"top-aligned"),eb(this.el,u?"right-aligned":"left-aligned"),eb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=bO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Em(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=bO(h,u),g=o+s,v=g;for(;v>7;)v-=7;g+=7-v;let y=!1;for(let E=0,C=0;E<g;E++){let M=new Date(t,e,1+(E-s)),x=zr(this._d)?Tm(M,this._d):!1,P=Tm(M,i),T=r.events.indexOf(M.toDateString())!==-1,O=E<s||E>=o+s,G=1+(E-s),U=e,V=t,X=r.startRange&&Tm(r.startRange,M),ne=r.endRange&&Tm(r.endRange,M),Q=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,te=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&Fse(M)||r.disableDayFn&&r.disableDayFn(M);O&&(E<s?(G=f+G,U=u,V=h):(G=G-o,U=c,V=d));let pe={day:G,month:U,year:V,hasEvent:T,isSelected:x,isToday:P,isDisabled:te,isEmpty:O,isStartRange:X,isEndRange:ne,isInRange:Q,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&x&&(y=!0),l.push(Bse(pe)),++C===7&&(r.showWeekNumber&&l.unshift(jse(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(Use(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return Kse(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),eb(this.el,"is-hidden"),this._o.bound&&(xo(pi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ds(pi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),QC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ds(this.el,"mousedown",this._onMouseDown,!0),ds(this.el,"touchend",this._onMouseDown,!0),ds(this.el,"change",this._onChange),t.keyboardInput&&ds(pi(),"keydown",this._onKeyChange),t.field&&(ds(t.field,"change",this._onInputChange),t.bound&&(ds(t.trigger,"click",this._onInputClick),ds(t.trigger,"focus",this._onInputFocus),ds(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function qse(t,e){Xse(t,e),e.add(t)}function Xse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TO(t,e,n){return(e=Jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:e+""}function Zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dL="date",MO="dateEditor",Qse="DD/MM/YYYY";var Mm=new WeakSet;class fL extends Ou{constructor(){super(...arguments),qse(this,Mm),TO(this,"parentDestroyed",!1),TO(this,"$datePicker",null)}static get EDITOR_TYPE(){return dL}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof $R!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();we(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:MO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(MO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=tb(Mm,this,nb).call(this),r=this.hot.view.isMouseDown(),i=e?VE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new $R(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Z(o,n,!0).isValid()&&this.$datePicker.setMoment(Z(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&mg(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:tb(Mm,this,nb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Z(a).format(tb(Mm,this,nb).call(this))),this.setValue(a),i&&i(),jo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+un(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function nb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Qse}const eae="dropdown";class gL extends zM{static get EDITOR_TYPE(){return eae}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const tae="numeric";class mL extends Ou{static get EDITOR_TYPE(){return tae}}function nae(t,e,n){return(e=rae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oae="password";class pL extends Ou{constructor(){super(...arguments),nae(this,"autoResize",lL(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return oae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,qo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const rb="ht_editor_visible",_O="selectEditor",sae="select";class wL extends vh{static get EDITOR_TYPE(){return sae}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(..._u()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,rb)&&we(this.selectWrapper,rb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),qo(this.select),ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,xu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,rb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:_O};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_O)}}const aae="time";class vL extends Ou{static get EDITOR_TYPE(){return aae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function lae(){Mr(vh),Mr(zM),Mr(hL),Mr(fL),Mr(gL),Mr(UM),Mr(mL),Mr(pL),Mr(wL),Mr(Ou),Mr(vL)}const uae="html";function GM(t,e,n,r,i,o,s){bg.apply(this,[t,e,n,r,i,o,s]),xu(e,o??"",!1)}GM.RENDERER_TYPE=uae;const cae="autocomplete";function Ch(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?GM:Js,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(..._u()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new Ei(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Ch.RENDERER_TYPE=cae;const hae="dropdown";function KM(t,e,n,r,i,o,s){Ch.apply(this,[t,e,n,r,i,o,s])}KM.RENDERER_TYPE=hae;const PO=new WeakMap,xO=new WeakMap,dae="htBadValue",eh="data-row",th="data-col",fae="checkboxRenderer",yL="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===yL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function qM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;bg.apply(this,[t,e,n,r,i,o,s]),gae(t);let u=mae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),qo(e),o===s.checkedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Yt(o)?q(u,"noValue"):(u.style.display="none",q(u,dae),h=!0),be(u,[[eh,n],[th,r]]),l&&be(u,[_f(u.checked?t.getTranslatedPhrase(FM):t.getTranslatedPhrase(VM)),yk(u.checked),_8()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const y=pae(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),PO.has(t)||(PO.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:fae,relativeToGroup:Xa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let M=[],x=0;if(y){for(let P=0;P<y.length;P++){const{row:T,col:O}=y[P].getTopStartCorner(),{row:G,col:U}=y[P].getBottomEndCorner();for(let V=T;V<=G;V+=1)for(let X=O;X<=U;X+=1){const ne=t.getCellMeta(V,X);if(ne.hidden)continue;const Q={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){v===!0&&!ne.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[V,X,null]]):C.set(E.length,[[V,X,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const te=t.getDataAtCell(V,X);v===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(te)?M.push([V,X,ne.uncheckedTemplate,Q]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(te)&&M.push([V,X,ne.checkedTemplate,Q]):M.push([V,X,ne.uncheckedTemplate,Q]),x+=1}E.push(x),x=0}M.every(P=>{let[,,T]=P;return T===M[0][2]})?M=M.map(P=>{let[T,O,G]=P;return[T,O,G]}):M=M.map(P=>{let[T,O,,G]=P;return[T,O,G.checkedTemplate]}),M.length>0&&E.forEach((P,T)=>{let O=M.splice(0,P);C.size&&C.has(T)&&(O=[...O,...C.get(T)]),t.setDataAtCell(O)})}}function g(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const E=v[y].getTopStartCorner(),C=v[y].getBottomEndCorner();for(let M=E.row;M<=C.row;M++)for(let x=E.col;x<=C.col;x++){if(t.getCellMeta(M,x).readOnly)continue;const T=t.getCell(M,x);if(zo(T)&&T.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}qM.RENDERER_TYPE=yL;function gae(t){let e=xO.get(t);if(!e){const{rootElement:n}=t;e=new Ei(t),e.addEventListener(n,"click",r=>vae(r,t)),e.addEventListener(n,"mouseup",r=>wae(r,t)),e.addEventListener(n,"change",r=>yae(r,t)),xO.set(t,e)}return e}function mae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function pae(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function wae(t,e){const{target:n}=t;XM(n)&&(!n.hasAttribute(eh)||!n.hasAttribute(th)||setTimeout(e.listen,10))}function vae(t,e){const{target:n}=t;if(!XM(n)||!n.hasAttribute(eh)||!n.hasAttribute(th))return;const r=parseInt(n.getAttribute(eh),10),i=parseInt(n.getAttribute(th),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function yae(t,e){const{target:n}=t;if(!XM(n)||!n.hasAttribute(eh)||!n.hasAttribute(th))return;const r=parseInt(n.getAttribute(eh),10),i=parseInt(n.getAttribute(th),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function XM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Cae="handsontable";function JM(t,e,n,r,i,o,s){Ch.apply(this,[t,e,n,r,i,o,s])}JM.RENDERER_TYPE=Cae;var bae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sae(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ib,IO;function Rae(){return IO||(IO=1,ib={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ib}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ob,OO;function CL(){if(OO)return ob;OO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let v="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let T=0;T<t.length;T++){let O=t[T];if(v=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*O.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let M={};Object.keys(f).forEach(T=>{M[f[T]]=T});let x=Object.keys(M).sort().reverse(),P=x.length;for(let T=0;T<P;T++){let O=x[T],G=M[O];if(v=l.replace(O,""),v!==l){let U;switch(G){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(v,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=e_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),v=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,v);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return ob={unformat:a},ob}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var sb,AO;function ZM(){if(AO)return sb;AO=1;let t=CL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),M=g(E);return C&&M}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,M=!1){let x=Object.keys(y).map(P=>{if(!E[P])return console.error(`${C} Invalid key: ${P}`),!1;let T=y[P],O=E[P];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(T,u,`[Validate ${P}]`,!0))return!1}else if(typeof T!==O.type)return console.error(`${C} ${P} type mismatched: "${O.type}" expected, "${typeof T}" provided`),!1;if(O.restrictions&&O.restrictions.length){let G=O.restrictions.length;for(let U=0;U<G;U++){let{restriction:V,message:X}=O.restrictions[U];if(!V(T,y))return console.error(`${C} ${P} invalid value: ${X}`),!1}}return O.restriction&&!O.restriction(T,y)?(console.error(`${C} ${P} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(T)===-1?(console.error(`${C} ${P} invalid value: must be among ${JSON.stringify(O.validValues)}, "${T}" provided`),!1):!(O.children&&!f(T,O.children,`[Validate ${P}]`))});return M||x.push(...Object.keys(E).map(P=>{let T=E[P];if(typeof T=="string"&&(T={type:T}),T.mandatory){let O=T.mandatory;if(typeof O=="function"&&(O=O(y)),O&&y[P]===void 0)return console.error(`${C} Missing mandatory key "${P}"`),!1}return!0})),x.reduce((P,T)=>P&&T,!0)}function g(y){return f(y,u,"[Validate format]")}function v(y){return f(y,c,"[Validate language]")}return sb={validate:h,validateFormat:g,validateInput:d,validateLanguage:v},sb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Eae(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Tae(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Mae(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function _ae(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Pae(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function xae(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Iae(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Oae(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Aae(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Hae(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Nae(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Dae(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function kae(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function $ae(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Lae(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Fae(t,e={}){return typeof t!="string"?t:(t=Eae(t,e),t=Tae(t,e),Mae(t,e),xae(t,e),Iae(t,e),kae(t,e),Hae(t,e),Nae(t,e),Oae(t,e),Dae(t,e),Aae(t,e),_ae(t,e),Pae(t,e),$ae(t,e),Lae(t,e),e)}var QM={parseFormat:Fae};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ab,HO;function e_(){if(HO)return ab;HO=1;const t=Rae(),e=ZM(),n=QM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,ab=r,ab}function Vae(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Bae(t,e){t.forEach(n=>{let r;try{r=Vae(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var Wae=t=>({loadLanguagesInNode:e=>Bae(e,t)}),bL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(T){var O,G,U,V=p.prototype={constructor:p,toString:null,valueOf:null},X=new p(1),ne=20,Q=4,te=-7,pe=21,et=-1e7,Re=1e7,Ae=!1,st=1,Pn=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(b,R){var S,$,I,N,W,H,D,B,F=this;if(!(F instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){F.s=b.s,!b.c||b.e>Re?F.c=F.e=null:b.e<et?F.c=[F.e=0]:(F.e=b.e,F.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if(F.s=1/b<0?(b=-b,-1):1,b===~~b){for(N=0,W=b;W>=10;W/=10,N++);N>Re?F.c=F.e=null:(F.e=N,F.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return U(F,B,H);F.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(N=B.indexOf("."))>-1&&(B=B.replace(".","")),(W=B.search(/e/i))>0?(N<0&&(N=W),N+=+B.slice(W+1),B=B.substring(0,W)):N<0&&(N=B.length)}else{if(C(R,2,m.length,"Base"),R==10&&w)return F=new p(b),K(F,ne+F.e+1,Q);if(B=String(b),H=typeof b=="number"){if(b*0!=0)return U(F,B,H,R);if(F.s=1/b<0?(B=B.slice(1),-1):1,p.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else F.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),N=W=0,D=B.length;W<D;W++)if(S.indexOf($=B.charAt(W))<0){if($=="."){if(W>N){N=D;continue}}else if(!I&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){I=!0,W=-1,N=0;continue}return U(F,String(b),H,R)}H=!1,B=G(B,R,10,F.s),(N=B.indexOf("."))>-1?B=B.replace(".",""):N=B.length}for(W=0;B.charCodeAt(W)===48;W++);for(D=B.length;B.charCodeAt(--D)===48;);if(B=B.slice(W,++D)){if(D-=W,H&&p.DEBUG&&D>15&&(b>c||b!==o(b)))throw Error(a+F.s*b);if((N=N-W-1)>Re)F.c=F.e=null;else if(N<et)F.c=[F.e=0];else{if(F.e=N,F.c=[],W=(N+1)%u,N<0&&(W+=u),W<D){for(W&&F.c.push(+B.slice(0,W)),D-=u;W<D;)F.c.push(+B.slice(W,W+=u));W=u-(B=B.slice(W)).length}else W-=D;for(;W--;B+="0");F.c.push(+B)}}else F.c=[F.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),ne=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),Q=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),te=S[0],pe=S[1]):(C(S,-1e9,f,R),te=-(pe=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),et=S[0],Re=S[1];else if(C(S,-1e9,f,R),S)et=-(Re=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ae=S;else throw Ae=!S,Error(s+"crypto unavailable");else Ae=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),st=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),Pn=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")at=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ne,ROUNDING_MODE:Q,EXPONENTIAL_AT:[te,pe],RANGE:[et,Re],CRYPTO:Ae,MODULO_MODE:st,POW_PRECISION:Pn,FORMAT:at,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,$=b.c,I=b.e,N=b.s;e:if({}.toString.call($)=="[object Array]"){if((N===1||N===-1)&&I>=-1e9&&I<=f&&I===o(I)){if($[0]===0){if(I===0&&$.length===1)return!0;break e}if(R=(I+1)%u,R<1&&(R+=u),String($[0]).length==R){for(R=0;R<$.length;R++)if(S=$[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if($===null&&I===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return L(arguments,-1)},p.minimum=p.min=function(){return L(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,I,N,W,H,D=0,B=[],F=new p(X);if(S==null?S=ne:C(S,0,f),W=i(S/u),Ae)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(W*=2));D<W;)H=$[D]*131072+($[D+1]>>>11),H>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),$[D]=I[0],$[D+1]=I[1]):(B.push(H%1e14),D+=2);D=W/2}else if(crypto.randomBytes){for($=crypto.randomBytes(W*=7);D<W;)H=($[D]&31)*281474976710656+$[D+1]*1099511627776+$[D+2]*4294967296+$[D+3]*16777216+($[D+4]<<16)+($[D+5]<<8)+$[D+6],H>=9e15?crypto.randomBytes(7).copy($,D):(B.push(H%1e14),D+=7);D=W/7}else throw Ae=!1,Error(s+"crypto unavailable");if(!Ae)for(;D<W;)H=R(),H<9e15&&(B[D++]=H%1e14);for(W=B[--D],S%=u,W&&S&&(H=h[u-S],B[D]=o(W/H)*H);B[D]===0;B.pop(),D--);if(D<0)B=[N=0];else{for(N=-1;B[0]===0;B.splice(0,1),N-=u);for(D=1,H=B[0];H>=10;H/=10,D++);D<u&&(N-=u-D)}return F.e=N,F.c=B,F}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},G=function(){var b="0123456789";function R(S,$,I,N){for(var W,H=[0],D,B=0,F=S.length;B<F;){for(D=H.length;D--;H[D]*=$);for(H[0]+=N.indexOf(S.charAt(B++)),W=0;W<H.length;W++)H[W]>I-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/I|0,H[W]%=I)}return H.reverse()}return function(S,$,I,N,W){var H,D,B,F,Y,ae,ce,_e,Fe=S.indexOf("."),ze=ne,Me=Q;for(Fe>=0&&(F=Pn,Pn=0,S=S.replace(".",""),_e=new p($),ae=_e.pow(S.length-Fe),Pn=F,_e.c=R(P(y(ae.c),ae.e,"0"),10,I,b),_e.e=_e.c.length),ce=R(S,$,I,W?(H=m,b):(H=b,m)),B=F=ce.length;ce[--F]==0;ce.pop());if(!ce[0])return H.charAt(0);if(Fe<0?--B:(ae.c=ce,ae.e=B,ae.s=N,ae=O(ae,_e,ze,Me,I),ce=ae.c,Y=ae.r,B=ae.e),D=B+ze+1,Fe=ce[D],F=I/2,Y=Y||D<0||ce[D+1]!=null,Y=Me<4?(Fe!=null||Y)&&(Me==0||Me==(ae.s<0?3:2)):Fe>F||Fe==F&&(Me==4||Y||Me==6&&ce[D-1]&1||Me==(ae.s<0?8:7)),D<1||!ce[0])S=Y?P(H.charAt(1),-ze,H.charAt(0)):H.charAt(0);else{if(ce.length=D,Y)for(--I;++ce[--D]>I;)ce[D]=0,D||(++B,ce=[1].concat(ce));for(F=ce.length;!ce[--F];);for(Fe=0,S="";Fe<=F;S+=H.charAt(ce[Fe++]));S=P(S,B,H.charAt(0))}return S}}(),O=function(){function b($,I,N){var W,H,D,B,F=0,Y=$.length,ae=I%d,ce=I/d|0;for($=$.slice();Y--;)D=$[Y]%d,B=$[Y]/d|0,W=ce*D+B*ae,H=ae*D+W%d*d+F,F=(H/N|0)+(W/d|0)+ce*B,$[Y]=H%N;return F&&($=[F].concat($)),$}function R($,I,N,W){var H,D;if(N!=W)D=N>W?1:-1;else for(H=D=0;H<N;H++)if($[H]!=I[H]){D=$[H]>I[H]?1:-1;break}return D}function S($,I,N,W){for(var H=0;N--;)$[N]-=H,H=$[N]<I[N]?1:0,$[N]=H*W+$[N]-I[N];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,I,N,W,H){var D,B,F,Y,ae,ce,_e,Fe,ze,Me,Ve,_t,Ai,rs,ni,Pt,gn,bt=$.s==I.s?1:-1,xt=$.c,Be=I.c;if(!xt||!xt[0]||!Be||!Be[0])return new p(!$.s||!I.s||(xt?Be&&xt[0]==Be[0]:!Be)?NaN:xt&&xt[0]==0||!Be?bt*0:bt/0);for(Fe=new p(bt),ze=Fe.c=[],B=$.e-I.e,bt=N+B+1,H||(H=l,B=v($.e/u)-v(I.e/u),bt=bt/u|0),F=0;Be[F]==(xt[F]||0);F++);if(Be[F]>(xt[F]||0)&&B--,bt<0)ze.push(1),Y=!0;else{for(rs=xt.length,Pt=Be.length,F=0,bt+=2,ae=o(H/(Be[0]+1)),ae>1&&(Be=b(Be,ae,H),xt=b(xt,ae,H),Pt=Be.length,rs=xt.length),Ai=Pt,Me=xt.slice(0,Pt),Ve=Me.length;Ve<Pt;Me[Ve++]=0);gn=Be.slice(),gn=[0].concat(gn),ni=Be[0],Be[1]>=H/2&&ni++;do{if(ae=0,D=R(Be,Me,Pt,Ve),D<0){if(_t=Me[0],Pt!=Ve&&(_t=_t*H+(Me[1]||0)),ae=o(_t/ni),ae>1)for(ae>=H&&(ae=H-1),ce=b(Be,ae,H),_e=ce.length,Ve=Me.length;R(ce,Me,_e,Ve)==1;)ae--,S(ce,Pt<_e?gn:Be,_e,H),_e=ce.length,D=1;else ae==0&&(D=ae=1),ce=Be.slice(),_e=ce.length;if(_e<Ve&&(ce=[0].concat(ce)),S(Me,ce,Ve,H),Ve=Me.length,D==-1)for(;R(Be,Me,Pt,Ve)<1;)ae++,S(Me,Pt<Ve?gn:Be,Ve,H),Ve=Me.length}else D===0&&(ae++,Me=[0]);ze[F++]=ae,Me[0]?Me[Ve++]=xt[Ai]||0:(Me=[xt[Ai]],Ve=1)}while((Ai++<rs||Me[0]!=null)&&bt--);Y=Me[0]!=null,ze[0]||ze.splice(0,1)}if(H==l){for(F=1,bt=ze[0];bt>=10;bt/=10,F++);K(Fe,N+(Fe.e=F+B*u-1)+1,W,Y)}else Fe.e=B,Fe.r=+Y;return Fe}}();function A(b,R,S,$){var I,N,W,H,D;if(S==null?S=Q:C(S,0,8),!b.c)return b.toString();if(I=b.c[0],W=b.e,R==null)D=y(b.c),D=$==1||$==2&&(W<=te||W>=pe)?x(D,W):P(D,W,"0");else if(b=K(new p(b),R,S),N=b.e,D=y(b.c),H=D.length,$==1||$==2&&(R<=N||N<=te)){for(;H<R;D+="0",H++);D=x(D,N)}else if(R-=W,D=P(D,N,"0"),N+1>H){if(--R>0)for(D+=".";R--;D+="0");}else if(R+=N-H,R>0)for(N+1==H&&(D+=".");R--;D+="0");return b.s<0&&I?"-"+D:D}function L(b,R){for(var S,$,I=1,N=new p(b[0]);I<b.length;I++)$=new p(b[I]),(!$.s||(S=E(N,$))===R||S===0&&N.s===R)&&(N=$);return N}function j(b,R,S){for(var $=1,I=R.length;!R[--I];R.pop());for(I=R[0];I>=10;I/=10,$++);return(S=$+S*u-1)>Re?b.c=b.e=null:S<et?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,W,H,D){var B,F=H?W:W.replace(I,"");if($.test(F))N.s=isNaN(F)?null:F<0?-1:1;else{if(!H&&(F=F.replace(b,function(Y,ae,ce){return B=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!D||D==B?ae:Y}),D&&(B=D,F=F.replace(R,"$1").replace(S,"0.$1")),W!=F))return new p(F,B);if(p.DEBUG)throw Error(s+"Not a"+(D?" base "+D:"")+" number: "+W);N.s=null}N.c=N.e=null}}();function K(b,R,S,$){var I,N,W,H,D,B,F,Y=b.c,ae=h;if(Y){e:{for(I=1,H=Y[0];H>=10;H/=10,I++);if(N=R-I,N<0)N+=u,W=R,D=Y[B=0],F=o(D/ae[I-W-1]%10);else if(B=i((N+1)/u),B>=Y.length)if($){for(;Y.length<=B;Y.push(0));D=F=0,I=1,N%=u,W=N-u+1}else break e;else{for(D=H=Y[B],I=1;H>=10;H/=10,I++);N%=u,W=N-u+I,F=W<0?0:o(D/ae[I-W-1]%10)}if($=$||R<0||Y[B+1]!=null||(W<0?D:D%ae[I-W-1]),$=S<4?(F||$)&&(S==0||S==(b.s<0?3:2)):F>5||F==5&&(S==4||$||S==6&&(N>0?W>0?D/ae[I-W]:0:Y[B-1])%10&1||S==(b.s<0?8:7)),R<1||!Y[0])return Y.length=0,$?(R-=b.e+1,Y[0]=ae[(u-R%u)%u],b.e=-R||0):Y[0]=b.e=0,b;if(N==0?(Y.length=B,H=1,B--):(Y.length=B+1,H=ae[u-N],Y[B]=W>0?o(D/ae[I-W]%ae[W])*H:0),$)for(;;)if(B==0){for(N=1,W=Y[0];W>=10;W/=10,N++);for(W=Y[0]+=H,H=1;W>=10;W/=10,H++);N!=H&&(b.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[B]+=H,Y[B]!=l)break;Y[B--]=0,H=1}for(N=Y.length;Y[--N]===0;Y.pop());}b.e>Re?b.c=b.e=null:b.e<et&&(b.c=[b.e=0])}return b}function J(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=pe?x(R,S):P(R,S,"0"),b.s<0?"-"+R:R)}return V.absoluteValue=V.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},V.comparedTo=function(b,R){return E(this,new p(b,R))},V.decimalPlaces=V.dp=function(b,R){var S,$,I,N=this;if(b!=null)return C(b,0,f),R==null?R=Q:C(R,0,8),K(new p(N),b+N.e+1,R);if(!(S=N.c))return null;if($=((I=S.length-1)-v(this.e/u))*u,I=S[I])for(;I%10==0;I/=10,$--);return $<0&&($=0),$},V.dividedBy=V.div=function(b,R){return O(this,new p(b,R),ne,Q)},V.dividedToIntegerBy=V.idiv=function(b,R){return O(this,new p(b,R),0,1)},V.exponentiatedBy=V.pow=function(b,R){var S,$,I,N,W,H,D,B,F,Y=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+J(b));if(R!=null&&(R=new p(R)),H=b.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new p(Math.pow(+J(Y),H?b.s*(2-M(b)):+J(b))),R?F.mod(R):F;if(D=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);$=!D&&Y.isInteger()&&R.isInteger(),$&&(Y=Y.mod(R))}else{if(b.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||H&&Y.c[1]>=24e7:Y.c[0]<8e13||H&&Y.c[0]<=9999975e7)))return N=Y.s<0&&M(b)?-0:0,Y.e>-1&&(N=1/N),new p(D?1/N:N);Pn&&(N=i(Pn/u+2))}for(H?(S=new p(.5),D&&(b.s=1),B=M(b)):(I=Math.abs(+J(b)),B=I%2),F=new p(X);;){if(B){if(F=F.times(Y),!F.c)break;N?F.c.length>N&&(F.c.length=N):$&&(F=F.mod(R))}if(I){if(I=o(I/2),I===0)break;B=I%2}else if(b=b.times(S),K(b,b.e+1,1),b.e>14)B=M(b);else{if(I=+J(b),I===0)break;B=I%2}Y=Y.times(Y),N?Y.c&&Y.c.length>N&&(Y.c.length=N):$&&(Y=Y.mod(R))}return $?F:(D&&(F=X.div(F)),R?F.mod(R):N?K(F,Pn,Q,W):F)},V.integerValue=function(b){var R=new p(this);return b==null?b=Q:C(b,0,8),K(R,R.e+1,b)},V.isEqualTo=V.eq=function(b,R){return E(this,new p(b,R))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(b,R){return E(this,new p(b,R))>0},V.isGreaterThanOrEqualTo=V.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},V.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(b,R){return E(this,new p(b,R))<0},V.isLessThanOrEqualTo=V.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(b,R){var S,$,I,N,W=this,H=W.s;if(b=new p(b,R),R=b.s,!H||!R)return new p(NaN);if(H!=R)return b.s=-R,W.plus(b);var D=W.e/u,B=b.e/u,F=W.c,Y=b.c;if(!D||!B){if(!F||!Y)return F?(b.s=-R,b):new p(Y?W:NaN);if(!F[0]||!Y[0])return Y[0]?(b.s=-R,b):new p(F[0]?W:Q==3?-0:0)}if(D=v(D),B=v(B),F=F.slice(),H=D-B){for((N=H<0)?(H=-H,I=F):(B=D,I=Y),I.reverse(),R=H;R--;I.push(0));I.reverse()}else for($=(N=(H=F.length)<(R=Y.length))?H:R,H=R=0;R<$;R++)if(F[R]!=Y[R]){N=F[R]<Y[R];break}if(N&&(I=F,F=Y,Y=I,b.s=-b.s),R=($=Y.length)-(S=F.length),R>0)for(;R--;F[S++]=0);for(R=l-1;$>H;){if(F[--$]<Y[$]){for(S=$;S&&!F[--S];F[S]=R);--F[S],F[$]+=l}F[$]-=Y[$]}for(;F[0]==0;F.splice(0,1),--B);return F[0]?j(b,F,B):(b.s=Q==3?-1:1,b.c=[b.e=0],b)},V.modulo=V.mod=function(b,R){var S,$,I=this;return b=new p(b,R),!I.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||I.c&&!I.c[0]?new p(I):(st==9?($=b.s,b.s=1,S=O(I,b,0,3),b.s=$,S.s*=$):S=O(I,b,0,st),b=I.minus(S.times(b)),!b.c[0]&&st==1&&(b.s=I.s),b)},V.multipliedBy=V.times=function(b,R){var S,$,I,N,W,H,D,B,F,Y,ae,ce,_e,Fe,ze,Me=this,Ve=Me.c,_t=(b=new p(b,R)).c;if(!Ve||!_t||!Ve[0]||!_t[0])return!Me.s||!b.s||Ve&&!Ve[0]&&!_t||_t&&!_t[0]&&!Ve?b.c=b.e=b.s=null:(b.s*=Me.s,!Ve||!_t?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=v(Me.e/u)+v(b.e/u),b.s*=Me.s,D=Ve.length,Y=_t.length,D<Y&&(_e=Ve,Ve=_t,_t=_e,I=D,D=Y,Y=I),I=D+Y,_e=[];I--;_e.push(0));for(Fe=l,ze=d,I=Y;--I>=0;){for(S=0,ae=_t[I]%ze,ce=_t[I]/ze|0,W=D,N=I+W;N>I;)B=Ve[--W]%ze,F=Ve[W]/ze|0,H=ce*B+F*ae,B=ae*B+H%ze*ze+_e[N]+S,S=(B/Fe|0)+(H/ze|0)+ce*F,_e[N--]=B%Fe;_e[N]=S}return S?++$:_e.splice(0,1),j(b,_e,$)},V.negated=function(){var b=new p(this);return b.s=-b.s||null,b},V.plus=function(b,R){var S,$=this,I=$.s;if(b=new p(b,R),R=b.s,!I||!R)return new p(NaN);if(I!=R)return b.s=-R,$.minus(b);var N=$.e/u,W=b.e/u,H=$.c,D=b.c;if(!N||!W){if(!H||!D)return new p(I/0);if(!H[0]||!D[0])return D[0]?b:new p(H[0]?$:I*0)}if(N=v(N),W=v(W),H=H.slice(),I=N-W){for(I>0?(W=N,S=D):(I=-I,S=H),S.reverse();I--;S.push(0));S.reverse()}for(I=H.length,R=D.length,I-R<0&&(S=D,D=H,H=S,R=I),I=0;R;)I=(H[--R]=H[R]+D[R]+I)/l|0,H[R]=l===H[R]?0:H[R]%l;return I&&(H=[I].concat(H),++W),j(b,H,W)},V.precision=V.sd=function(b,R){var S,$,I,N=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=Q:C(R,0,8),K(new p(N),b,R);if(!(S=N.c))return null;if(I=S.length-1,$=I*u+1,I=S[I]){for(;I%10==0;I/=10,$--);for(I=S[0];I>=10;I/=10,$++);}return b&&N.e+1>$&&($=N.e+1),$},V.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},V.squareRoot=V.sqrt=function(){var b,R,S,$,I,N=this,W=N.c,H=N.s,D=N.e,B=ne+4,F=new p("0.5");if(H!==1||!W||!W[0])return new p(!H||H<0&&(!W||W[0])?NaN:W?N:1/0);if(H=Math.sqrt(+J(N)),H==0||H==1/0?(R=y(W),(R.length+D)%2==0&&(R+="0"),H=Math.sqrt(+R),D=v((D+1)/2)-(D<0||D%2),H==1/0?R="5e"+D:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+D),S=new p(R)):S=new p(H+""),S.c[0]){for(D=S.e,H=D+B,H<3&&(H=0);;)if(I=S,S=F.times(I.plus(O(N,I,B,1))),y(I.c).slice(0,H)===(R=y(S.c)).slice(0,H))if(S.e<D&&--H,R=R.slice(H-3,H+1),R=="9999"||!$&&R=="4999"){if(!$&&(K(I,I.e+ne+2,0),I.times(I).eq(N))){S=I;break}B+=4,H+=4,$=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(K(S,S.e+ne+2,1),b=!S.times(S).eq(N));break}}return K(S,S.e+ne+1,Q,b)},V.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),A(this,b,R,1)},V.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),A(this,b,R)},V.toFormat=function(b,R,S){var $,I=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=at;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if($=I.toFixed(b,R),I.c){var N,W=$.split("."),H=+S.groupSize,D=+S.secondaryGroupSize,B=S.groupSeparator||"",F=W[0],Y=W[1],ae=I.s<0,ce=ae?F.slice(1):F,_e=ce.length;if(D&&(N=H,H=D,D=N,_e-=N),H>0&&_e>0){for(N=_e%H||H,F=ce.substr(0,N);N<_e;N+=H)F+=B+ce.substr(N,H);D>0&&(F+=B+ce.slice(N)),ae&&(F="-"+F)}$=Y?F+(S.decimalSeparator||"")+((D=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+$+(S.suffix||"")},V.toFraction=function(b){var R,S,$,I,N,W,H,D,B,F,Y,ae,ce=this,_e=ce.c;if(b!=null&&(H=new p(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(X)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+J(H));if(!_e)return new p(ce);for(R=new p(X),B=S=new p(X),$=D=new p(X),ae=y(_e),N=R.e=ae.length-ce.e-1,R.c[0]=h[(W=N%u)<0?u+W:W],b=!b||H.comparedTo(R)>0?N>0?R:B:H,W=Re,Re=1/0,H=new p(ae),D.c[0]=0;F=O(H,R,0,1),I=S.plus(F.times($)),I.comparedTo(b)!=1;)S=$,$=I,B=D.plus(F.times(I=B)),D=I,R=H.minus(F.times(I=R)),H=I;return I=O(b.minus(S),$,0,1),D=D.plus(I.times(B)),S=S.plus(I.times($)),D.s=B.s=ce.s,N=N*2,Y=O(B,$,N,Q).minus(ce).abs().comparedTo(O(D,S,N,Q).minus(ce).abs())<1?[B,$]:[D,S],Re=W,Y},V.toNumber=function(){return+J(this)},V.toPrecision=function(b,R){return b!=null&&C(b,1,f),A(this,b,R,2)},V.toString=function(b){var R,S=this,$=S.s,I=S.e;return I===null?$?(R="Infinity",$<0&&(R="-"+R)):R="NaN":(b==null?R=I<=te||I>=pe?x(y(S.c),I):P(y(S.c),I,"0"):b===10&&w?(S=K(new p(S),ne+I+1,Q),R=P(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=G(P(y(S.c),I,"0"),10,b,$,!0)),$<0&&S.c[0]&&(R="-"+R)),R},V.valueOf=V.toJSON=function(){return J(this)},V._isBigNumber=!0,T!=null&&p.set(T),p}function v(T){var O=T|0;return T>0||T===O?O:O-1}function y(T){for(var O,G,U=1,V=T.length,X=T[0]+"";U<V;){for(O=T[U++]+"",G=u-O.length;G--;O="0"+O);X+=O}for(V=X.length;X.charCodeAt(--V)===48;);return X.slice(0,V+1||1)}function E(T,O){var G,U,V=T.c,X=O.c,ne=T.s,Q=O.s,te=T.e,pe=O.e;if(!ne||!Q)return null;if(G=V&&!V[0],U=X&&!X[0],G||U)return G?U?0:-Q:ne;if(ne!=Q)return ne;if(G=ne<0,U=te==pe,!V||!X)return U?0:!V^G?1:-1;if(!U)return te>pe^G?1:-1;for(Q=(te=V.length)<(pe=X.length)?te:pe,ne=0;ne<Q;ne++)if(V[ne]!=X[ne])return V[ne]>X[ne]^G?1:-1;return te==pe?0:te>pe^G?1:-1}function C(T,O,G,U){if(T<O||T>G||T!==o(T))throw Error(s+(U||"Argument")+(typeof T=="number"?T<O||T>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function M(T){var O=T.c.length-1;return v(T.e/u)==O&&T.c[O]%2!=0}function x(T,O){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(O<0?"e":"e+")+O}function P(T,O,G){var U,V;if(O<0){for(V=G+".";++O;V+=G);T=V+T}else if(U=T.length,++O>U){for(V=G,O-=U;--O;V+=G);T+=V}else O<U&&(T=T.slice(0,O)+"."+T.slice(O));return T}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(bae)})(bL);var SL=bL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ji=e_(),jae=ZM(),Uae=QM,zae=SL,kn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Sg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:RL,decimalSuffixes:Hw}=ji.currentBytes(),t_={general:{scale:1024,suffixes:Hw},binary:{scale:1024,suffixes:RL},decimal:{scale:1e3,suffixes:Hw}};function Yae(t,e={},n){if(typeof e=="string"&&(e=Uae.parseFormat(e)),!jae.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Gae(t,e,n);return s=dle(s,i),s=fle(s,o),s}function Gae(t,e,n){switch(e.output){case"currency":return e=Cc(e,ji.currentCurrencyDefaultFormat()),tle(t,e,ji);case"percent":return e=Cc(e,ji.currentPercentageDefaultFormat()),ele(t,e,ji,n);case"byte":return e=Cc(e,ji.currentByteDefaultFormat()),Jae(t,e,ji,n);case"time":return e=Cc(e,ji.currentTimeDefaultFormat()),Qae(t);case"ordinal":return e=Cc(e,ji.currentOrdinalDefaultFormat()),Zae(t,e,ji);case"number":default:return Rg({instance:t,providedFormat:e})}}function Kae(t){let e=t_.decimal;return ry(t._value,e.suffixes,e.scale).suffix}function qae(t){let e=t_.binary;return ry(t._value,e.suffixes,e.scale).suffix}function Xae(t){let e=t_.general;return ry(t._value,e.suffixes,e.scale).suffix}function ry(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function Jae(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Sg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Hw,marker:"bd"},binary:{scale:1024,suffixes:s||RL,marker:"b"},decimal:{scale:1e3,suffixes:a||Hw,marker:"d"}}[i],{value:c,suffix:h}=ry(t._value,u.suffixes,u.scale);return`${Rg({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function Zae(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Sg,e),o=Rg({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function Qae(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function ele(t,e,n,r){let i=e.prefixSymbol,o=Rg({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Sg,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function tle(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Sg,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Rg({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function nle({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&kn[e]?(a=r[e],t=t/kn[e]):l>=kn.trillion||n&&s(l/kn.trillion)===1?(a=r.trillion,t=t/kn.trillion):l<kn.trillion&&l>=kn.billion||n&&s(l/kn.billion)===1?(a=r.billion,t=t/kn.billion):l<kn.billion&&l>=kn.million||n&&s(l/kn.million)===1?(a=r.million,t=t/kn.million):(l<kn.million&&l>=kn.thousand||n&&s(l/kn.thousand)===1)&&(a=r.thousand,t=t/kn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function rle({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function _m(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function ile(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+_m(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(_m(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=_m(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${_m(e)}`),n}function ole(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?ile(t,e):new zae(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function sle(t,e,n,r,i,o){if(r===-1)return t;let s=ole(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function ale(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function lle(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function ule(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),lle(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function cle(t,e){return t+e}function hle(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function dle(t,e){return e+t}function fle(t,e){return t+e}function Rg({instance:t,providedFormat:e,state:n=ji,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Sg,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,M=s.forceSign,x=s.exponential,P=s.roundingFunction,T="";if(d){let G=nle({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:P,totalLength:a});o=G.value,T+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(x){let G=rle({value:o,characteristicPrecision:l});o=G.value,T=G.abbreviation+T}let O=sle(o.toString(),o,g,f,v,P);return O=ale(O,o,u,l),O=ule(O,o,y,n,r),(d||x)&&(O=cle(O,T)),(M||o<0)&&(O=hle(O,o,C)),O}function Cc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var gle=t=>({format:(...e)=>Yae(...e,t),getByteUnit:(...e)=>Xae(...e,t),getBinaryByteUnit:(...e)=>qae(...e,t),getDecimalByteUnit:(...e)=>Kae(...e,t),formatOrDefault:Cc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ws=SL;function mle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.plus(i).toNumber(),t}function EL(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.minus(i).toNumber(),t}function ple(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.times(i).toNumber(),t}function wle(t,e,n){let r=new Ws(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ws(i),t._value=r.dividedBy(i).toNumber(),t}function vle(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function yle(t,e,n){let r=n(t._value);return EL(r,e,n),Math.abs(r._value)}var Cle=t=>({add:(e,n)=>mle(e,n,t),subtract:(e,n)=>EL(e,n,t),multiply:(e,n)=>ple(e,n,t),divide:(e,n)=>wle(e,n,t),set:(e,n)=>vle(e,n,t),difference:(e,n)=>yle(e,n,t),BigNumber:Ws});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ble="2.5.0",ns=e_(),Sle=ZM(),Rle=Wae(tn),Ele=CL();let hl=gle(tn),Wl=Cle(tn);const Tle=QM;class TL{constructor(e){this._value=e}clone(){return tn(this._value)}format(e={}){return hl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Tle.parseFormat(e)),e=hl.formatOrDefault(e,ns.currentCurrencyDefaultFormat()),e.output="currency",hl.format(this,e)}formatTime(e={}){return e.output="time",hl.format(this,e)}binaryByteUnits(){return hl.getBinaryByteUnit(this)}decimalByteUnits(){return hl.getDecimalByteUnit(this)}byteUnits(){return hl.getByteUnit(this)}difference(e){return Wl.difference(this,e)}add(e){return Wl.add(this,e)}subtract(e){return Wl.subtract(this,e)}multiply(e){return Wl.multiply(this,e)}divide(e){return Wl.divide(this,e)}set(e){return Wl.set(this,ML(e))}value(){return this._value}valueOf(){return this._value}}function ML(t){let e=t;return tn.isNumbro(t)?e=t._value:typeof t=="string"?e=tn.unformat(t):isNaN(t)&&(e=NaN),e}function tn(t){return new TL(ML(t))}tn.version=ble;tn.isNumbro=function(t){return t instanceof TL};tn.language=ns.currentLanguage;tn.registerLanguage=ns.registerLanguage;tn.setLanguage=ns.setLanguage;tn.languages=ns.languages;tn.languageData=ns.languageData;tn.zeroFormat=ns.setZeroFormat;tn.defaultFormat=ns.currentDefaults;tn.setDefaults=ns.setDefaults;tn.defaultCurrencyFormat=ns.currentCurrencyDefaultFormat;tn.validate=Sle.validate;tn.loadLanguagesInNode=Rle.loadLanguagesInNode;tn.unformat=Ele.unformat;tn.BigNumber=Wl.BigNumber;var Mle=tn,dl=Sae(Mle);const _le="numeric";function _L(t,e){if(Gn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!dl.languages()[r]){const o=r.replace("-",""),s=dl.allLanguages?dl.allLanguages[r]:dl[o];s&&dl.registerLanguage(s)}dl.setLanguage(r),t=dl(t).format(i||"0")}return t}function n_(t,e,n,r,i,o,s){let a=o;if(Gn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=_L(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Js(t,e,n,r,i,a,s)}n_.RENDERER_TYPE=_le;const Ple="password";function r_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),xu(e,u)}r_.RENDERER_TYPE=Ple;const xle="select";function i_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s])}i_.RENDERER_TYPE=xle;const Ile="time";function o_(t,e,n,r,i,o,s){Js.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}o_.RENDERER_TYPE=Ile;function Ole(){Wr(Ch),Wr(bg),Wr(qM),Wr(KM),Wr(JM),Wr(GM),Wr(n_),Wr(r_),Wr(i_),Wr(Js),Wr(o_)}const Ale="autocomplete";function iy(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,NO(n,e)):NO(n,e)(this.source):e(!0)}iy.VALIDATOR_TYPE=Ale;function NO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function PL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Hle=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:PL},Symbol.toStringTag,{value:"Module"})),Nle="date";function s_(t,e){const n=t$(dL,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Dle(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}s_.VALIDATOR_TYPE=Nle;function Dle(t,e){const n=Z(PL(t)),r=Z(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const kle="dropdown";function a_(t,e){iy.apply(this,[t,e])}a_.VALIDATOR_TYPE=kle;const $le="numeric";function l_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Gn(t))}l_.VALIDATOR_TYPE=$le;const Lle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Fle="time";function u_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,Lle,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}u_.VALIDATOR_TYPE=Fle;function Vle(){Gl(iy),Gl(a_),Gl(s_),Gl(l_),Gl(u_)}const Ble="autocomplete",Wle={CELL_TYPE:Ble,editor:zM,renderer:Ch,validator:iy},jle="checkbox",Ule={CELL_TYPE:jle,editor:hL,renderer:qM},zle="date";function xL(t,e,n,r,i,o,s){Ch.apply(this,[t,e,n,r,i,o,s])}xL.RENDERER_TYPE=zle;const Yle="date",Gle={CELL_TYPE:Yle,editor:fL,renderer:xL,validator:s_},Kle="dropdown",qle={CELL_TYPE:Kle,editor:gL,renderer:KM,validator:a_,filter:!1,strict:!0},Xle="handsontable",Jle={CELL_TYPE:Xle,editor:UM,renderer:JM},Zle="numeric",Qle={CELL_TYPE:Zle,editor:mL,renderer:n_,validator:l_,dataType:"number"},eue="password",tue={CELL_TYPE:eue,editor:pL,renderer:r_,copyable:!1},nue="select",rue={CELL_TYPE:nue,editor:wL,renderer:i_},iue="time",oue={CELL_TYPE:iue,editor:vL,renderer:o_,validator:u_};function sue(){ci(Wle),ci(Ule),ci(Gle),ci(qle),ci(Jle),ci(Qle),ci(tue),ci(rue),ci(uL),ci(oue)}function aue(t,e){IL(t,e),e.add(t)}function lue(t,e,n){IL(t,e),e.set(t,n)}function IL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(t,e,n){return(e=uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uue(t){var e=cue(t,"string");return typeof e=="symbol"?e:e+""}function cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gu(t,e){return t.get(OL(t,e))}function OL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DO=new Map([["plugin",wQ],["cell-type",Q$],["editor",e$],["renderer",c$],["validator",h$]]),AL=Symbol("mainSetting"),hue="base",Pm=[];let fl=null;var gl=new WeakMap,kO=new WeakSet;class qe{static get PLUGIN_KEY(){return hue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){aue(this,kO),Yu(this,"eventManager",new Ei(this)),Yu(this,"pluginName",null),Yu(this,"pluginsInitializedCallbacks",[]),Yu(this,"isPluginsReady",!1),Yu(this,"enabled",!1),Yu(this,"initialized",!1),lue(this,gl,{}),ts(this,"hot",e,{writable:!1}),fl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!DO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);DO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Pm.push(o)}}if(fl||(fl=GE()),fl.indexOf(this.pluginName)>=0&&fl.splice(fl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),fl.length===0){if(Pm.length>0){const i=[`${Pm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Pm.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||De(n))&&r[AL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(De(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Gu(gl,this)[e]=Gu(gl,this)[e]||[];const i=Gu(gl,this)[e];this.hot.addHook(e,n,r),i.push(n),Gu(gl,this)[e]=i}removeHooks(e){_(Gu(gl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Gu(gl,this);ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){_(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=OL(kO,this,due).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function due(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ml(t,e,n){return(e=fue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fue(t){var e=gue(t,"string");return typeof e=="symbol"?e:e+""}function gue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let c_=class{constructor(e){ml(this,"hot",null),ml(this,"container",null),ml(this,"injected",!1),ml(this,"rows",[]),ml(this,"columns",[]),ml(this,"samples",null),ml(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),_(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),_(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{_(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{_(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{_(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),_(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{_(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function xm(t,e,n){return(e=mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mue(t){var e=pue(t,"string");return typeof e=="symbol"?e:e+""}function pue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oy{static get SAMPLE_COUNT(){return 3}constructor(e){xm(this,"samples",null),xm(this,"dataFactory",null),xm(this,"customSampleCount",null),xm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:oy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Tt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function wue(t,e){HL(t,e),e.add(t)}function lb(t,e,n){HL(t,e),e.set(t,n)}function HL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function td(t,e,n){return(e=vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vue(t){var e=yue(t,"string");return typeof e=="symbol"?e:e+""}function yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e){return t.get(xr(t,e))}function Nw(t,e,n){return t.set(xr(t,e),n),n}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const ub="autoColumnSize",Cue=10,bue="autoColumnSize";var h_=new WeakMap,bc=new WeakMap,nh=new WeakMap,jr=new WeakSet;class Qd extends qe{static get PLUGIN_KEY(){return ub}static get PLUGIN_PRIORITY(){return Cue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),wue(this,jr),td(this,"ghostTable",new c_(this.hot)),td(this,"samplesGenerator",new oy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),td(this,"inProgress",!1),td(this,"measuredColumns",0),td(this,"columnWidthsMap",new qa),lb(this,h_,!1),lb(this,bc,[]),lb(this,nh,[]),this.hot.columnIndexMapper.registerMap(bue,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>xr(jr,this,$O).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[ub]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,Eue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,Tue).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xr(jr,e,_ue).call(e,...i)}),this.addHook("beforeRender",()=>xr(jr,this,Rue).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>xr(jr,this,Mue).call(this)),super.enablePlugin()}updatePlugin(){Nw(nh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>xr(jr,this,$O).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&xr(jr,this,NL).call(this,s,o)}),this.ghostTable.columns.length&&(xr(jr,this,DL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Of(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Qd.CALCULATION_STEP,i)},e,n),r=r+Qd.CALCULATION_STEP+1,r<i?o=If(s):(Of(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ub];let n=Qd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return De(e)&&(n=e.syncLimit,bE(n)?n=zE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Zc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Oa(bc,this).length;return(s-1<o||Oa(bc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Oa(bc,this).push(i):Oa(bc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Sue(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||xr(jr,this,NL).call(this,n,e))}),this.ghostTable.columns.length&&(xr(jr,this,DL).call(this),this.ghostTable.clean())}function NL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function DL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Rue(){this.calculateVisibleColumnsWidth(),this.inProgress||(xr(jr,this,Sue).call(this,Oa(nh,this)),Nw(nh,this,[]))}function Eue(t,e){e||this.recalculateAllColumnsWidth()}function Tue(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Oa(nh,this).push(...e)}function $O(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Mue(){Nw(bc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Nw(h_,this,!0)}function _ue(t){if(!Oa(h_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Oa(nh,this).push(...e)}const Xl={horizontal:"horizontal",vertical:"vertical"};function Pue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function xue(t){const e={};return t===!0?(e.directions=Object.keys(Xl),e.autoInsertRow=!0):De(t)?(le(t.autoInsertRow)?t.direction===Xl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Xl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Iue(t,e){Oue(t,e),e.add(t)}function Oue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){return(e=Aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aue(t){var e=Hue(t,"string");return typeof e=="symbol"?e:e+""}function Hue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const LO="autofill",Nue=20,Due=["fillHandle"],kue="insert_row_below",$ue=200;var qu=new WeakSet;class Lue extends qe{constructor(){super(...arguments),Iue(this,qu),Ku(this,"addingStarted",!1),Ku(this,"mouseDownOnCellCorner",!1),Ku(this,"mouseDragOutside",!1),Ku(this,"handleDraggedCells",0),Ku(this,"directions",[]),Ku(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return LO}static get PLUGIN_PRIORITY(){return Nue}static get SETTING_KEYS(){return[LO,...Due]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>nd(qu,this,Vue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>nd(qu,this,Fue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>nd(qu,this,Bue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return _(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),_(a,c=>{const h=[];_(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Pue(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),v=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const M=d.row-h.row+1,x=M%C.length;for(let P=0;P<M;P++)E.push(C[(P+(C.length-x))%C.length])}else{const M=d.col-h.col+1,x=M%C[0].length;for(let P=0;P<C.length;P++){E.push([]);for(let T=0;T<M;T++)E[P].push(C[P][(T+(C[P].length-x))%C[P].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Xl.vertical)&&this.directions.includes(Xl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Xl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Xl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(kue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},$ue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Yt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Yt(s)||!Yt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Ln(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+un(this.hot.table),i=Ln(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>nd(qu,this,Wue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>nd(qu,this,jue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=xue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Fue(){this.selectAdjacent()&&this.fillIn()}function Vue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Bue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Wue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function jue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Uue(t,e){kL(t,e),e.add(t)}function FO(t,e,n){kL(t,e),e.set(t,n)}function kL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xu(t,e,n){return(e=zue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zue(t){var e=Yue(t,"string");return typeof e=="symbol"?e:e+""}function Yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $L(t,e,n){return t.set(ko(t,e),n),n}function Dw(t,e){return t.get(ko(t,e))}function ko(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cb="autoRowSize",Gue=40,Kue="autoRowSize";var kf=new WeakMap,d_=new WeakMap,Cs=new WeakSet;class ef extends qe{static get PLUGIN_KEY(){return cb}static get PLUGIN_PRIORITY(){return Gue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Uue(this,Cs),Xu(this,"headerHeight",null),Xu(this,"ghostTable",new c_(this.hot)),Xu(this,"samplesGenerator",new oy((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Xu(this,"inProgress",!1),Xu(this,"measuredRows",0),Xu(this,"rowHeightsMap",new qa),FO(this,kf,[]),FO(this,d_,!1),this.hot.rowIndexMapper.registerMap(Kue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>ko(Cs,this,VO).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[cb];return e===!0||De(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,Jue).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,Zue).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ko(Cs,e,ece).call(e,...i)}),this.addHook("beforeRender",()=>ko(Cs,this,Xue).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>ko(Cs,this,Que).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>ko(Cs,this,VO).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Of(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+ef.CALCULATION_STEP,i)},e,n),r=r+ef.CALCULATION_STEP+1,r<i?o=If(s):(Of(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[cb];let n=ef.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return De(e)&&(n=e.syncLimit,bE(n)?n=zE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function que(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Xue(){this.calculateVisibleRowsHeight(),this.inProgress||(ko(Cs,this,que).call(this,Dw(kf,this)),$L(kf,this,[]))}function VO(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Jue(t,e){e||this.recalculateAllRowsHeight()}function Zue(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Dw(kf,this).push(...e)}function Que(){this.recalculateAllRowsHeight(),$L(d_,this,!0)}function ece(t){if(!Dw(d_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Dw(kf,this).push(...e)}const{getListWithInsertedItems:tce,getListWithRemovedItems:nce}=D$("physicallyIndexed");class rce extends Iu{constructor(){super(e=>e)}insert(e,n){const r=vT(this.indexedValues,n);this.indexedValues=tce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=nce(this.indexedValues,e);this.indexedValues=wT(n,e),super.remove(e)}}const{getListWithInsertedItems:ice,getListWithRemovedItems:oce}=D$("physicallyIndexed");class sce extends Iu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=ice(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=oce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function ace(t,e){lce(t,e),e.add(t)}function lce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uce(t,e,n){return(e=cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cce(t){var e=hce(t,"string");return typeof e=="symbol"?e:e+""}function hce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BO="bindRowsWithHeaders",fce=210,gce="loose",WO=new Map([["loose",rce],["strict",sce]]);var jO=new WeakSet;class mce extends qe{constructor(){super(...arguments),ace(this,jO),uce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return BO}static get PLUGIN_PRIORITY(){return fce}isEnabled(){return!!this.hot.getSettings()[BO]}enablePlugin(){var e;if(this.enabled)return;const n=(e=WO.get(this.getSetting()))!==null&&e!==void 0?e:WO.get(gce);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>dce(jO,this,pce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function pce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function wce(t,e){LL(t,e),e.add(t)}function vce(t,e,n){LL(t,e),e.set(t,n)}function LL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UO(t,e,n){return(e=yce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yce(t){var e=Cce(t,"string");return typeof e=="symbol"?e:e+""}function Cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zO(t,e){return t.get(Ic(t,e))}function hb(t,e,n){return t.set(Ic(t,e),n),n}function Ic(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vp="collapsibleColumns",bce=290,Sce=["nestedHeaders"],jc="collapsibleIndicator",YO=Vp,GO=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ju=new WeakMap,rd=new WeakSet;class Rce extends qe{constructor(){super(...arguments),wce(this,rd),UO(this,"nestedHeadersPlugin",null),UO(this,"headerStateManager",null),vce(this,Ju,null)}static get PLUGIN_KEY(){return Vp}static get PLUGIN_PRIORITY(){return bce}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Vp,...Sce]}isEnabled(){return!!this.hot.getSettings()[Vp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||nt("You need to configure the Nested Headers plugin in order to use collapsible headers."),hb(Ju,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ic(rd,this,Mce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ic(rd,e,_ce).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ic(rd,e,Ece).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ic(rd,this,Tce).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hb(Ju,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:YO,relativeToGroup:Xa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(YO)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${jc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${jc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${jc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!GO.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ba(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;_(r,f=>{var g;let{row:v,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(v,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&_(r,f=>{let{row:g,col:v}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,v);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=hk([...a,...s]):n==="expand"&&(l=Ba(a,f=>!s.includes(f)));const u=GO.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){_(o,f=>{f()});return}this.hot.batchExecution(()=>{_(s,f=>{zO(Ju,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return zO(Ju,this).getHiddenIndexes()}destroy(){hb(Ju,this,null),super.destroy()}}function Ece(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${jc}`);if(Pu(e,[bi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,jc),e.querySelector("div:first-child").appendChild(u)),we(u,["collapsed","expanded"]),s?(q(u,"collapsed"),ja(u,"+"),l&&be(e,...bi(!1))):(q(u,"expanded"),ja(u,"-"),l&&be(e,...bi(!0))),l&&be(u,..._u());else{var c;(c=u)===null||c===void 0||c.remove()}}function Tce(t,e){ve(t.target,jc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ii(t))}function Mce(){this.updatePlugin()}function _ce(t,e){e||this.updatePlugin()}function pl(t,e,n){return(e=Pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pce(t){var e=xce(t,"string");return typeof e=="symbol"?e:e+""}function xce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ice=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Oce=!1,Ace=!0,Hce=!0;class Nce{constructor(e,n){pl(this,"hot",void 0),pl(this,"sortingStates",new Xv),pl(this,"sortEmptyCells",Oce),pl(this,"indicator",Ace),pl(this,"headerAction",Hce),pl(this,"compareFunctionFactory",void 0),pl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&ke(e,(n,r)=>{Ice.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function FL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Yo:Yt(i)?Yt(o)?Yo:s&&t==="asc"?Ut:zt:Yt(o)?s&&t==="asc"?zt:Ut:isNaN(i)&&!isNaN(o)?t==="asc"?zt:Ut:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ut:zt:i>o?t==="asc"?zt:Ut:Yo}}const VL="default";function Dce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Yo;if(a){if(Yt(r))return t==="asc"?Ut:zt;if(Yt(i))return t==="asc"?zt:Ut}return isNaN(o)?zt:isNaN(s)?Ut:o<s?t==="asc"?Ut:zt:o>s?t==="asc"?zt:Ut:Yo}}const kce="numeric";function $ce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Yt(s),u=Yt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return zt;if(l===!1&&u)return Ut}return d===!1&&f?t==="asc"?Ut:zt:d&&f===!1?t==="asc"?zt:Ut:d===!1&&f===!1?FL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ut:zt:c===r&&h===i?t==="asc"?zt:Ut:Yo}}const Lce="checkbox";function Fce(t,e,n){return YL(t,e.dateFormat,n)}const Vce="date";function Bce(t,e,n){return YL(t,e.timeFormat,n)}const Wce="time",{register:Eg,getItem:KO,hasItem:jce}=lo("sorting.compareFunctionFactory"),{register:BL,getItem:Uce}=lo("sorting.mainSortComparator");function WL(t){return jce(t)?KO(t):KO(VL)}Eg(Lce,$ce);Eg(Vce,Fce);Eg(VL,FL);Eg(kce,Dce);Eg(Wce,Bce);const Yo=0,Ut=-1,zt=1;function zce(t,e){const n=Uce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const kw="asc",$w="desc",jL="colHeader";function Yce(t){if(De(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[kw,$w].includes(n)}function Gce(t){if(t.some(n=>Yce(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function qO(t){if(t!==$w)return t===kw?$w:kw}function UL(t){return t.querySelector(`.${jL}`)}function zL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function f_(t,e,n){return t===-1&&e>=0&&Ua(n)===!1}function YL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Yo;if(Yt(r))return Yt(i)?Yo:o&&t==="asc"?Ut:zt;if(Yt(i))return o&&t==="asc"?zt:Ut;const s=Z(r,e),a=Z(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Ut:zt:a.isBefore(s)?t==="asc"?zt:Ut:Yo:Ut:zt}}function Kce(t,e){nt(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const qce="ascending",Xce="descending",GL="indicatorDisabled",KL="columnSorting",qL="sortAction",XL=new Map([[kw,qce],[$w,Xce]]);function Jce(t,e,n,r){const i=[KL];if(r&&i.push(qL),n===!1)return i.push(GL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(XL.get(o)),i}function Zce(){return Array.from(XL.values()).concat(qL,GL,KL)}function Qce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:WL(u.type))(l,u,d)(c,h)}(0)}}function ehe(t,e){the(t,e),e.add(t)}function the(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Im(t,e,n){return(e=nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nhe(t){var e=rhe(t,"string");return typeof e=="symbol"?e:e+""}function rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lw="columnSorting",ihe=50,Fw="append",ohe="replace",XO=Lw;BL(Lw,Qce);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const id=new WeakMap;var jl=new WeakSet;class JL extends qe{constructor(){super(...arguments),ehe(this,jl),Im(this,"columnStatesManager",null),Im(this,"columnMetaCache",null),Im(this,"pluginKey",Lw),Im(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Lw}static get PLUGIN_PRIORITY(){return ihe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(id.has(this.hot)&&id.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),Kce(id.get(this.hot),this.pluginKey);return}this.enabled||(id.set(this.hot,this.pluginKey),this.columnStatesManager=new Nce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new qa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Sc(jl,this,she).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sc(jl,e,lhe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Sc(jl,this,LR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sc(jl,e,ahe).call(e,...r)}),this.hot.view&&Sc(jl,this,LR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=UL(r);zL(n,r)===!1||i===null||this.updateHeaderClasses(i)};id.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Xa,position:"before",group:XO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XO)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new k$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Gce(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=qO(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:qO()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ht(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Fw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===ohe)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(De(e)){const n=e[this.pluginKey];if(De(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ut(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);zce(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||De(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(we(e,Zce()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,Jce(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,jL)}onAfterOnCellMouseDown(e,n){if(f_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function LR(){const t=this.getAllSavedSortSettings();if(De(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function she(t,e){const n=UL(e);if(zL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);be(e,...H8(s?`${s}ending`:"none"))}}function ahe(t){t===!0&&this.hot.view&&Sc(jl,this,LR).call(this)}function lhe(t,e,n,r){f_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function wl(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hhe{constructor(e,n){wl(this,"plugin",void 0),wl(this,"hot",void 0),wl(this,"endpoints",[]),wl(this,"settings",void 0),wl(this,"settingsType","array"),wl(this,"currentEndpoint",null),wl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),_(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();_(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;_(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?_(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):_(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){_(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];_(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),_(i,o=>{let s=[];_(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,r=>{_(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],_(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],_(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],_(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&_(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),_(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){nt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function db(t){return t==null||isNaN(t)}function dhe(t,e){fhe(t,e),e.add(t)}function fhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ghe(t,e,n){return(e=mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mhe(t){var e=phe(t,"string");return typeof e=="symbol"?e:e+""}function phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Om(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fb="columnSummary",whe=220;var od=new WeakSet;class vhe extends qe{constructor(){super(...arguments),dhe(this,od),ghe(this,"endpoints",null)}static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return whe}isEnabled(){return!!this.hot.getSettings()[fb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[fb],this.endpoints=new hhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(od,e,yhe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(od,e,bhe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(od,e,Che).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(od,e,She).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=db(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=db(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=db(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function yhe(){this.endpoints.initEndpoints()}function Che(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function bhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function She(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Rhe(t,e){ZL(t,e),e.add(t)}function gb(t,e,n){ZL(t,e),e.set(t,n)}function ZL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rc(t,e){return t.get(g_(t,e))}function FR(t,e,n){return t.set(g_(t,e),n),n}function g_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vw=new WeakMap,Am=new WeakMap,Hm=new WeakMap,JO=new WeakSet;class QL{constructor(){Rhe(this,JO),gb(this,Vw,!0),gb(this,Am,null),gb(this,Hm,new ResizeObserver(e=>g_(JO,this,Ehe).call(this,e)))}setObservedElement(e){FR(Am,this,e)}unobserve(){Rc(Hm,this).unobserve(Rc(Am,this))}observe(){FR(Vw,this,!0),Rc(Hm,this).observe(Rc(Am,this))}destroy(){Rc(Hm,this).disconnect()}}function Ehe(t){if(Rc(Vw,this)||!Array.isArray(t)||!t.length){FR(Vw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}mt(QL,Fn);function vl(t,e,n){The(t,e),e.set(t,n)}function The(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(eF(t,e))}function fs(t,e,n){return t.set(eF(t,e),n),n}function eF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yl=new WeakMap,mb=new WeakMap,gs=new WeakMap,na=new WeakMap,ra=new WeakMap,Nm=new WeakMap,Zu=new WeakMap;class Jl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;vl(this,yl,void 0),vl(this,mb,!1),vl(this,gs,null),vl(this,na,void 0),vl(this,ra,void 0),vl(this,Nm,!0),vl(this,Zu,new QL),fs(yl,this,e),fs(mb,this,n),fs(na,this,this.createEditor()),fs(ra,this,pt(na,this).style),pt(Zu,this).setObservedElement(this.getInputElement()),pt(Zu,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){pt(ra,this).left=`${e}px`,pt(ra,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Qt(this.getInputElement()),height:un(this.getInputElement())}}observeSize(){pt(Zu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){pt(ra,this).display="block",fs(Nm,this,!1)}hide(){pt(Zu,this).unobserve(),pt(Nm,this)||(pt(ra,this).display="none"),fs(Nm,this,!0)}isVisible(){return pt(ra,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return pt(yl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=pt(yl,this).createElement("div"),n=pt(yl,this).createElement("textarea");return e.style.display="none",fs(gs,this,pt(yl,this).createElement("div")),pt(gs,this).setAttribute("dir",pt(mb,this)?"rtl":"ltr"),q(pt(gs,this),Jl.CLASS_EDITOR_CONTAINER),pt(yl,this).body.appendChild(pt(gs,this)),q(e,Jl.CLASS_EDITOR),q(n,Jl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),pt(gs,this).appendChild(e),e}getInputElement(){return pt(na,this).querySelector(`.${Jl.CLASS_INPUT}`)}getEditorElement(){return pt(na,this)}destroy(){const e=pt(gs,this)?pt(gs,this).parentNode:null;pt(na,this).parentNode.removeChild(pt(na,this)),fs(na,this,null),fs(ra,this,null),pt(Zu,this).destroy(),e&&e.removeChild(pt(gs,this))}}mt(Jl,Fn);function pb(t,e,n){return(e=Mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mhe(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Phe=250,xhe=250;class tF{constructor(e){pb(this,"wasLastActionShow",!0),pb(this,"showDebounced",null),pb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},xhe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Phe;this.showDebounced=fg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(tF,Fn);function Ihe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Ohe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Cl(t,e){const n={};return _(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function pa(t,e,n,r,i){_(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Ahe(s,a,e,n,r,i)})})}function Ahe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Ihe(s.className,r):a=Ohe(s.className,r)),o(t,e,"className",a)}function nF(t){return`<span class="selected">✓</span>${t}`}function Bp(t,e){let n=!1;return Array.isArray(t)&&_(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function sy(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function Hhe(){return{name:Le}}const fi="alignment";function Nhe(){return{key:fi,name(){return this.getTranslatedPhrase(jT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fi}:left`,name(){return this.getTranslatedPhrase(UT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:center`,name(){return this.getTranslatedPhrase(zT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:right`,name(){return this.getTranslatedPhrase(YT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:justify`,name(){return this.getTranslatedPhrase(GT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${fi}:top`,name(){return this.getTranslatedPhrase(KT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:middle`,name(){return this.getTranslatedPhrase(qT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fi}:bottom`,name(){return this.getTranslatedPhrase(XT)},callback(){const t=this.getSelectedRange(),e=Cl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const ay="clear_column";function Dhe(){return{key:ay,name(){return this.getTranslatedPhrase(xT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Tg="col_left";function khe(){return{key:Tg,name(){return this.getTranslatedPhrase(RT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Mg="col_right";function $he(){return{key:Mg,name(){return this.getTranslatedPhrase(ET)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const _g="make_read_only";function Lhe(){return{key:_g,checkable:!0,ariaChecked(){return Bp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(xw)},name(){let t=this.getTranslatedPhrase(xw);return Bp(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=nF(t)),t},callback(){const t=this.getSelectedRange(),e=Bp(t,(n,r)=>this.getCellMeta(n,r).readOnly);_(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const ly="redo";function Fhe(){return{key:ly,name(){return this.getTranslatedPhrase(PT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Pg="remove_col";function Vhe(){return{key:Pg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(MT,e)},callback(){this.alter("remove_col",Rie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const uy="remove_row";function Bhe(){return{key:uy,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(TT,e)},callback(){this.alter("remove_row",Eie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const cy="row_above";function Whe(){return{key:cy,name(){return this.getTranslatedPhrase(bT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const hy="row_below";function jhe(){return{key:hy,name(){return this.getTranslatedPhrase(ST)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const $f="no_items";function Uhe(){return{key:$f,name(){return this.getTranslatedPhrase(CT)},disabled:!0,isCommand:!1}}const dy="undo";function zhe(){return{key:dy,name(){return this.getTranslatedPhrase(_T)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Yhe=[cy,hy,Tg,Mg,ay,uy,Pg,dy,ly,_g,fi,Le,$f],Ghe={[Le]:Hhe,[$f]:Uhe,[cy]:Whe,[hy]:jhe,[Tg]:khe,[Mg]:$he,[ay]:Dhe,[uy]:Bhe,[Pg]:Vhe,[dy]:zhe,[ly]:Fhe,[_g]:Lhe,[fi]:Nhe};function rF(){const t={};return ke(Ghe,(e,n)=>{t[n]=e()}),t}function Khe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(VT):this.getTranslatedPhrase(FT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function qhe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(BT)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Xhe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(WT);return Bp(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Wp))?nF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Wp);t.updateCommentMeta(n,r,{[Wp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Jhe(t,e){iF(t,e),e.add(t)}function Qu(t,e,n){iF(t,e),e.set(t,n)}function iF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zhe(t,e,n){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=ede(t,"string");return typeof e=="symbol"?e:e+""}function ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aa(t,e,n){return t.set(Rr(t,e),n),n}function He(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bw="comments",tde=60,Ts="comment",Vd="value",oF="style",Wp="readOnly",sd=Bw,VR=`plugin:${Bw}`;var ft=new WeakMap,Ao=new WeakMap,fy=new WeakMap,jp=new WeakMap,BR=new WeakMap,Ww=new WeakMap,kr=new WeakSet;class nde extends qe{constructor(){super(...arguments),Jhe(this,kr),Zhe(this,"range",{}),Qu(this,ft,null),Qu(this,Ao,null),Qu(this,fy,!1),Qu(this,jp,!1),Qu(this,BR,null),Qu(this,Ww,"")}static get PLUGIN_KEY(){return Bw}static get PLUGIN_PRIORITY(){return tde}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Bw]}enablePlugin(){var e=this;this.enabled||(He(ft,this)||(Aa(ft,this,new Jl(this.hot.rootDocument,this.hot.isRtl())),He(ft,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,cde).call(e,...r)})),He(Ao,this)||Aa(Ao,this,new tF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Rr(kr,this,ade).call(this,n,a)),this.addHook("afterScroll",()=>Rr(kr,this,hde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Rr(kr,this,ZO).call(this,n)),this.addHook("beforeCompositionStart",n=>Rr(kr,this,ZO).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr(kr,e,dde).call(e,...r)}),He(Ao,this).addLocalHook("hide",()=>this.hide()),He(Ao,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(Ao,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(VR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Aa(jp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(VR),this.hot._registerTimeout(()=>{Aa(jp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:sd}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(ft,this).setValue(He(Ww,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ft,this).isVisible()&&He(ft,this).isFocused(),group:sd}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ft,this).isVisible()&&He(ft,this).isFocused(),group:sd}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(ft,this).setValue(He(ft,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:sd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Rr(kr,this,ode).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rr(kr,this,rde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Rr(kr,this,sde).call(this)),this.eventManager.addEventListener(n,"focus",()=>Rr(kr,this,ude).call(this)),this.eventManager.addEventListener(n,"blur",()=>Rr(kr,this,lde).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Rr(kr,this,ide).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Wa(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&Wa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(ft,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Vd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ts),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Vd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Vd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(Ao,this).cancelHiding(),He(ft,this).setValue((e=i[Ts]?i[Ts][Vd]:null)!==null&&e!==void 0?e:""),He(ft,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(ft,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(ft,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(ft,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,oF);v?He(ft,this).setSize(v.width,v.height):He(ft,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?un(g):0,{left:C,top:M,width:x,height:P}=g.getBoundingClientRect(),{width:T,height:O}=He(ft,this).getSize(),{innerWidth:G,innerHeight:U}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,X=_n(this.hot.rootDocument),ne=IE(this.hot.rootWindow)?X:0,Q=OE(this.hot.rootWindow)?X:0;let te=C+h.scrollX+y,pe=M+h.scrollY+E;this.hot.isRtl()&&(te-=T+y),this.hot.isLtr()&&C+x+T>G-ne?te=C+h.scrollX-T-1:this.hot.isRtl()&&te<-(V.scrollWidth-V.clientWidth)&&(te=C+h.scrollX+y+1),M+O>U-Q&&(pe-=O-P+1),He(ft,this).setPosition(te,pe),He(ft,this).setReadOnlyState(this.getCommentMeta(i,o,Wp)),He(ft,this).observeSize()}focusEditor(){He(ft,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ts];let o;i?(o=Qn(i),mg(o,r)):o=r,this.hot.setCellMeta(e,n,Ts,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ts])return i[Ts][r]}addToContextMenu(e){e.items.push({name:Le},Khe(this),qhe(this),Xhe(this))}getEditorInputElement(){return He(ft,this).getInputElement()}destroy(){var e,n;(e=He(ft,this))===null||e===void 0||e.destroy(),(n=He(Ao,this))===null||n===void 0||n.destroy(),super.destroy()}}function rde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(fy,this)&&!this.targetIsCommentTextArea(t)){const e=Wa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function ide(t){t.stopPropagation()}function ode(t){const{rootDocument:e}=this.hot;if(!(He(fy,this)||He(ft,this).isFocused()||ve(t.target,"wtBorder")||He(BR,this)===t.target||!He(ft,this)))if(Aa(BR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(Ao,this).show(n)}else ka(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(Ao,this).hide()}function sde(){Aa(fy,this,!1)}function ade(t,e){e[Ts]&&e[Ts][Vd]&&q(t,e.commentedCellClassName)}function lde(){Aa(Ww,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function ude(){Aa(Ww,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(VR)}function cde(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[oF]:{width:t,height:e}})}function ZO(t){He(ft,this).isFocused()&&Ii(t)}function hde(){He(jp,this)||this.hide()}function dde(){const t=He(ft,this).getEditorElement();we(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function wb(t,e,n){return(e=fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fde(t){var e=gde(t,"string");return typeof e=="symbol"?e:e+""}function gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sF{constructor(e){wb(this,"hot",void 0),wb(this,"commands",{}),wb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=mde(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||ln(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),_(u,c=>c.apply(this.hot,r))}}function mde(t,e){let n;return _(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function vb(t,e,n){return(e=pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pde(t){var e=wde(t,"string");return typeof e=="symbol"?e:e+""}function wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;vb(this,"hot",void 0),vb(this,"predefinedItems",rF()),vb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ke(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return vde(e,this.defaultOrderPattern,this.predefinedItems)}}function vde(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),De(i)?ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),De(o)?cn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):_(i,(o,s)=>{let a=n[o];!a&&Yhe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),De(o)&&cn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ia(t,e,n){return(e=yde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yde(t){var e=Cde(t,"string");return typeof e=="symbol"?e:e+""}function Cde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bde{constructor(e,n){ia(this,"top",void 0),ia(this,"topRelative",void 0),ia(this,"left",void 0),ia(this,"leftRelative",void 0),ia(this,"scrollTop",void 0),ia(this,"scrollLeft",void 0),ia(this,"cellHeight",void 0),ia(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ad(t,e,n){Sde(t,e),e.set(t,n)}function Sde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(lF(t,e))}function Dm(t,e,n){return t.set(lF(t,e),n),n}function lF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rr=new WeakMap,yr=new WeakMap,Cr=new WeakMap,yb=new WeakMap,ec=new WeakMap;class Rde{constructor(e){ad(this,rr,void 0),ad(this,yr,void 0),ad(this,Cr,void 0),ad(this,yb,!1),ad(this,ec,{above:0,below:0,left:0,right:0}),Dm(yb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Oe(ec,this)[e]=n,this}setElement(e){return Dm(rr,this,e),this}setParentElement(e){return Dm(yr,this,e),this}updatePosition(e){Dm(Cr,this,new bde(e,Oe(rr,this).ownerDocument.defaultView)),Oe(yb,this)?(Oe(Cr,this).fitsBelow(Oe(rr,this))?this.setPositionBelowCursor():Oe(Cr,this).fitsAbove(Oe(rr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Oe(rr,this).dir==="rtl"?Oe(Cr,this).fitsOnLeft(Oe(rr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Oe(Cr,this).fitsOnRight(Oe(rr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Oe(ec,this).above+Oe(Cr,this).top-Oe(rr,this).offsetHeight;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top+Oe(Cr,this).cellHeight-Oe(rr,this).scrollHeight+i+o}Oe(rr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Oe(ec,this).below+Oe(Cr,this).top+1;if(Oe(yr,this)){const r=Oe(yr,this).ownerDocument.defaultView.getComputedStyle(Oe(yr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Oe(Cr,this).top-i-o-1}Oe(rr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Oe(Cr,this).left;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderRightWidth,10);e+=Oe(Cr,this).cellWidth+r}else e+=Oe(ec,this).right;Oe(rr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Oe(ec,this).left+Oe(Cr,this).left-Oe(rr,this).offsetWidth;if(Oe(yr,this)){const n=Oe(yr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Oe(yr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Oe(rr,this).style.left=`${e}px`}}function uF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ye(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:v}}function Ede(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function WR(t){return ln(t,"submenu")}function jR(t){return new RegExp(Le,"i").test(t.name)}function Up(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function QO(t){return ln(t,"disableSelection")}function Tde(t){return ve(t,"htSeparator")}function Mde(t){return ve(t,"htSubmenu")}function _de(t){return ve(t,"htDisabled")}function Pde(t){return ve(t,"htSelectionDisabled")}function xde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function cF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Ide(t,e){let n=t.slice(0);return n.reverse(),n=cF(n,e),n.reverse(),n}function Ode(t){const e=[];return _(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Ade(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=cF(n,e),n=Ide(n,e),n=Ode(n),n}function Hde(t){return t.checkable===!0}function Nde(t){return uF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Tde(r)||_de(r)||Pde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Dde(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const hF="menu",e1=hF;function kde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Dde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:hF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${e1}:${u}`:e1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function $de(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(qo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Up(a,t)&&!QO(a)&&!jR(a);be(n,[...Hde(a)?[E8(),_f(c),yk(h)]:[R8(),_f(u)],...d?[Mu(-1)]:[],...Up(a,t)?[O8()]:[],...WR(a)?[bi(!1)]:[]])}n.className="",n.appendChild(l),jR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):xu(l,u),Up(a,t)?q(n,"htDisabled"):QO(a)?q(n,"htSelectionDisabled"):WR(a)&&q(n,"htSubmenu")}}function Cb(t,e,n){Lde(t,e),e.set(t,n)}function Lde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e,n){return(e=Fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fde(t){var e=Vde(t,"string");return typeof e=="symbol"?e:e+""}function Vde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bb(t,e,n){return t.set(dF(t,e),n),n}function bl(t,e){return t.get(dF(t,e))}function dF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const t1=215;var ld=new WeakMap,km=new WeakMap,$m=new WeakMap;class bh{get tableBorderWidth(){return bl($m,this)===void 0&&this.hotMenu&&bb($m,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),bl($m,this)}constructor(e,n){var r=this;yo(this,"hot",void 0),yo(this,"options",void 0),yo(this,"eventManager",new Ei(this)),yo(this,"container",void 0),yo(this,"positioner",void 0),yo(this,"hotMenu",null),yo(this,"hotSubMenus",{}),yo(this,"parentMenu",void 0),yo(this,"menuItems",null),yo(this,"origOutsideClickDeselects",null),Cb(this,ld,void 0),Cb(this,km,void 0),Cb(this,$m,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:t1,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Rde(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=uu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return bl(ld,this)}getKeyboardShortcutsCtrl(){return bl(km,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=fg(a=>this.openSubMenu(a),300),n=this.options.minWidth||t1;let r=!1,i=Ba(this.menuItems,a=>(a.key===$f&&(r=!0),xde(a,this.hot)));if(i.length<1&&!r)i.push(rF()[$f]);else if(i.length===0)return;i=Ade(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:$de(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{bl(ld,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),pR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!pR()||!Ua(a))&&o&&this.hasSelectedItem()&&(jo()||FE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),bb(ld,this,Nde(this.hotMenu)),bb(km,this,kde(this)),bl(km,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(bl(ld,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[bi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Mde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new bh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[bi(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[bi(!1)])}}closeAllSubMenus(){_(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Ede(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||jR(e)||Up(e,this.hot)||WR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=Sn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?un(this.hotMenu.getCell(c,0)):0;return l+(u.name===Le?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ut(r)&&(r=r.call(this.hot),r===null||Ht(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[S8(),Mu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ka(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ka(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&ka(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(bh,Fn);function Bde(t,e){Wde(t,e),e.add(t)}function Wde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sb(t,e,n){return(e=jde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jde(t){var e=Ude(t,"string");return typeof e=="symbol"?e:e+""}function Ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bd="contextMenu",zde=70,n1=Bd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var ud=new WeakSet;class gy extends qe{constructor(){super(...arguments),Bde(this,ud),Sb(this,"commandExecutor",new sF(this.hot)),Sb(this,"itemsFactory",null),Sb(this,"menu",null)}static get PLUGIN_KEY(){return Bd}static get PLUGIN_PRIORITY(){return zde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[cy,hy,Le,Tg,Mg,Le,uy,Pg,Le,dy,ly,Le,_g,Le,fi]}isEnabled(){return!!this.hot.getSettings()[Bd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Bd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new bh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Lm(ud,this,Gde).call(this)),this.menu.addLocalHook("afterOpen",()=>Lm(ud,this,Kde).call(this)),this.menu.addLocalHook("afterClose",()=>Lm(ud,this,qde).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Lm(ud,this,Yde).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=sy(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:n1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(n1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;ke(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new aF(this.hot,gy.DEFAULT_ITEMS);const e=this.hot.getSettings()[Bd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),_(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Yde(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=sy(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Gde(){this.hot.runHooks("beforeContextMenuShow",this)}function Kde(){this.hot.runHooks("afterContextMenuShow",this)}function qde(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}gy.SEPARATOR={name:Le};function Xde(t){return{key:"copy",name(){return this.getTranslatedPhrase(IT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Jde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(HT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Zde(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(AT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Qde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ye(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(OT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function efe(t){return{key:"cut",name(){return this.getTranslatedPhrase(NT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class tfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class nfe{constructor(){this.clipboardData=new tfe}preventDefault(){}composedPath(){return[]}}function rfe(t,e){fF(t,e),e.add(t)}function tc(t,e,n){fF(t,e),e.set(t,n)}function fF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(Oc(t,e))}function nc(t,e,n){return t.set(Oc(t,e),n),n}function Oc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oa=new WeakMap,Rb=new WeakMap,cd=new WeakMap,UR=new WeakMap,zR=new WeakMap,hd=new WeakMap,dd=new WeakSet;class ife{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;rfe(this,dd),tc(this,oa,void 0),tc(this,Rb,void 0),tc(this,cd,void 0),tc(this,UR,void 0),tc(this,zR,void 0),tc(this,hd,void 0),nc(Rb,this,n),nc(cd,this,r),nc(UR,this,i),nc(zR,this,o),nc(hd,this,s)}setSelectedRange(e){nc(oa,this,e)}getCellsRange(){if(sr(Rb,this).call(this)===0||sr(cd,this).call(this)===0)return null;const{row:e,col:n}=sr(oa,this).getTopStartCorner(),{row:r,col:i}=sr(oa,this).getBottomEndCorner(),o=Oc(dd,this,ofe).call(this,e,r),s=Oc(dd,this,Eb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(sr(cd,this).call(this)===0||sr(hd,this).call(this)===0)return null;const{col:e}=sr(oa,this).getTopStartCorner(),{col:n}=sr(oa,this).getBottomEndCorner(),r=Oc(dd,this,Eb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(sr(cd,this).call(this)===0||sr(hd,this).call(this)===0)return null;const{col:e}=sr(oa,this).getTopStartCorner(),{col:n}=sr(oa,this).getBottomEndCorner(),r=Oc(dd,this,Eb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-sr(hd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Eb(t,e){return Math.min(e,Math.max(t+sr(zR,this).call(this)-1,t))}function ofe(t,e){return Math.min(e,Math.max(t+sr(UR,this).call(this)-1,t))}function gF(t){const e=[],n=[];return _(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function sfe(t,e){mF(t,e),e.add(t)}function sa(t,e,n){mF(t,e),e.set(t,n)}function mF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e,n){return(e=afe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function afe(t){var e=lfe(t,"string");return typeof e=="symbol"?e:e+""}function lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pr(t,e){return t.get(Ir(t,e))}function Bi(t,e,n){return t.set(Ir(t,e),n),n}function Ir(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Tb="copyPaste",ufe=80,cfe=["fragmentSelection"],r1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var YR=new WeakMap,GR=new WeakMap,KR=new WeakMap,rc=new WeakMap,Fm=new WeakMap,Vm=new WeakMap,ic=new WeakMap,jw=new WeakMap,Ur=new WeakSet;class hfe extends qe{constructor(){super(...arguments),sfe(this,Ur),fd(this,"columnsLimit",1/0),fd(this,"rowsLimit",1/0),fd(this,"pasteMode","overwrite"),fd(this,"uiContainer",this.hot.rootDocument.body),sa(this,YR,!1),sa(this,GR,!1),sa(this,KR,!1),sa(this,rc,"cells-only"),sa(this,Fm,!1),sa(this,Vm,!1),sa(this,ic,new ife({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),sa(this,jw,!1),fd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Tb}static get SETTING_KEYS(){return[Tb,...cfe]}static get PLUGIN_PRIORITY(){return ufe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Tb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Bi(YR,this,this.getSetting("copyColumnHeaders")),Bi(GR,this,this.getSetting("copyColumnGroupHeaders")),Bi(KR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Ir(Ur,this,gfe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,mfe).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Ir(Ur,this,pfe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Af()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,wfe).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ir(Ur,r,vfe).call(r,...o)}),this.addHook("afterSelection",()=>Ir(Ur,this,yfe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Bi(rc,this,e),Bi(Fm,this,!0),Ir(Ur,this,i1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Bi(Vm,this,!0),Ir(Ur,this,i1).call(this,"cut")}getRangedCopyableData(e){return Zd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=gF(e);return _(r,o=>{const s=[];_(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new nfe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Pr(ic,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Pr(rc,this)==="column-headers-only"?n.set("headers",Pr(ic,this).getMostBottomColumnHeadersRange()):(Pr(rc,this)==="with-column-headers"?n.set("headers",Pr(ic,this).getMostBottomColumnHeadersRange()):Pr(rc,this)==="with-column-group-headers"&&n.set("headers",Pr(ic,this).getAllColumnHeadersRange()),n.set("cells",Pr(ic,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,g===!0)continue;d=v,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:M}=this.hot.getCellMeta(s,h);if(h=M+1,C===!0)continue;f=M;const x=y.length%i;y.push(e[E][x])}o.push(y)}return Bi(jw,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(Fm,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Kd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Bi(Fm,this,!1);const o=this.getRangedData(this.copyableRanges),s=Ir(Ur,this,dfe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Zd(o);if(e&&e.clipboardData){const u=SR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[r1,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Bi(rc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Pr(Vm,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Kd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Bi(Vm,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Zd(o);if(e&&e.clipboardData){const l=SR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[r1,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Kd(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=Dv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=s$(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=xie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function i1(t){if(Af()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&Ak(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function dfe(t){const{rows:e}=gF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function ffe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&HE(r)}}}function pF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&NE(r)}}}function gfe(t){t.items.push({name:"---------"},Xde(this)),Pr(YR,this)&&t.items.push(Qde(this)),Pr(GR,this)&&t.items.push(Zde(this)),Pr(KR,this)&&t.items.push(Jde(this)),t.items.push(efe(this))}function mfe(t,e,n,r,i){Pr(jw,this)&&(i.value=!0),Bi(jw,this,!1)}function pfe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function wfe(){Ir(Ur,this,pF).call(this)}function vfe(){Ir(Ur,this,ffe).call(this)}function yfe(){Ir(Ur,this,pF).call(this)}function wF(t,e){return`border_row${t}col${e}`}function Wd(){return{width:1,color:"#000"}}function Ns(){return{hide:!0}}function Cfe(){return{width:1,color:"#000",cornerVisible:!1}}function Mb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function gd(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function _b(t,e){return{id:wF(t,e),border:Cfe(),row:t,col:e,top:Ns(),bottom:Ns(),start:Ns(),end:Ns()}}function bfe(t,e){return ln(e,"border")&&e.border&&(t.border=e.border),ln(e,"top")&&le(e.top)&&(e.top?(De(e.top)||(e.top=Wd()),t.top=e.top):(e.top=Ns(),t.top=e.top)),ln(e,"bottom")&&le(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Wd()),t.bottom=e.bottom):(e.bottom=Ns(),t.bottom=e.bottom)),ln(e,"start")&&le(e.start)&&(e.start?(De(e.start)||(e.start=Wd()),t.start=e.start):(e.start=Ns(),t.start=e.start)),ln(e,"end")&&le(e.end)&&(e.end?(De(e.end)||(e.end=Wd()),t.end=e.end):(e.end=Ns(),t.end=e.end)),t}function js(t,e){let n=!1;return _(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!ln(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function my(t){return`<span class="selected">✓</span>${t}`}function Sfe(t){return t.some(e=>le(e.left)||le(e.right))}function Rfe(t){return t.some(e=>le(e.start)||le(e.end))}const Efe=new Map([["left","start"],["right","end"]]);function Tfe(t){var e;return(e=Efe.get(t))!==null&&e!==void 0?e:t}function Mfe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(eM);return js(this,"bottom")&&(e=my(e)),e},callback(e,n){const r=js(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function _fe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(tM);return js(this,e)&&(n=my(n)),n},callback(n,r){const i=js(this,e);t.prepareBorder(r,e,i)}}}function Pfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(nM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!js(this)}}}function xfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(QT);return js(this,e)&&(n=my(n)),n},callback(n,r){const i=js(this,e);t.prepareBorder(r,e,i)}}}function Ife(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(ZT);return js(this,"top")&&(e=my(e)),e},callback(e,n){const r=js(this,"top");t.prepareBorder(n,"top",r)}}}function Ofe(t,e){Afe(t,e),e.add(t)}function Afe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hfe(t,e,n){return(e=Nfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nfe(t){var e=Dfe(t,"string");return typeof e=="symbol"?e:e+""}function Dfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zp="customBorders",kfe=90;var Pb=new WeakSet;class $fe extends qe{constructor(){super(...arguments),Ofe(this,Pb),Hfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return kfe}isEnabled(){return!!this.hot.getSettings()[zp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>o1(Pb,this,Lfe).call(this,e)),this.addHook("init",()=>o1(Pb,this,Ffe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Mb(n));const o=Qc(e),s=Df(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});_(e,a=>{s(a).forAll((l,u)=>{_(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Tfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Qc(e),r=Df(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return _(e,o=>{r(o).forAll((s,a)=>{_(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(gd(l))})})}),i}clearBorders(e){e?this.setBorders(e):(_(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=_b(e,n);r&&(a=bfe(a,r),_(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",gd(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=_b(o,s);let l=0;o===e.from.row&&ln(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&ln(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&ln(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&ln(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",gd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=wF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=_b(e,n):o=Mb(o),i?(o[r]=Ns(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",gd(o)))):(o[r]=Wd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",gd(o)))}prepareBorder(e,n,r){_(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){_(e,n=>{const r=Mb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Sn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){_(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){_(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):_(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return _(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return _(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):_(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);_(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[zp];if(Array.isArray(e)){const n=Qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Sfe(e),r=Rfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Lfe(t){this.hot.getSettings()[zp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(JT)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Ife(this),xfe(this),Mfe(this),_fe(this),Pfe(this)]}})}function Ffe(){this.changeBorderSettings()}function Vfe(t,e){Bfe(t,e),e.add(t)}function Bfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(t,e,n){return(e=Wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wfe(t){var e=jfe(t,"string");return typeof e=="symbol"?e:e+""}function jfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const a1="dragToScroll",Ufe=100;var Ib=new WeakSet;class zfe extends qe{constructor(){super(...arguments),Vfe(this,Ib),xb(this,"boundaries",null),xb(this,"callback",null),xb(this,"listening",!1)}static get PLUGIN_KEY(){return a1}static get PLUGIN_PRIORITY(){return Ufe}isEnabled(){return!!this.hot.getSettings()[a1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>s1(Ib,this,l1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>s1(Ib,this,l1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=uu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function l1(t){if(Ua(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Yfe(t,e){vF(t,e),e.add(t)}function Gfe(t,e,n){vF(t,e),e.set(t,n)}function vF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ob(t,e,n){return(e=Kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kfe(t){var e=qfe(t,"string");return typeof e=="symbol"?e:e+""}function qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xfe(t,e){return t.get(gi(t,e))}function yF(t,e,n){return t.set(gi(t,e),n),n}function gi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Yp="dropdownMenu",Jfe=230,Lf="changeType",Ab=Yp;var py=new WeakMap,Ui=new WeakSet;class wy extends qe{static get PLUGIN_KEY(){return Yp}static get PLUGIN_PRIORITY(){return Jfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Tg,Mg,Le,Pg,Le,ay,Le,_g,Le,fi]}constructor(e){super(e),Yfe(this,Ui),Ob(this,"commandExecutor",new sF(this.hot)),Ob(this,"itemsFactory",null),Ob(this,"menu",null),Gfe(this,py,!1),this.hot.addHook("afterGetColHeader",(n,r)=>gi(Ui,this,Qfe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Yp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new aF(this.hot,wy.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(Ui,e,oge).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return gi(Ui,e,ige).call(e,...o)});const n=this.hot.getSettings()[Yp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new bh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>gi(Ui,this,ege).call(this)),this.menu.addLocalHook("afterOpen",()=>gi(Ui,this,tge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>gi(Ui,this,nge).call(this,o)),this.menu.addLocalHook("afterClose",()=>gi(Ui,this,rge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),_(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=sy(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Lf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Ab},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Ab}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ab)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>gi(Ui,this,Zfe).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function CF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Zfe(t){if(ve(t.target,Lf)){const e=sy(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),yF(py,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Qfe(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Lf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Lf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(s,[_u(),_f(" ")]),be(e,[pk("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function ege(){this.hot.runHooks("beforeDropdownMenuShow",this)}function tge(){this.hot.runHooks("afterDropdownMenuShow",this),gi(Ui,this,CF).call(this,this.menu)}function nge(t){gi(Ui,this,CF).call(this,t)}function rge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function ige(t){return Xfe(py,this)?null:t}function oge(t){ve(t.target,Lf)&&yF(py,this,!0)}wy.SEPARATOR={name:Le};function u1(t,e,n){return(e=sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sge(t){var e=age(t,"string");return typeof e=="symbol"?e:e+""}function age(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lge{constructor(e){u1(this,"hot",void 0),u1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function c1(t,e,n){return(e=uge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uge(t){var e=cge(t,"string");return typeof e=="symbol"?e:e+""}function cge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){c1(this,"dataProvider",void 0),c1(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=oo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=cn(oo(m_.DEFAULT_OPTIONS),n),n=cn(n,e),n.filename=SE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function hge(t,e){dge(t,e),e.add(t)}function dge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bF="\r",fge='"',gge=`
`,mge="=",pge="+",wge="-",vge="@",yge="	";var Hb=new WeakSet;class Cge extends m_{constructor(){super(...arguments),hge(this,Hb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ue(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),_(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Tt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=h1(Hb,this,Sge).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=h1(Hb,this,bge).call(this,i)),(n||i.indexOf(bF)>=0||i.indexOf(fge)>=0||i.indexOf(gge)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function bge(t){return t.startsWith(mge)||t.startsWith(pge)||t.startsWith(wge)||t.startsWith(vge)||t.startsWith(yge)||t.startsWith(bF)?`'${t}`:t}function Sge(t,e){return e.test(t)?`'${t}`:t}const Rge="csv",qR={[Rge]:Cge};function Ege(t,e,n){return typeof qR[t]=="function"?new qR[t](e,n):null}const Tge="exportFile",Mge=240;class _ge extends qe{static get PLUGIN_KEY(){return Tge}static get PLUGIN_PRIORITY(){return Mge}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qR[e])throw new Error(`Export format type "${e}" is not supported.`);return Ege(e,new lge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function oc(t,e,n){return(e=Pge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pge(t){var e=xge(t,"string");return typeof e=="symbol"?e:e+""}function xge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xg{constructor(e,n){let{id:r,stateless:i=!0}=n;oc(this,"hot",void 0),oc(this,"id",void 0),oc(this,"elements",[]),oc(this,"hidden",!1),oc(this,"stateId",""),oc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Xv)}getElements(){return this.elements}reset(){_(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(xg,Fn);const Ff={};function za(t,e){if(!Ff[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Ff[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Zl(t){if(!Ff[t])throw Error(`Filter condition "${t}" does not exist.`);return Ff[t].descriptor}function fn(t,e,n){n.key=t,Ff[t]={condition:e,descriptor:n}}const An="none";function Ige(){return!0}fn(An,Ige,{name:Jv,inputsCount:0,showOperators:!1});const tf="empty";function Oge(t){return Yt(t.value)}fn(tf,Oge,{name:uM,inputsCount:0,showOperators:!0});const Gp="not_empty";function Age(t,e){return!za(tf,e)(t)}fn(Gp,Age,{name:cM,inputsCount:0,showOperators:!0});const nf="eq";function Hge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale)===Tt(n)}fn(nf,Hge,{name:hM,inputsCount:1,showOperators:!0});const Kp="neq";function Nge(t,e){return!za(nf,e)(t)}fn(Kp,Nge,{name:dM,inputsCount:1,showOperators:!0});const SF="gt";function Dge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}fn(SF,Dge,{name:wM,inputsCount:1,showOperators:!0});const RF="gte";function kge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}fn(RF,kge,{name:vM,inputsCount:1,showOperators:!0});const EF="lt";function $ge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}fn(EF,$ge,{name:yM,inputsCount:1,showOperators:!0});const TF="lte";function Lge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}fn(TF,Lge,{name:CM,inputsCount:1,showOperators:!0});const p_="date_after";function Fge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}fn(p_,Fge,{name:RM,inputsCount:1,showOperators:!0});const w_="date_before";function Vge(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}fn(w_,Vge,{name:EM,inputsCount:1,showOperators:!0});const Uw="between";function Bge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=za(w_,[o]),a=za(p_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}fn(Uw,Bge,{name:bM,inputsCount:2,showOperators:!0});const MF="not_between";function Wge(t,e){return!za(Uw,e)(t)}fn(MF,Wge,{name:SM,inputsCount:2,showOperators:!0});const _F="begins_with";function jge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Tt(n))}fn(_F,jge,{name:fM,inputsCount:1,showOperators:!0});const PF="ends_with";function Uge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Tt(n))}fn(PF,Uge,{name:gM,inputsCount:1,showOperators:!0});const v_="contains";function zge(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Tt(n))>=0}fn(v_,zge,{name:mM,inputsCount:1,showOperators:!0});const xF="not_contains";function Yge(t,e){return!za(v_,e)(t)}fn(xF,Yge,{name:pM,inputsCount:1,showOperators:!0});const IF="date_tomorrow";function Gge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}fn(IF,Gge,{name:MM,inputsCount:0});const OF="date_today";function Kge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}fn(OF,Kge,{name:TM,inputsCount:0});const AF="date_yesterday";function qge(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}fn(AF,qge,{name:_M,inputsCount:0});Wk();function Xge(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Ig(t){const e=new Set(t);return function(n){return e.has(n)}}function y_(t){return t??""}function XR(t){return Array.from(new Set(t)).map(e=>y_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function d1(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ig(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Xge(a,n)};r&&r(u),i.push(u)}),i}const Ql="by_value";function Jge(t,e){let[n]=e;return n(t.value)}fn(Ql,Jge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ig(e)]},showOperators:!1});const Vf={};function Zge(t){if(!Vf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Vf[t].func;return function(n,r){return e(n,r)}}function Qge(t){return Vf[t].name}function C_(t,e,n){Vf[t]={name:e,func:n}}const Fa="conjunction",eme=IM;function tme(t,e){return t.every(n=>n.func(e))}C_(Fa,eme,tme);const zw="disjunction",nme=Zv;function rme(t,e){return t.some(n=>n.func(e))}C_(zw,nme,rme);const b_="disjunctionWithExtraCondition",ime=Zv;function ome(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}C_(b_,ime,ome);const sme="numeric",HF="text",ame="date",f1={[sme]:[An,Le,tf,Gp,Le,nf,Kp,Le,SF,RF,EF,TF,Uw,MF],[HF]:[An,Le,tf,Gp,Le,nf,Kp,Le,_F,PF,Le,v_,xF],[ame]:[An,Le,tf,Gp,Le,nf,Kp,Le,w_,p_,Uw,Le,IF,OF,AF]};function lme(t){const e=[];let n=t;return f1[n]||(n=HF),_(f1[n],r=>{let i;r===Le?i={name:Le}:i=oo(Zl(r)),e.push(i)}),e}function md(t,e,n){return(e=ume(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ume(t){var e=cme(t,"string");return typeof e=="symbol"?e:e+""}function cme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nb="built",Db="building",g1=["click","input","keydown","keypress","keyup","focus","blur","change"];let no=class NF{static get DEFAULTS(){return oo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){md(this,"hot",void 0),md(this,"eventManager",new Ei(this)),md(this,"options",void 0),md(this,"_element",void 0),md(this,"buildState",void 0),this.hot=e,this.options=cn(NF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Db?this._element:this.buildState===Nb?(this.update(),this._element):(this.buildState=Db,this.build(),this.buildState=Nb,this._element)}isBuilt(){return this.buildState===Nb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(gr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Db),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)_(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),_(g1,r=>e(n,r))}else _(g1,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(no,Fn);function hme(t,e){DF(t,e),e.add(t)}function dme(t,e,n){DF(t,e),e.set(t,n)}function DF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bm(t,e){return t.get(S_(t,e))}function fme(t,e,n){return t.set(S_(t,e),n),n}function S_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap,m1=new WeakSet;class Va extends no{static get DEFAULTS(){return oo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,cn(Va.DEFAULTS,n)),hme(this,m1),dme(this,sc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>S_(m1,this,gme).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");fme(sc,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Bm(sc,this).type=this.options.type,Bm(sc,this).placeholder=this.translateIfPossible(this.options.placeholder),Bm(sc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Bm(sc,this).focus()}}function gme(t){this.options.value=t.target.value}function mme(t,e){kF(t,e),e.add(t)}function pd(t,e,n){kF(t,e),e.set(t,n)}function kF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ac(t,e,n){return t.set(rf(t,e),n),n}function Ft(t,e){return t.get(rf(t,e))}function rf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rn=new WeakMap,Wm=new WeakMap,jm=new WeakMap,kb=new WeakMap,Um=new WeakMap,zm=new WeakSet;class Bf extends no{static get DEFAULTS(){return oo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,cn(Bf.DEFAULTS,n)),mme(this,zm),pd(this,Rn,null),pd(this,Wm,[]),pd(this,jm,void 0),pd(this,kb,void 0),pd(this,Um,void 0),this.registerHooks()}getMenu(){return Ft(Rn,this)}registerHooks(){this.addLocalHook("click",()=>rf(zm,this,vme).call(this))}setItems(e){ac(Wm,this,this.translateNames(e)),Ft(Rn,this)&&Ft(Rn,this).setMenuItems(Ft(Wm,this))}translateNames(e){return _(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),ac(Rn,this,new bh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(Rn,this).setMenuItems(Ft(Wm,this));const e=new no(this.hot,{className:"htUISelectCaption"}),n=new no(this.hot,{className:"htUISelectDropdown"});ac(jm,this,e),ac(kb,this,e.element),ac(Um,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[_u()]),be(this._element,[mk()])),_([e,n],r=>this._element.appendChild(r.element)),Ft(Rn,this).addLocalHook("select",r=>rf(zm,this,pme).call(this,r)),Ft(Rn,this).addLocalHook("afterClose",()=>rf(zm,this,wme).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(Rn,this).hot.getTranslatedPhrase(Jv),Ft(kb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(Rn,this)&&(Ft(Rn,this).open(),Ft(Rn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(Rn,this).getNavigator().toFirstItem(),Ft(Rn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(Rn,this)&&Ft(Rn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(Rn,this)&&(Ft(Rn,this).destroy(),ac(Rn,this,null)),Ft(jm,this)&&Ft(jm,this).destroy(),Ft(Um,this)&&Ft(Um,this).destroy(),super.destroy()}}function pme(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function wme(){this.runLocalHooks("afterClose")}function vme(){this.openOptions()}function yme(t,e){Cme(t,e),e.add(t)}function Cme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p1(t,e,n){return(e=bme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bme(t){var e=Sme(t,"string");return typeof e=="symbol"?e:e+""}function Sme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function w1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $b=new WeakSet;class JR extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),yme(this,$b),p1(this,"name",""),p1(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Bf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Va(this.hot,{placeholder:kM})),this.elements.push(new Va(this.hot,{placeholder:$M})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>w1($b,this,Rme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),_(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>w1($b,this,Eme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=oo(e.command);n.name.startsWith(Gt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),_(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zl(An),n=[];return _(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Zl(e?e.name:An);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||_(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Bf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Va)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Zl(An)];if(e!==null){const{visualIndex:r}=e;n=lme(this.hot.getDataType(0,r,this.hot.countRows(),r))}_(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Rme(t){_(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Eme(t){ph(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ii(t))}function v1(t,e,n){Tme(t,e),e.set(t,n)}function Tme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e){return t.get($F(t,e))}function y1(t,e,n){return t.set($F(t,e),n),n}function $F(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lc=new WeakMap,Lb=new WeakMap;class Yw extends no{static get DEFAULTS(){return oo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,cn(Yw.DEFAULTS,n)),v1(this,lc,void 0),v1(this,Lb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),y1(Lb,this,e),y1(lc,this,this._element.firstChild),wd(lc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wd(Lb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?wd(lc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(wd(lc,this).checked=e)}focus(){this.isBuilt()&&wd(lc,this).focus()}}function Mme(t,e){_me(t,e),e.add(t)}function _me(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pme(t,e,n){return(e=xme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xme(t){var e=Ime(t,"string");return typeof e=="symbol"?e:e+""}function Ime(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ome(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const C1=0;var b1=new WeakSet;class Ame extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Mme(this,b1),Pme(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),_(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Fa,zw];_(e,n=>{const r=new Yw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Qge(n)},value:n,checked:n===e[C1],id:n});r.addLocalHook("change",i=>Ome(b1,this,Hme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);_(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Yw&&n.isChecked());return e?e.getValue():Fa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&_(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fa,n=arguments.length>1?arguments[1]:void 0,r=e;r===b_&&(r=zw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(C1)}}function Hme(t){this.setState(t.target.value)}function Nme(t,e,n){Dme(t,e),e.set(t,n)}function Dme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fb(t,e){return t.get(LF(t,e))}function kme(t,e,n){return t.set(LF(t,e),n),n}function LF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vd=new WeakMap;class Wf extends no{static get DEFAULTS(){return oo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,cn(Wf.DEFAULTS,n)),Nme(this,vd,void 0)}build(){super.build(),kme(vd,this,this._element.firstChild)}update(){this.isBuilt()&&(Fb(vd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Fb(vd,this).focus()}activate(){Fb(vd,this).click()}}function $me(t,e){FF(t,e),e.add(t)}function uc(t,e,n){FF(t,e),e.set(t,n)}function FF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(Ac(t,e))}function $i(t,e,n){return t.set(Ac(t,e),n),n}function Ac(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const S1="multipleSelect.itemBox";var zi=new WeakMap,Xt=new WeakMap,Vb=new WeakMap,ms=new WeakMap,aa=new WeakMap,la=new WeakMap,yd=new WeakSet;class jf extends no{static get DEFAULTS(){return oo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,cn(jf.DEFAULTS,n)),$me(this,yd),uc(this,zi,[]),uc(this,Xt,void 0),uc(this,Vb,void 0),uc(this,ms,void 0),uc(this,aa,void 0),uc(this,la,void 0),$i(ms,this,new Va(this.hot,{placeholder:DM,className:"htUIMultipleSelectSearch"})),$i(aa,this,new Wf(this.hot,{textContent:OM,className:"htUISelectAll"})),$i(la,this,new Wf(this.hot,{textContent:AM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return xe(Xt,this)}registerHooks(){xe(ms,this).addLocalHook("keydown",e=>Ac(yd,this,Fme).call(this,e)),xe(ms,this).addLocalHook("input",e=>Ac(yd,this,Lme).call(this,e)),xe(aa,this).addLocalHook("click",e=>Ac(yd,this,Vme).call(this,e)),xe(la,this).addLocalHook("click",e=>Ac(yd,this,Bme).call(this,e))}setItems(e){var n;$i(zi,this,e),(n=xe(Xt,this))===null||n===void 0||n.loadData(xe(zi,this))}setLocale(e){$i(Vb,this,e)}getLocale(){return xe(Vb,this)}getItems(){return[...xe(zi,this)]}getValue(){return jme(xe(zi,this))}getSearchInputElement(){return xe(ms,this)}getSelectAllElement(){return xe(aa,this)}getClearAllElement(){return xe(la,this)}isSelectedAllValues(){return xe(zi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new no(this.hot,{className:"htUISelectionControls",children:[xe(aa,this),xe(la,this)]});this._element.appendChild(xe(ms,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=xe(Xt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),$i(Xt,this,new this.hot.constructor(o,{data:xe(zi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{xe(Xt,this).listen()},modifyColWidth:u=>{const c=xe(Xt,this).container.scrollWidth-_n(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),xe(Xt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||xe(Xt,this).useTheme(u)});const l=xe(Xt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:S1}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{xe(Xt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:S1})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&xe(Xt,this).listen()}reset(){xe(ms,this).reset(),xe(aa,this).reset(),xe(la,this).reset()}update(){this.isBuilt()&&(xe(Xt,this).loadData(Wme(xe(zi,this),this.options.value)),super.update())}destroy(){var e;(e=xe(Xt,this))===null||e===void 0||e.destroy(),xe(ms,this).destroy(),xe(la,this).destroy(),xe(aa,this).destroy(),$i(ms,this,null),$i(la,this,null),$i(aa,this,null),$i(Xt,this,null),$i(zi,this,null),super.destroy()}}function Lme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...xe(zi,this)]:n=xe(zi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),xe(Xt,this).loadData(n)}function Fme(t){this.runLocalHooks("keydown",t,this),DE(ph,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ii(t),xe(Xt,this).listen(),xe(Xt,this).selectCell(0,0))}function Vme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(dT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function Bme(t){const e=[];t.preventDefault(),xe(Xt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(dT(n,r)[0])}),xe(Xt,this).setSourceDataAtCell(e)}function Wme(t,e){const n=Ig(e);return t.map(r=>(r.checked=n(r.value),r))}function jme(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Ume(t,e){zme(t,e),e.add(t)}function zme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yme(t,e,n){return(e=Gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gme(t){var e=Kme(t,"string");return typeof e=="symbol"?e:e+""}function Kme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ym(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cd=new WeakSet;class qme extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ume(this,Cd),Yme(this,"name",""),this.name=n.name,this.elements.push(new jf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ym(Cd,this,Xme).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Ym(Cd,this,Jme).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ql){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?An:Ql},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ba(i,h=>h.name===Ql),u={},c=this.hot.getTranslatedPhrase(Iw);if(l){const h=s(r,a),d=Ue(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=XR(d);o&&(l.args[0]=o);const v=[],y=d1(g,l.args[0],c,C=>{C.checked&&v.push(C.value),Ym(Cd,this,R1).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=Zl(Ql),u.itemsSnapshot=y}else u.args=[],u.command=Zl(An);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof jf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Iw),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=XR(r),s=d1(o,o,e,l=>{Ym(Cd,this,R1).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:y_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Xme(t){ph(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ii(t))}function R1(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Jme(t,e){switch(e.type){case"numeric":return _L(t,e);default:return t}}var VF;function Zme(t,e){Qme(t,e),e.add(t)}function Qme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function epe(t,e,n){return(e=tpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tpe(t){var e=npe(t,"string");return typeof e=="symbol"?e:e+""}function npe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var E1=new WeakSet;class Uf extends xg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Zme(this,E1),epe(this,"name",""),this.name=n.name,this.elements.push(new Va(this.hot,{type:"button",value:HM,className:"htUIButton htUIButtonOK",identifier:Uf.BUTTON_OK})),this.elements.push(new Va(this.hot,{type:"button",value:NM,className:"htUIButton htUIButtonCancel",identifier:Uf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){_(this.elements,e=>{e.addLocalHook("click",(n,r)=>rpe(E1,this,ipe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),_(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}VF=Uf;function ipe(t,e){e.options.identifier===VF.BUTTON_OK?this.accept():this.cancel()}function Bb(t,e,n){return(e=ope(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ope(t){var e=spe(t,"string");return typeof e=="symbol"?e:e+""}function spe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const T1="ConditionCollection.filteringStates";class R_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Bb(this,"hot",void 0),Bb(this,"isMapRegistrable",void 0),Bb(this,"filteringStates",new Xv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(T1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa;return e.length?Zge(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ht(Vf[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:za(a,s)}]},i):u.push({name:a,args:s,func:za(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(T1),this.filteringStates=null,this.clearLocalHooks()}}mt(R_,Fn);function M1(t,e,n){return(e=ape(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ape(t){var e=lpe(t,"string");return typeof e=="symbol"?e:e+""}function lpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];M1(this,"conditionCollection",void 0),M1(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return _(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return _(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return _(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function upe(t,e){cpe(t,e),e.add(t)}function cpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){return(e=hpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hpe(t){var e=dpe(t,"string");return typeof e=="symbol"?e:e+""}function dpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gm=new WeakSet;class WF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];upe(this,Gm),Sl(this,"hot",void 0),Sl(this,"conditionCollection",void 0),Sl(this,"columnDataFactory",void 0),Sl(this,"changes",[]),Sl(this,"grouping",!1),Sl(this,"latestEditedColumnPosition",-1),Sl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Wb(Gm,this,fpe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Wb(Gm,this,gpe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Wb(Gm,this,mpe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,_(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Nk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new R_(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const v=r.columnDataFactory(h);let y;f.isEmpty()?y=v:y=new BF(f,C=>r.columnDataFactory(C)).filter(),y=Ue(y,C=>C.meta.visualRow);const E=Ig(y);return f.destroy(),Ba(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ke(this,(e,n)=>{this[n]=null})}}function fpe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function gpe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function mpe(){_(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(WF,Fn);function ppe(t){return uF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof jf)return r;if(i.element&&!cu(i.element))return!1;i.focus()}})}const bd="filters";function wpe(t,e){let n=-1,r;const i=ppe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(bd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof no&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(bd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(bd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const v=e[i.getCurrentPage()];v instanceof Bf&&(v.openOptions(),g.preventDefault()),v instanceof Wf&&(v.activate(),g.preventDefault()),v instanceof no||g.preventDefault()}}],bd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(bd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function vpe(t,e){jF(t,e),e.add(t)}function jb(t,e,n){jF(t,e),e.set(t,n)}function jF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sd(t,e,n){return(e=ype(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ype(t){var e=Cpe(t,"string");return typeof e=="symbol"?e:e+""}function Cpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qp(t,e,n){return t.set(Er(t,e),n),n}function mi(t,e){return t.get(Er(t,e))}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZR="filters",bpe=250,_1=ZR;var bs=new WeakMap,QR=new WeakMap,Kl=new WeakMap,$r=new WeakSet;class Spe extends qe{static get PLUGIN_KEY(){return ZR}static get PLUGIN_PRIORITY(){return bpe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,vpe(this,$r),Sd(this,"dropdownMenuPlugin",null),Sd(this,"conditionCollection",null),Sd(this,"conditionUpdateObserver",null),Sd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Sd(this,"filtersRowsMap",null),jb(this,bs,void 0),jb(this,QR,new WeakSet),jb(this,Kl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Er($r,n,xpe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[ZR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Cg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>Er($r,this,P1).call(this,"accept")),a.addLocalHook("cancel",()=>Er($r,this,P1).call(this,"cancel")),a.addLocalHook("change",l=>Er($r,this,Ppe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(PM)}:`,s=()=>`${this.hot.getTranslatedPhrase(xM)}:`;if(!this.components.get("filter_by_condition")){const a=new JR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,x1).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Ame(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new JR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Er($r,this,x1).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new qme(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Uf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new R_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new WF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Er($r,this,Ipe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Er($r,e,_pe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Er($r,this,Mpe).call(this)),this.addHook("afterDropdownMenuShow",()=>Er($r,this,Epe).call(this)),this.addHook("afterDropdownMenuHide",()=>Er($r,this,Tpe).call(this)),this.addHook("afterChange",a=>Er($r,this,Rpe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!mi(bs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=mi(bs,this).getMenu(),c=u.getNavigator(),h=mi(bs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];qp(bs,this,wpe(this.dropdownMenuPlugin.menu,a));const l=u=>{mi(bs,this).listen(),u.preventDefault(),ph(u.keyCode,"TAB")&&(u.shiftKey?mi(bs,this).toPreviousItem():mi(bs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:_1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_1)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Fa;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,mi(Kl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=Ig(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),_(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),qp(Kl,this,this.exportConditions())}else s!==!1&&!r?(qp(Kl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(mi(Kl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return _(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:y_(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=XR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===zw&&n.command.key!==An&&r.command.key!==An&&i.command.key!==An?o=b_:i.command.key!==An&&(n.command.key===An||r.command.key===An)&&(o=Fa),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new BF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _(i,s=>{_(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Rpe(t){t&&_(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Epe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Tpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Mpe(){const t=this.dropdownMenuPlugin.menu;mi(QR,this).has(t)||mi(bs,this).setMenu(t),mi(QR,this).add(t)}function _pe(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function P1(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==An&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==An&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==An&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Ppe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===JR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function x1(){this.setListeningDropdownMenu()}function xpe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):we(e,"htFiltersActive")}function Ipe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&qp(Kl,this,mi(Kl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Ql),s=n.filter(a=>a.name!==Ql);if(o.length>=2||s.length>=3)nt(ht`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const UF="internal-use-in-handsontable",e0={licenseKey:UF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function zF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function YF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Ope(t){var e;const n=t[Kn],r=YF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=zF(t);return{...e0,...r,...i}}function Ape(t){var e;const n=t[Kn],r=YF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=zF(t);return{...r,...i}}function Hpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function vy(){const t="engine_relationship",e=lo(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function E_(){const t="shared_engine_usage",e=lo(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Npe(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||Ht(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Dpe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ht(r.hyperformula)){const o=vy(),s=E_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:UF}),(r.getConfig().leapYear1900!==e0.leapYear1900||Bv(r.getConfig().nullDate,e0.nullDate)===!1)&&nt(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Dpe(t,e,n){const r=e[Kn],i=Ope(e),o=vy(),s=E_();kpe(t,r.functions),$pe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Lpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function I1(t){var e;const n=vy(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function O1(t,e){if(t){const n=vy(),r=n.get(t),i=E_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function kpe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){nt(s.message)}})}function $pe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){nt(r.message)}}}function Lpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){nt(a.message)}}),t.resumeEvaluation())}function Fpe(t,e){return(Ht(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const GF="DD/MM/YYYY";function Vpe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Bpe(t){return Vpe(t)?t.substr(1):t}function Wpe(t){return typeof t=="string"&&t.startsWith("=")}function T_(t,e){return typeof t=="string"&&e==="date"}function KF(t,e){return Z(t,e,!0).isValid()}function qF(t,e){return Z(t,e,!0).format(GF)}function jpe(t,e){return Z(t,GF,!0).format(e)}function XF(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Upe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function zpe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Ype(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function M_(t,e,n){const r=zpe(t,Upe(t,e,n));return Ype(r)}function Rl(t,e,n){Gpe(t,e),e.set(t,n)}function Gpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(JF(t,e))}function ua(t,e,n){return t.set(JF(t,e),n),n}function JF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rd=new WeakMap,ca=new WeakMap,Lr=new WeakMap,Km=new WeakMap,Ub=new WeakMap,zb=new WeakMap,qm=new WeakMap;class A1{constructor(e,n,r){Rl(this,Rd,void 0),Rl(this,ca,void 0),Rl(this,Lr,void 0),Rl(this,Km,[]),Rl(this,Ub,[]),Rl(this,zb,void 0),Rl(this,qm,[]),ua(Rd,this,e),ua(ca,this,n),ua(Lr,this,r)}setRemovedHfIndexes(e){return ua(qm,this,e.map(n=>{const r=Ot(ca,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Ot(qm,this)}getRemovedHfIndexes(){return Ot(qm,this)}getHfIndexFromVisualIndex(e){const n=Ot(ca,this).getIndexesSequence(),r=Ot(ca,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Zn(Ot(Rd,this))}s`;Ot(Lr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Ot(Lr,this).getEngine()[r](Ot(Lr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ua(Ub,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ua(zb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Ot(Lr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=M_(Ot(Ub,this),Ot(zb,this),Ot(ca,this).getNumberOfIndexes());Ot(Lr,this).getSheetId()===null?Ot(Lr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Zn(Ot(Rd,this))}Order`;return n=>{if(Ot(Lr,this).isPerformingUndoRedo())return;const r=Ot(ca,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Ot(Km,this).map(l=>r.indexOf(l)),o=Ot(Lr,this).getEngine().getSheetDimensions(Ot(Lr,this).getSheetId());let s;Ot(Rd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Ot(Lr,this).getEngine()[e](Ot(Lr,this).getSheetId(),i)}ua(Km,this,r)}}init(){ua(Km,this,Ot(ca,this).getIndexesSequence())}}function El(t,e,n){Kpe(t,e),e.set(t,n)}function Kpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e){return t.get(ZF(t,e))}function Tl(t,e,n){return t.set(ZF(t,e),n),n}function ZF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xm=new WeakMap,Jm=new WeakMap,Yb=new WeakMap,Gb=new WeakMap,Kb=new WeakMap,qb=new WeakMap,Xb=new WeakMap;class qpe{constructor(e,n,r){El(this,Xm,void 0),El(this,Jm,void 0),El(this,Yb,void 0),El(this,Gb,!1),El(this,Kb,!1),El(this,qb,null),El(this,Xb,null),Tl(Xm,this,new A1("row",e,this)),Tl(Jm,this,new A1("column",n,this)),Tl(Yb,this,r)}getForAxis(e){return e==="row"?ps(Xm,this):ps(Jm,this)}setPerformUndo(e){Tl(Gb,this,e)}setPerformRedo(e){Tl(Kb,this,e)}isPerformingUndoRedo(){return ps(Gb,this)||ps(Kb,this)}getSheetId(){return ps(Xb,this)}getEngine(){return ps(qb,this)}getPostponeAction(){return ps(Yb,this)}setupSyncEndpoint(e,n){Tl(qb,this,e),Tl(Xb,this,n),ps(Xm,this).init(),ps(Jm,this).init()}}function Xpe(t,e){QF(t,e),e.add(t)}function Ml(t,e,n){return(e=Jpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jpe(t){var e=Zpe(t,"string");return typeof e=="symbol"?e:e+""}function Zpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jb(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){return t.set(Xe(t,e),n),n}function iu(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kn="formulas",Qpe=["maxRows","maxColumns","language"],ewe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const Sh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Us=new WeakMap,yy=new WeakMap,Ed=new WeakMap,Qe=new WeakSet;class twe extends qe{constructor(){var e;super(...arguments),e=this,Xpe(this,Qe),Jb(this,Us,!1),Jb(this,yy,!1),Jb(this,Ed,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,wwe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,vwe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,ywe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Cwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,bwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Qe,e,Swe).call(e,...r)}]]),Ml(this,"staticRegister",lo("formulas")),Ml(this,"engine",null),Ml(this,"sheetId",null),Ml(this,"sheetName",null),Ml(this,"indexSyncer",null),Ml(this,"rowAxisSyncer",null),Ml(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return ewe}static get SETTING_KEYS(){return[Kn,...Qpe]}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Npe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){nt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Qe,this,of).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,H1).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,N1).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,H1).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,N1).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,owe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,swe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,nwe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,awe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,D1).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,D1).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,lwe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,uwe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,dwe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,fwe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,cwe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,hwe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,gwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,mwe).call(n,...i)}),this.indexSyncer=new qpe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,iwe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,pwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Qe,n,rwe).call(n,...i)}),iu(Ed,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){iu(Ed,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),O1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Ape(this.hot.getSettings());Hpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Qe,this,of).call(this,o)}}super.updatePlugin(e)}destroy(){iu(Ed,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ya(Ed,this,null),O1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!H$(n))return nt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return nt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return nt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){BE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Qe,this,of).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),I1(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=I1(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){nt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return T_(r,o.type)&&(KF(r,o.dateFormat)?r=qF(r,o.dateFormat):Wpe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function of(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function nwe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Gn(s)&&(s=XF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function rwe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:v}=h.start,{row:y,col:E}=h.end,C=y-g+1,M=E-v+1;for(let x=0;x<f.length;x+=1)for(let P=0;P<f[x].length;P+=1){const T=f[x][P],O=g+x%C,G=v+P%M,U=this.hot.getCellMeta(O,G);T_(T,U.type)&&(T.startsWith("'")?f[x][P]=T.slice(1):this.isFormulaCellType(O,G,this.sheetId)===!1&&(f[x][P]=jpe(T,U.dateFormat)))}return f}function H1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Kn))||Ya(yy,this,Ht(this.hot.getSettings().data))}function iwe(){if(iu(yy,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;T_(i,s.type)&&(KF(i,a)?t[r][o]=qF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ya(Us,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ya(Us,this,!1)}function N1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Zn(Kn)))return;const r=Fpe(this.engine,this.hot.getSettings()[Kn].sheetName);if(Xe(Qe,this,of).call(this,r),n!=="updateSettings")if(iu(yy,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ya(Us,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ya(Us,this,!1)}}}function owe(t,e,n,r){if(r!=="get"||iu(Us,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Bpe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Gn(a)&&(a=XF(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function swe(t,e,n,r){if(r!=="get"||iu(Us,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function D1(t,e){if(Sh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function awe(t,e){if(Sh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Gn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){nt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function lwe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function uwe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function cwe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function hwe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function dwe(t,e,n){if(Sh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function fwe(t,e,n){if(Sh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function gwe(t,e,n,r){if(Sh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function mwe(t,e,n,r){if(Sh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function pwe(t,e,n){var r;Ya(Us,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ya(Us,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function wwe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function vwe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function ywe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Cwe(t){this.hot.runHooks("afterSheetAdded",t)}function bwe(t,e){Xe(Qe,this,of).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Swe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Rwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(oM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Ewe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(sM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Twe(t,e){eV(t,e),e.add(t)}function Mwe(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e){return t.get(va(t,e))}function k1(t,e,n){return t.set(va(t,e),n),n}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const $1="hiddenColumns",_we=310;var Co=new WeakMap,Pl=new WeakSet;class Pwe extends qe{constructor(){super(...arguments),Twe(this,Pl),Mwe(this,Co,null)}static get PLUGIN_KEY(){return $1}static get PLUGIN_PRIORITY(){return _we}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[$1]}enablePlugin(){var e=this;this.enabled||(k1(Co,this,new qv),_l(Co,this).addLocalHook("init",()=>va(Pl,this,Nwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_l(Co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,Hwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>va(Pl,this,Iwe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>va(Pl,this,xwe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Pl,e,Awe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>va(Pl,this,Owe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=_l(Co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));_(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&_l(Co,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{_l(Co,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(_l(Co,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _l(Co,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){k1(Co,this,null),super.destroy()}}function xwe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Iwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Owe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Awe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Hwe(t){t.items.push({name:Le},Rwe(this),Ewe(this))}function Nwe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Dwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(aM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function kwe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(lM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function $we(t,e){tV(t,e),e.add(t)}function Lwe(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e){return t.get(ya(t,e))}function L1(t,e,n){return t.set(ya(t,e),n),n}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const F1="hiddenRows",Fwe=320;var bo=new WeakMap,Il=new WeakSet;class Vwe extends qe{constructor(){super(...arguments),$we(this,Il),Lwe(this,bo,null)}static get PLUGIN_KEY(){return F1}static get PLUGIN_PRIORITY(){return Fwe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[F1]}enablePlugin(){var e=this;this.enabled||(L1(bo,this,new qv),xl(bo,this).addLocalHook("init",()=>ya(Il,this,Ywe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,xl(bo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,zwe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ya(Il,this,Wwe).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>ya(Il,this,Bwe).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(Il,e,Uwe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ya(Il,this,jwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=xl(bo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));_(l,u=>{o[u]=!1}),i=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&xl(bo,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{xl(bo,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(xl(bo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return xl(bo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){L1(bo,this,null),super.destroy()}}function Bwe(t,e){return this.isHidden(e)?0:t}function Wwe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function jwe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Uwe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function zwe(t){t.items.push({name:Le},Dwe(this),kwe(this))}function Ywe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Gwe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(DT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Kwe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(kT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function qwe(t,e){nV(t,e),e.add(t)}function Xwe(t,e,n){nV(t,e),e.set(t,n)}function nV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t0(t,e){return t.get(Gw(t,e))}function Zb(t,e,n){return t.set(Gw(t,e),n),n}function Gw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const V1="manualColumnFreeze",Jwe=110;var Ul=new WeakMap,Qb=new WeakSet;class Zwe extends qe{constructor(){super(...arguments),qwe(this,Qb),Xwe(this,Ul,!1)}static get PLUGIN_KEY(){return V1}static get PLUGIN_PRIORITY(){return Jwe}isEnabled(){return!!this.hot.getSettings()[V1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Gw(Qb,this,Qwe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Gw(Qb,this,eve).call(this,e,n)),super.enablePlugin())}disablePlugin(){Zb(Ul,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;t0(Ul,this)||Zb(Ul,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;t0(Ul,this)||Zb(Ul,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Qwe(t){t.items.push({name:"---------"},Gwe(this),Kwe(this))}function eve(t,e){if(t0(Ul,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Zm(t,e,n){return(e=tve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tve(t){var e=nve(t,"string");return typeof e=="symbol"?e:e+""}function nve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eS=0,B1=1,W1=2,cc="px";let rV=class{constructor(e){Zm(this,"hot",void 0),Zm(this,"_element",null),Zm(this,"state",eS),Zm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=W1}build(){this.state===eS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=B1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=eS}isAppended(){return this.state===W1}isBuilt(){return this.state>=B1}setPosition(e,n){Gn(e)&&(this._element.style.top=e+cc),Gn(n)&&(this._element.style[this.inlineProperty]=n+cc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Gn(e)&&(this._element.style.width=e+cc),Gn(n)&&(this._element.style.height=n+cc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Gn(e)&&(this._element.style.marginTop=e+cc),Gn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+cc)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const rve="ht__manualColumnMove--backlight";let ive=class extends rV{build(){super.build(),q(this._element,rve)}};const ove="ht__manualColumnMove--guideline";let sve=class extends rV{build(){super.build(),q(this._element,ove)}};function ave(t,e){iV(t,e),e.add(t)}function Li(t,e,n){iV(t,e),e.set(t,n)}function iV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e,n){return t.set(Ca(t,e),n),n}function he(t,e){return t.get(Ca(t,e))}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const tS="manualColumnMove",lve=120,j1="ht__manualColumnMove",Kw="show-ui",n0="on-moving--columns",r0="after-selection--columns";var lr=new WeakMap,Ra=new WeakMap,Ds=new WeakMap,Xp=new WeakMap,Ha=new WeakMap,ar=new WeakMap,Qm=new WeakMap,hi=new WeakMap,Ec=new WeakMap,qw=new WeakMap,sf=new WeakMap,Ol=new WeakSet;class uve extends qe{constructor(){super(...arguments),ave(this,Ol),Li(this,lr,new ive(this.hot)),Li(this,Ra,new sve(this.hot)),Li(this,Ds,[]),Li(this,Xp,0),Li(this,Ha,!1),Li(this,ar,{}),Li(this,Qm,void 0),Li(this,hi,void 0),Li(this,Ec,void 0),Li(this,qw,void 0),Li(this,sf,void 0)}static get PLUGIN_KEY(){return tS}static get PLUGIN_PRIORITY(){return lve}isEnabled(){return!!this.hot.getSettings()[tS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,cve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,dve).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ca(Ol,this,gve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Ol,e,mve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,j1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,j1),this.unregisterEvents(),he(lr,this).destroy(),he(Ra,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Qm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Or(Qm,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Or(Qm,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[tS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(lr,this).getOffset().start,u=he(lr,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=Qt(this.hot.rootElement),y=g.innerWidth-he(Ec,this)-v;h=g.innerWidth-he(ar,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(ar,this).eventPageX-(he(Ec,this)-(r.scrollX===void 0?i:0));if(he(qw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(hi,this))&&(o+=i),o+=c,he(hi,this)<0)he(sf,this)>0?he(ar,this).col=0:he(ar,this).col=e>0?e-1:e;else if(he(ar,this).TD.offsetWidth/2+o<=h){const g=he(hi,this)>=he(Xp,this)?he(Xp,this)-1:he(hi,this);he(ar,this).col=g+1,o+=he(ar,this).TD.offsetWidth}else he(ar,this).col=he(hi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(hi,this)<he(sf,this)&&(f-=he(Ec,this)<=r.scrollX?he(Ec,this):0),he(lr,this).setPosition(null,d),he(Ra,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ca(Ol,this,hve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ca(Ol,this,fve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(lr,this).build(),he(Ra,this).build()}destroy(){he(lr,this).destroy(),he(Ra,this).destroy(),super.destroy()}}function cve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(t.target,"sortAction");if(!s||!o||he(Ha,this)||t.button!==0||a){Or(Ha,this,!1),he(Ds,this).length=0,we(this.hot.rootElement,[n0,Kw]);return}const l=he(Ra,this).isBuilt()&&!he(Ra,this).isAppended(),u=he(lr,this).isBuilt()&&!he(lr,this).isAppended();l&&u&&(he(Ra,this).appendTo(i.hider),he(lr,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Or(Ha,this,!0);const g=n.firstChild?Jk(t,n.firstChild).x:t.offsetX;he(ar,this).eventPageX=t.pageX,Or(hi,this,e.col),he(ar,this).TD=n,he(ar,this).col=e.col,Or(Ds,this,this.prepareColumnsToMoving(d,f)),Or(qw,this,!!this.hot.getSettings().rowHeaders),Or(Xp,this,this.hot.countCols()),Or(sf,this,this.hot.getSettings().fixedColumnsStart),Or(Ec,this,Ln(this.hot.rootElement).left);const v=he(qw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(sf,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(d,e.col-1)+M,P=this.getColumnsWidth(v,d-1)+(E?C:0)+x;he(lr,this).setPosition(y,P),he(lr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(lr,this).setOffset(null,-x),q(this.hot.rootElement,n0)}else we(this.hot.rootElement,r0),Or(Ha,this,!1),he(Ds,this).length=0}function hve(t){he(Ha,this)&&(he(ar,this).eventPageX=t.pageX,this.refreshPositions())}function dve(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Ha,this)||(he(Ds,this).indexOf(e.col)>-1?we(this.hot.rootElement,Kw):q(this.hot.rootElement,Kw),r.row=!0,r.column=!0,r.cell=!0,Or(hi,this,e.col),he(ar,this).TD=n)}function fve(){const t=he(ar,this).col,e=he(Ds,this).length;if(Or(hi,this,void 0),Or(Ha,this,!1),we(this.hot.rootElement,[n0,Kw,r0]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,r0),e<1||t===void 0)return;const n=he(Ds,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Ds,this),t);if(he(Ds,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function gve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(lr,this).setPosition(r),he(lr,this).setSize(null,t.hider.offsetHeight-r)}function mve(){this.moveBySettingsOrLoad()}function pve(t,e){oV(t,e),e.add(t)}function Wn(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e,n){return t.set(Yi(t,e),n),n}function se(t,e){return t.get(Yi(t,e))}function Yi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xw="manualColumnResize",wve=130,U1="manualColumnWidths";var Ms=new WeakMap,ep=new WeakMap,Yr=new WeakMap,Jw=new WeakMap,Vo=new WeakMap,vve=new WeakMap,Uc=new WeakMap,tp=new WeakMap,Sr=new WeakMap,Ss=new WeakMap,mu=new WeakMap,Zw=new WeakMap,af=new WeakMap,lf=new WeakMap,Kr=new WeakMap,uf=new WeakMap,So=new WeakSet;class yve extends qe{static get PLUGIN_KEY(){return Xw}static get PLUGIN_PRIORITY(){return wve}constructor(e){super(e),pve(this,So),Wn(this,Ms,null),Wn(this,ep,null),Wn(this,Yr,[]),Wn(this,Jw,null),Wn(this,Vo,null),Wn(this,vve,null),Wn(this,Uc,null),Wn(this,tp,null),Wn(this,Sr,this.hot.rootDocument.createElement("DIV")),Wn(this,Ss,this.hot.rootDocument.createElement("DIV")),Wn(this,mu,null),Wn(this,Zw,!1),Wn(this,af,0),Wn(this,lf,null),Wn(this,Kr,void 0),Wn(this,uf,void 0),q(se(Sr,this),"manualColumnResizer"),q(se(Ss,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Xw]}enablePlugin(){var e=this;this.enabled||(Zt(Kr,this,new qa),se(Kr,this).addLocalHook("init",()=>Yi(So,this,Cve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,se(Kr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,Mve).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,_ve).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yi(So,e,Pve).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Zt(uf,this,se(Kr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",U1,se(Kr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",U1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return se(Kr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);se(Kr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Zt(Ms,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(se(Ms,this)),i=r.col;if(i<0)return;const o=un(se(Ms,this)),s=se(Ms,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Ms,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(se(Ms,this),r.row,r.col)),Zt(ep,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Zt(Yr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();_(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{se(Yr,this).includes(g)||se(Yr,this).push(g)})})}se(Yr,this).includes(se(ep,this))||Zt(Yr,this,[se(ep,this)]),Zt(tp,this,l.start-6),Zt(Uc,this,parseInt(s.width,10)),se(Sr,this).style.top=`${l.top}px`,se(Sr,this).style[this.inlineDir]=`${se(tp,this)+se(Uc,this)}px`,se(Sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(se(Sr,this))}refreshHandlePosition(){se(Sr,this).style[this.inlineDir]=`${se(tp,this)+se(Jw,this)}px`}setupGuidePosition(){const e=parseInt(un(se(Sr,this)),10),n=parseInt(se(Sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(se(Sr,this),"active"),q(se(Ss,this),"active"),se(Ss,this).style.top=`${n}px`,this.refreshGuidePosition(),se(Ss,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(se(Ss,this))}refreshGuidePosition(){se(Ss,this).style[this.inlineDir]=se(Sr,this).style[this.inlineDir]}hideHandleAndGuide(){we(se(Sr,this),"active"),we(se(Ss,this),"active")}checkIfColumnHeader(e){const n=Wa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",se(Vo,this),r,!0);o!==void 0&&Zt(Vo,this,o),this.setManualSize(r,se(Vo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Vo,this),r,!0),i&&e()};se(af,this)>=2&&(se(Yr,this).length>1?(_(se(Yr,this),i=>{n(i)}),e()):_(se(Yr,this),i=>{n(i,!0)})),Zt(af,this,0),Zt(lf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Yi(So,this,bve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Yi(So,this,Sve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Yi(So,this,Rve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Yi(So,this,Eve).call(this)),this.eventManager.addEventListener(se(Sr,this),"contextmenu",()=>Yi(So,this,Tve).call(this))}destroy(){super.destroy()}}function Cve(){const t=this.hot.getSettings()[Xw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0),Zt(uf,this,t)):t===!0&&Array.isArray(se(uf,this))&&this.hot.batchExecution(()=>{se(uf,this).forEach((n,r)=>{se(Kr,this).setValueAtIndex(r,n)})},!0)}function bve(t){if(!AE(t.target)&&se(Zw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(se(mu,this)||this.setupHandlePosition(e))}}function Sve(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(se(Ms,this)),this.setupGuidePosition(),Zt(mu,this,!0),se(lf,this)===null&&(Zt(lf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(lf,this))),Zt(af,this,se(af,this)+1),this.startX=t.pageX,Zt(Vo,this,se(Uc,this)))}function Rve(t){if(se(mu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Zt(Jw,this,se(Uc,this)+e),_(se(Yr,this),n=>{Zt(Vo,this,this.setManualSize(n,se(Jw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Eve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",se(Vo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",se(Vo,this),n,!1)};se(mu,this)&&(this.hideHandleAndGuide(),Zt(mu,this,!1),se(Vo,this)!==se(Uc,this)&&(se(Yr,this).length>1?(_(se(Yr,this),r=>{e(r)}),t()):_(se(Yr,this),r=>{e(r,!0)})),this.setupHandlePosition(se(Ms,this)))}function Tve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Sr,this)),this.hot.rootElement.removeChild(se(Ss,this)),Zt(mu,this,!1),Zt(Zw,this,!0),this.hot._registerImmediate(()=>{Zt(Zw,this,!1)})}function Mve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=se(Kr,this).getValueAtIndex(r);this.hot.getSettings()[Xw]&&i&&(n=i)}return n}function _ve(t,e){const n=se(Kr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Pve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function nS(t,e,n){return(e=xve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xve(t){var e=Ive(t,"string");return typeof e=="symbol"?e:e+""}function Ive(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rS=0,z1=1,Y1=2,hc="px";let sV=class{constructor(e){nS(this,"hot",void 0),nS(this,"_element",null),nS(this,"state",rS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=Y1}build(){this.state===rS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=z1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=rS}isAppended(){return this.state===Y1}isBuilt(){return this.state>=z1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+hc),n!==void 0&&(this._element.style.left=n+hc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+hc),n&&(this._element.style.height=n+hc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+hc),n&&(this._element.style.marginLeft=n+hc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Ove="ht__manualRowMove--backlight";class Ave extends sV{build(){super.build(),q(this._element,Ove)}}const Hve="ht__manualRowMove--guideline";class Nve extends sV{build(){super.build(),q(this._element,Hve)}}function Dve(t,e){aV(t,e),e.add(t)}function dc(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eu(t,e,n){return t.set(ba(t,e),n),n}function Pe(t,e){return t.get(ba(t,e))}function ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const iS="manualRowMove",kve=140,G1="ht__manualRowMove",Qw="show-ui",i0="on-moving--rows",o0="after-selection--rows";var ur=new WeakMap,Ea=new WeakMap,ks=new WeakMap,Na=new WeakMap,Ar=new WeakMap,np=new WeakMap,Al=new WeakSet;class $ve extends qe{constructor(){super(...arguments),Dve(this,Al),dc(this,ur,new Ave(this.hot)),dc(this,Ea,new Nve(this.hot)),dc(this,ks,[]),dc(this,Na,void 0),dc(this,Ar,{}),dc(this,np,void 0)}static get PLUGIN_KEY(){return iS}static get PLUGIN_PRIORITY(){return kve}isEnabled(){return!!this.hot.getSettings()[iS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,Lve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,Vve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ba(Al,this,Wve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Al,e,jve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,G1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){we(this.hot.rootElement,G1),this.unregisterEvents(),Pe(ur,this).destroy(),Pe(Ea,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Pe(np,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(eu(np,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return eu(np,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[iS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Pe(Ar,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Pe(Ar,this).TD,a=this.hot.rootElement,l=Ln(a),u=Xc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Pe(Ar,this).eventPageY-d+c,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Pe(ur,this).getOffset().top,E=Pe(ur,this).getSize().height,C=s.offsetHeight/2,M=s.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=x+C;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Ar,this).row=n>0?n-1:n:P?(Pe(Ar,this).row=e.row+1,x+=e.row===0?M-1:M):Pe(Ar,this).row=e.row;let T=f,O=x;f+E+y>=g?T=g-E-y:f+y<v&&(T=v+Math.abs(y)),x>=g-1&&(O=g-1),Pe(ur,this).setPosition(T),Pe(Ea,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ba(Al,this,Fve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ba(Al,this,Bve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(ur,this).build(),Pe(Ea,this).build()}destroy(){Pe(ur,this).destroy(),Pe(Ea,this).destroy(),super.destroy()}}function Lve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Na,this)||t.button!==0){eu(Na,this,!1),Pe(ks,this).length=0,we(this.hot.rootElement,[i0,Qw]);return}const l=Pe(Ea,this).isBuilt()&&!Pe(Ea,this).isAppended(),u=Pe(ur,this).isBuilt()&&!Pe(ur,this).isAppended();l&&u&&(Pe(Ea,this).appendTo(i.hider),Pe(ur,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,eu(Na,this,!0),Pe(Ar,this).eventPageY=t.pageY,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n,eu(ks,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Pe(ur,this).setPosition(null,g),Pe(ur,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Pe(ur,this).setOffset(-v,null),q(this.hot.rootElement,i0),this.refreshPositions()}else we(this.hot.rootElement,o0),eu(Na,this,!1),Pe(ks,this).length=0}function Fve(t){Pe(Na,this)&&(Pe(Ar,this).eventPageY=t.pageY,this.refreshPositions())}function Vve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Pe(Na,this)||(Pe(ks,this).indexOf(e.row)>-1?we(this.hot.rootElement,Qw):q(this.hot.rootElement,Qw),r.row=!0,r.column=!0,r.cell=!0,Pe(Ar,this).coords=e,Pe(Ar,this).TD=n)}function Bve(){const t=Pe(Ar,this).row,e=Pe(ks,this).length;if(eu(Na,this,!1),we(this.hot.rootElement,[i0,Qw,o0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,o0),e<1||t===void 0)return;const n=Pe(ks,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Pe(ks,this),t);if(Pe(ks,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Wve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Pe(ur,this).setPosition(null,r),Pe(ur,this).setSize(t.hider.offsetWidth-r)}function jve(){this.moveBySettingsOrLoad()}function Uve(t,e){lV(t,e),e.add(t)}function jn(t,e,n){lV(t,e),e.set(t,n)}function lV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e,n){return t.set(_s(t,e),n),n}function ie(t,e){return t.get(_s(t,e))}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ev="manualRowResize",zve=30,K1="manualRowHeights";var Ho=new WeakMap,rp=new WeakMap,Gr=new WeakMap,cf=new WeakMap,Ta=new WeakMap,__=new WeakMap,zc=new WeakMap,ip=new WeakMap,or=new WeakMap,Io=new WeakMap,pu=new WeakMap,tv=new WeakMap,hf=new WeakMap,df=new WeakMap,Xi=new WeakMap,ff=new WeakMap,ha=new WeakSet;class Yve extends qe{static get PLUGIN_KEY(){return ev}static get PLUGIN_PRIORITY(){return zve}constructor(e){super(e),Uve(this,ha),jn(this,Ho,null),jn(this,rp,null),jn(this,Gr,[]),jn(this,cf,null),jn(this,Ta,null),jn(this,__,null),jn(this,zc,null),jn(this,ip,null),jn(this,or,this.hot.rootDocument.createElement("DIV")),jn(this,Io,this.hot.rootDocument.createElement("DIV")),jn(this,pu,!1),jn(this,tv,!1),jn(this,hf,0),jn(this,df,null),jn(this,Xi,void 0),jn(this,ff,void 0),q(ie(or,this),"manualRowResizer"),q(ie(Io,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ev]}enablePlugin(){this.enabled||(jt(Xi,this,new qa),ie(Xi,this).addLocalHook("init",()=>_s(ha,this,Qve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(Xi,this)),this.addHook("modifyRowHeight",(e,n)=>_s(ha,this,Zve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jt(ff,this,ie(Xi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",K1,ie(Xi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",K1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ie(Xi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ie(cf,this)}setupHandlePosition(e){jt(Ho,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ie(Ho,this)),o=i.row;if(o<0)return;const s=Qt(ie(Ho,this)),a=ie(Ho,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(Ho,this),i.row,i.col)),jt(rp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),jt(Gr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();_(d,f=>{const g=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;fe(g,v,y=>{ie(Gr,this).includes(y)||ie(Gr,this).push(y)})})}ie(Gr,this).includes(ie(rp,this))||jt(Gr,this,[ie(rp,this)]),jt(ip,this,c.top-6),jt(zc,this,parseInt(a.height,10)),ie(or,this).style.top=`${ie(ip,this)+ie(zc,this)}px`,ie(or,this).style[this.inlineDir]=`${c.start}px`,ie(or,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(or,this))}refreshHandlePosition(){ie(or,this).style.top=`${ie(ip,this)+ie(cf,this)}px`}setupGuidePosition(){const e=parseInt(Qt(ie(or,this)),10),n=parseInt(ie(or,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ie(or,this),"active"),q(ie(Io,this),"active"),ie(Io,this).style.top=ie(or,this).style.top,ie(Io,this).style[this.inlineDir]=`${n}px`,ie(Io,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ie(Io,this))}refreshGuidePosition(){ie(Io,this).style.top=ie(or,this).style.top}hideHandleAndGuide(){we(ie(or,this),"active"),we(ie(Io,this),"active")}checkIfRowHeader(e){const n=Wa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ie(Ta,this)<n?n:ie(Ta,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&jt(Ta,this,o),this.setManualSize(r,ie(Ta,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ie(hf,this)>=2&&(ie(Gr,this).length>1?(_(ie(Gr,this),i=>{n(i)}),e()):_(ie(Gr,this),i=>{n(i,!0)})),jt(hf,this,0),jt(df,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>_s(ha,this,Gve).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>_s(ha,this,Kve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>_s(ha,this,qve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>_s(ha,this,Xve).call(this)),this.eventManager.addEventListener(ie(or,this),"contextmenu",()=>_s(ha,this,Jve).call(this))}destroy(){super.destroy()}}function Gve(t){if(!AE(t.target)&&ie(tv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ie(pu,this)||this.setupHandlePosition(e))}}function Kve(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ie(Ho,this)),this.setupGuidePosition(),jt(pu,this,!0),ie(df,this)===null&&(jt(df,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(df,this))),jt(hf,this,ie(hf,this)+1),jt(__,this,t.pageY),jt(Ta,this,ie(zc,this)))}function qve(t){ie(pu,this)&&(jt(cf,this,ie(zc,this)+(t.pageY-ie(__,this))),_(ie(Gr,this),e=>{jt(Ta,this,this.setManualSize(e,ie(cf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Xve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ie(pu,this)&&(this.hideHandleAndGuide(),jt(pu,this,!1),ie(Ta,this)!==ie(zc,this)&&(ie(Gr,this).length>1?(_(ie(Gr,this),r=>{e(r)}),t()):_(ie(Gr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Ho,this)))}function Jve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(or,this)),this.hot.rootElement.removeChild(ie(Io,this)),jt(pu,this,!1),jt(tv,this,!0),this.hot._registerImmediate(()=>{jt(tv,this,!1)})}function Zve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ie(Xi,this).getValueAtIndex(r);this.hot.getSettings()[ev]&&i&&(n=i)}return n}function Qve(){const t=this.hot.getSettings()[ev],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)}),jt(ff,this,t)):t===!0&&Array.isArray(ie(ff,this))&&ie(ff,this).forEach((n,r)=>{ie(Xi,this).setValueAtIndex(r,n)})},!0)}var eye=Uv;eye("flatMap");var tye=yn,q1=bn,nye=Zo,rye=j0,iye=function(t,e){(!e||typeof t!="string")&&q1(t);var n=rye(t);return nye(q1(n!==void 0?tye(n,t):t))},oye=Ct,s0=yn,sye=Dr,a0=bn,aye=Zo,lye=iye,uye=q0,l0=ei,cye=Ka,oS=cye("flatMap",TypeError),hye=uye(function(){for(var t=this.iterator,e=this.mapper,n,r;;){if(r=this.inner)try{if(n=a0(s0(r.next,r.iterator)),!n.done)return n.value;this.inner=null}catch(i){l0(t,"throw",i)}if(n=a0(s0(this.next,t)),this.done=!!n.done)return;try{this.inner=lye(e(n.value,this.counter++),!1)}catch(i){l0(t,"throw",i)}}});oye({target:"Iterator",proto:!0,real:!0,forced:oS},{flatMap:function(e){a0(this);try{sye(e)}catch(n){l0(this,"throw",n)}return oS?s0(oS,this,e):new hye(aye(this),{mapper:e,inner:null})}});function dye(t,e,n){fye(t,e),e.set(t,n)}function fye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e,n){return(e=gye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gye(t){var e=mye(t,"string");return typeof e=="symbol"?e:e+""}function mye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1(t,e){return t.get(uV(t,e))}function op(t,e,n){return t.set(uV(t,e),n),n}function uV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap;class No{constructor(e,n,r,i,o,s){Hl(this,"row",void 0),Hl(this,"col",void 0),Hl(this,"rowspan",void 0),Hl(this,"colspan",void 0),Hl(this,"removed",!1),Hl(this,"cellCoordsFactory",void 0),Hl(this,"cellRangeFactory",void 0),dye(this,Nl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ht`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),op(Nl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,op(Nl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return op(Nl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return X1(Nl,this)||op(Nl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),X1(Nl,this)}}function pye(t,e){wye(t,e),e.add(t)}function wye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sp(t,e,n){return(e=vye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vye(t){var e=yye(t,"string");return typeof e=="symbol"?e:e+""}function yye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var da=new WeakSet;class nv{constructor(e){pye(this,da),sp(this,"plugin",void 0),sp(this,"mergedCells",[]),sp(this,"mergedCellsMatrix",new Map),sp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ht`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){nt(nv.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new No(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Dl(da,this,J1).call(this,a),a):(u&&nt(nv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Dl(da,this,Cye).call(this,r),r):!1}clear(){_(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ye(u,i,i+s-1),d=Ye(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Dl(da,this,ap).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Dl(da,this,ap).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Dl(da,this,ap).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Dl(da,this,ap).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Dl(da,this,J1).call(this,s)})}}function ap(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function J1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Cye(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function sS(t,e,n){return(e=bye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bye(t){var e=Sye(t,"string");return typeof e=="symbol"?e:e+""}function Sye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rye{constructor(e){sS(this,"plugin",void 0),sS(this,"mergedCellsCollection",void 0),sS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=v.col+v.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-v.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-v.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),cn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,v=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-v+1;break;case"left":y="includesHorizontally",C=c-v+1;break;case"down":y="includesVertically",C=h+v-1;break;case"right":y="includesHorizontally",C=h+v-1;break}return _(i,M=>{M[y](C)&&M.isFarther(E,r)&&(E=M)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return _(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:v}=g;return v===h.getWidth()}):!f.every(g=>{let{rowspan:v}=g;return v===h.getHeight()})}}function aS(t,e,n){return(e=Eye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eye(t){var e=Tye(t,"string");return typeof e=="symbol"?e:e+""}function Tye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mye{constructor(e){aS(this,"plugin",void 0),aS(this,"hot",void 0),aS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function _ye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(LT)}return this.getTranslatedPhrase($T)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?No.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function gf(t,e,n){return(e=Pye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pye(t){var e=xye(t,"string");return typeof e=="symbol"?e:e+""}function xye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z1{constructor(e){gf(this,"data",void 0),gf(this,"next",null),gf(this,"prev",null),this.data=e}}class lp{constructor(){gf(this,"first",null),gf(this,"last",null)}push(e){const n=new Z1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new Z1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Iye(t,e){cV(t,e),e.add(t)}function kl(t,e,n){cV(t,e),e.set(t,n)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(rv(t,e))}function Fr(t,e,n){return t.set(rv(t,e),n),n}function rv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap,Eo=new WeakMap,To=new WeakMap,Mo=new WeakMap,u0=new WeakMap,up=new WeakMap,cp=new WeakMap,lS=new WeakSet;class Oye{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Iye(this,lS),kl(this,Ro,new lp),kl(this,Eo,new lp),kl(this,To,null),kl(this,Mo,null),kl(this,u0,null),kl(this,up,null),kl(this,cp,null),Fr(u0,this,n),Fr(up,this,r),Fr(cp,this,i)}getCurrentVerticalNode(){return lt(Mo,this).data}getFirstVerticalNode(){return lt(Eo,this).first.data}getNextVerticalNode(){return lt(Mo,this).next.data}getPrevVerticalNode(){return lt(Mo,this).prev.data}getCurrentHorizontalNode(){return lt(To,this).data}getFirstHorizontalNode(){return lt(Ro,this).first.data}getNextHorizontalNode(){return lt(To,this).next.data}getPrevHorizontalNode(){return lt(To,this).prev.data}setPrevNodeAsActive(){Fr(Mo,this,lt(Mo,this).prev),Fr(To,this,lt(To,this).prev)}setNextNodeAsActive(){Fr(Mo,this,lt(Mo,this).next),Fr(To,this,lt(To,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Fr(Ro,this,new lp);for(let s=n.row;s<=r.row;s++)if(!lt(up,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(lt(cp,this).isHidden(a))continue;const l=rv(lS,this,Q1).call(this,e,lt(Ro,this),i,s,a);l&&Fr(To,this,l)}lt(Ro,this).first&&(lt(Ro,this).first.prev=lt(Ro,this).last,lt(Ro,this).last.next=lt(Ro,this).first);const o=new WeakSet;Fr(Eo,this,new lp);for(let s=n.col;s<=r.col;s++)if(!lt(cp,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(lt(up,this).isHidden(a))continue;const l=rv(lS,this,Q1).call(this,e,lt(Eo,this),o,a,s);l&&Fr(Mo,this,l)}lt(Eo,this).first&&(lt(Eo,this).first.prev=lt(Eo,this).last,lt(Eo,this).last.next=lt(Eo,this).first)}setActiveNode(e,n){return lt(Ro,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(To,this,r),!1}),lt(Eo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Fr(Mo,this,r),!1}),this}}function Q1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=lt(u0,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function hV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Aye(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!De(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Af()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[v,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(Af()&&d===0&&!e.getSettings().rowHeaders){const V=hV(e,h,g);i.set(l,V/g)}const C=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),x=v-C+1,P=y-M+1;let T=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(E){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(T=Math.max(T,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const G=Math.min(g,x),U=Math.min(f,P);T===l&&O===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Hye(t,e){dV(t,e),e.add(t)}function hp(t,e,n){dV(t,e),e.set(t,n)}function dV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uS(t,e,n){return(e=Nye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nye(t){var e=Dye(t,"string");return typeof e=="symbol"?e:e+""}function Dye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zf(t,e,n){return t.set(dt(t,e),n),n}function yt(t,e){return t.get(dt(t,e))}function dt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const c0="mergeCells",kye=150,eA=c0;var vi=new WeakMap,Ci=new WeakMap,Bo=new WeakMap,tA=new WeakMap,wt=new WeakSet;class $ye extends qe{constructor(){super(...arguments),Hye(this,wt),uS(this,"mergedCellsCollection",null),uS(this,"autofillCalculations",null),uS(this,"selectionCalculations",null),hp(this,vi,null),hp(this,Ci,{row:0,col:0}),hp(this,Bo,new Oye({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),hp(this,tA,Aye(this))}static get PLUGIN_KEY(){return c0}static get PLUGIN_PRIORITY(){return kye}static get DEFAULT_SETTINGS(){return{[AL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[c0]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new nv(this),this.autofillCalculations=new Rye(this),this.selectionCalculations=new Mye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Lye).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Vye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Bye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Wye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,jye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,rA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,rA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,zye).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Yye).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Gye).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,nA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,nA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Fye).call(e,...r)}),this.addHook("afterRenderer",function(){return yt(tA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Uye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Kye).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,qye).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Xye).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Jye).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Zye).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,Qye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,eCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,tCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,nCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,rCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,iCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,oCe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,sCe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dt(wt,e,aCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!$E())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=xf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=xf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?No.containsNegativeValues(e)?(nt(No.NEGATIVE_VALUES_WARNING(e)),!1):No.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(nt(No.IS_OUT_OF_BOUNDS_WARNING(e)),!1):No.isSingleCell(e)?(nt(No.IS_SINGLE_CELL(e)),!1):No.containsZeroSpan(e)?(nt(No.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),_(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:eA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(De(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(De(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Lye(){this.generateFromSettings(),this.hot.render()}function Fye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Vye(t){yt(Ci,this).row=t.row,yt(Ci,this).col=t.col}function Bye(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;yt(vi,this)&&(i.getRenderableFromVisualIndex(yt(vi,this).row)!==null&&(n.row=yt(vi,this).row),r.getRenderableFromVisualIndex(yt(vi,this).col)!==null&&(n.col=yt(vi,this).col),zf(vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Wye(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function jye(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){zf(vi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);zf(vi,this,e.clone()),n&&e.assign(n)}function nA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ye(g,u,h),Ye(v,c,d),Ye(this.hot.getLastRenderedVisibleRow(),u,h),Ye(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Uye(t){t.items.push({name:"---------"},_ye(this))}function rA(){zf(vi,this,null)}function zye(){if(yt(vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=yt(vi,this).clone().normalize();yt(Bo,this).setActiveNode(r.row,r.col),yt(Ci,this).row>0||yt(Ci,this).col>0?yt(Bo,this).setPrevNodeAsActive():(n==="E-W"&&yt(Ci,this).col<0||e==="S-N"&&yt(Ci,this).row<0)&&yt(Bo,this).setNextNodeAsActive()}function Yye(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(yt(Ci,this).col<0){const{rowEnd:a,colEnd:l}=yt(Bo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(yt(Ci,this).col>0){const{rowStart:a,colStart:l}=yt(Bo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(yt(Ci,this).row<0){const{rowEnd:a,colEnd:l}=yt(Bo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(yt(Ci,this).row>0){const{rowStart:a,colStart:l}=yt(Bo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}yt(Bo,this).setActiveNode(t,e),zf(Ci,this,{row:0,col:0})}function Gye(){this.hot.getSelectedRangeLast().isHeader()||yt(Bo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Kye(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function qye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Xye(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Jye(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Zye(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Qye(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function eCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function tCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function nCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function rCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);_(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function iCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function oCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function sCe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function aCe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,hV(this.hot,e,g))}),t}function lCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:WL(u.type))(l,u,d)(c,h);if(g===Yo){const v=a+1;if(typeof e[v]<"u")return s(v)}return g}(0)}}const fV="sort";function uCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${fV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function cCe(t){const e=t.className.split(" "),n=new RegExp(`^${fV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function hCe(t,e,n){return(e=dCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dCe(t){var e=fCe(t,"string");return typeof e=="symbol"?e:e+""}function fCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iv="multiColumnSorting",gCe=170,iA=iv;BL(iv,lCe);class mCe extends JL{constructor(){super(...arguments),hCe(this,"pluginKey",iv)}static get PLUGIN_KEY(){return iv}static get PLUGIN_PRIORITY(){return gCe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Fw)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Xa,position:"before",group:iA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),we(e,cCe(e)),this.enabled!==!1&&q(e,uCe(...r))}onAfterOnCellMouseDown(e,n){f_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Fw))):this.sort(this.getColumnNextConfig(n.col)))}}function oA(t,e,n){return(e=pCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pCe(t){var e=wCe(t,"string");return typeof e=="symbol"?e:e+""}function wCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vCe="multipleSelectionHandles",yCe=160;class CCe extends qe{constructor(){super(...arguments),oA(this,"dragged",[]),oA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return vCe}static get PLUGIN_PRIORITY(){return yCe}isEnabled(){return jo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function h0(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function gV(){return{label:"",isPlaceholder:!0}}function bCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;_(t,i=>{const o=[];let s=0;n.push(o),_(i,a=>{const l=h0();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Tt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Tt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(gV());return!u})});const r=Math.max(...Ue(n,i=>i.length));return _(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>h0());i.splice(i.length,0,...o)}}),n}function cS(t,e,n){SCe(t,e),e.set(t,n)}function SCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e){return t.get(mV(t,e))}function Td(t,e,n){return t.set(mV(t,e),n),n}function mV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sA=["label","collapsible"];var ws=new WeakMap,$l=new WeakMap,hS=new WeakMap;class RCe{constructor(){cS(this,ws,[]),cS(this,$l,0),cS(this,hS,1/0)}setColumnsLimit(e){Td(hS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Td(ws,this,bCe(e,Fi(hS,this))),Td($l,this,Fi(ws,this).length)}getData(){return Fi(ws,this)}mergeWith(e){_(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&cn(s,o,sA)})}map(e){_(Fi(ws,this),n=>{_(n,r=>{const i=e({...r});De(i)&&cn(r,i,sA)})})}getHeaderSettings(e,n){var r;if(e>=Fi($l,this)||e<0)return null;const i=Fi(ws,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Fi($l,this)||e<0)return i;const o=Fi(ws,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Fi($l,this)}getColumnsCount(){return Fi($l,this)>0?Fi(ws,this)[0].length:0}clear(){Td(ws,this,[]),Td($l,this,0)}}function dS(t,e,n){return(e=ECe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ECe(t){var e=TCe(t,"string");return typeof e=="symbol"?e:e+""}function TCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pV="DF-pre-order";function wV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=wV.call(this.childs[r],t,e)}return n}const MCe="DF-post-order";function vV(t,e){for(let n=0;n<this.childs.length;n++)if(vV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const yV="BF";function _Ce(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const PCe=yV,aA=new Map([[pV,wV],[MCe,vV],[yV,_Ce]]);class ov{constructor(e){dS(this,"data",{}),dS(this,"parent",null),dS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new ov({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PCe;if(!aA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);aA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function fS(t,e,n){xCe(t,e),e.set(t,n)}function xCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){return t.get(CV(t,e))}function ICe(t,e,n){return t.set(CV(t,e),n),n}function CV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fc=new WeakMap,Ll=new WeakMap,gc=new WeakMap;class OCe{constructor(e){fS(this,fc,new Map),fS(this,Ll,new Map),fS(this,gc,null),ICe(gc,this,e)}getRoots(){return Array.from(ir(fc,this).values())}getRootByColumn(e){let n;return ir(Ll,this).has(e)&&(n=ir(fc,this).get(ir(Ll,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ir(Ll,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ir(Ll,this).clear(),_(ir(fc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ir(Ll,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ir(gc,this).getColumnsCount();let n=0;for(;n<e;){const r=ir(gc,this).getHeaderSettings(0,n),i=new ov;ir(fc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ir(gc,this).getHeadersSettings(r,n,i);r+=1,_(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new ov(a),e.addChild(l)),r<ir(gc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ir(fc,this).clear(),ir(Ll,this).clear()}}function bV(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function sv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function av(t){return sv(t,"origColspan")===t.data.origColspan}function P_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(av(t))return P_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)_(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,bV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):av(a)&&(l.isCollapsed=sv(a,"isCollapsed"))}),{rollbackModification:()=>x_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function x_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(av(t))return x_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)_(o,l=>{bV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=sv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):av(l)&&(u.isCollapsed=sv(l,"isCollapsed"))}),{rollbackModification:()=>P_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function ACe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function HCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const lA=new Map([["collapse",x_],["expand",P_],["hide-column",ACe],["show-column",HCe]]);function NCe(t,e,n){if(!lA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return lA.get(t)(e,n)}function dp(t){const e=[];return _(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=kCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(gV());else{const f=DCe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function DCe(t){const{crossHiddenColumns:e,...n}=h0(t);return n}function kCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function gS(t,e,n){$Ce(t,e),e.set(t,n)}function $Ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Md(t,e,n){return t.set(SV(t,e),n),n}function Vt(t,e){return t.get(SV(t,e))}function SV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _o=new WeakMap,br=new WeakMap,Fl=new WeakMap;class LCe{constructor(){gS(this,_o,new RCe),gS(this,br,new OCe(Vt(_o,this))),gS(this,Fl,[[]])}setState(e){Vt(_o,this).setData(e);let n=!1;try{Vt(br,this).buildTree()}catch{Vt(br,this).clear(),Vt(_o,this).clear(),n=!0}return Md(Fl,this,dp(Vt(br,this).getRoots())),n}setColumnsLimit(e){Vt(_o,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Vt(_o,this).mergeWith(n),Vt(br,this).buildTree(),Md(Fl,this,dp(Vt(br,this).getRoots()))}mapState(e){Vt(_o,this).map(e),Vt(br,this).buildTree(),Md(Fl,this,dp(Vt(br,this).getRoots()))}mapNodes(e){return Sn(Vt(br,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Vt(br,this).getNode(n,r);let o;return i&&(o=NCe(e,i,r),Md(Fl,this,dp(Vt(br,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Vt(Fl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Vt(br,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Vt(br,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},pV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(_o,this).getLayersCount()}getColumnsCount(){return Vt(_o,this).getColumnsCount()}clear(){Md(Fl,this,[]),Vt(_o,this).clear(),Vt(br,this).clear()}}function _d(t,e,n){return(e=FCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FCe(t){var e=VCe(t,"string");return typeof e=="symbol"?e:e+""}function VCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BCe{constructor(e,n){_d(this,"hot",void 0),_d(this,"nestedHeaderSettingsGetter",void 0),_d(this,"layersCount",0),_d(this,"container",void 0),_d(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),xu(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function WCe(t,e){RV(t,e),e.add(t)}function uA(t,e,n){return(e=jCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jCe(t){var e=UCe(t,"string");return typeof e=="symbol"?e:e+""}function UCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pd(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,n){return t.set(Bt(t,e),n),n}function je(t,e){return t.get(Bt(t,e))}function Bt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cA="nestedHeaders",zCe=280;var gt=new WeakMap,fa=new WeakMap,mf=new WeakMap,Cy=new WeakMap,lv=new WeakMap,Kt=new WeakSet;class YCe extends qe{constructor(){super(...arguments),WCe(this,Kt),Pd(this,gt,new LCe),Pd(this,fa,null),Pd(this,mf,null),Pd(this,Cy,!1),Pd(this,lv,null),uA(this,"ghostTable",new BCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),uA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return cA}static get PLUGIN_PRIORITY(){return zCe}isEnabled(){return!!this.hot.getSettings()[cA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&nt(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Bt(Kt,this,lbe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ube).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,XCe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,JCe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ZCe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,QCe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ebe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,tbe).call(e,...i)}),this.addHook("afterSelection",()=>Bt(Kt,this,fp).call(this)),this.addHook("afterSelectionFocusSet",()=>Bt(Kt,this,fp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,GCe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Bt(Kt,this,rbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,obe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,sbe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,KCe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,qCe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,nbe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,ibe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Bt(Kt,e,abe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Bt(Kt,this,fp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Bt(Kt,this,fp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();je(gt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=je(gt,this).setState(e)),this.detectedOverlappedHeaders&&nt(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";je(gt,this).triggerColumnModification(i,r)}),!je(fa,this)&&this.enabled&&$s(fa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";je(gt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),je(gt,this).clear(),je(fa,this).unsubscribe(),$s(fa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return je(gt,this)}getLayersCount(){return je(gt,this).getLayersCount()}getHeaderSettings(e,n){return je(gt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),we(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),we(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),we(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),we(o,"hiddenHeader"),we(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=je(gt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,v,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),M=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const P=C||M?Math.min(c,r-i):c;P>1&&o.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(we(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=je(gt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){$s(gt,this,null),je(fa,this)!==null&&(je(fa,this).unsubscribe(),$s(fa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return je(gt,this).getHeaderTreeNodeData(e.row,e.col)}}function fp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=je(gt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function GCe(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=je(lv,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if($s(lv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=je(gt,this).findLeftMostColumnIndex(a,l),g=je(gt,this).findRightMostColumnIndex(a,l),v=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?v>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(v>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function KCe(t,e,n){const r=je(gt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=je(gt,this).getHeaderSettings(e,t);if(o===tT){if(!a)return r.columnIndex}else if(o===R$&&(l>s-i||!a))return null;return t}function qCe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,v=d-a;if(v===0)continue;((i=je(gt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][v]="")}}}function XCe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function JCe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;$s(mf,this,e.clone()),$s(Cy,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(jv(t)||Ua(t)&&l||Xk(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function ZCe(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ye(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function QCe(){$s(Cy,this,!1)}function ebe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!je(Cy,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=je(gt,this).getHeaderTreeNodeData(je(mf,this).row,je(mf,this).col);if(e.setHighlight(je(mf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=je(gt,this).findTopMostEntireHeaderLevel(Ye(n,i,i+o-1),Ye(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function tbe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=je(gt,this).findLeftMostColumnIndex(n.row,n.col),o=je(gt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function nbe(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});$s(lv,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function rbe(t){if(je(gt,this).getLayersCount()>0){t.length=0;for(let e=0;e<je(gt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function ibe(t){const e=je(gt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=je(gt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Gn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?je(gt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function obe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function sbe(t,e,n){var r;const{label:i}=(r=je(gt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function abe(t,e){if(t<0)return this.hot.getCell(t,je(gt,this).findLeftMostColumnIndex(t,e),!0)}function lbe(){this.updatePlugin()}function ube(t,e){e||this.updatePlugin()}function xd(t,e,n){return(e=cbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cbe(t){var e=hbe(t,"string");return typeof e=="symbol"?e:e+""}function hbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dbe{constructor(e,n){xd(this,"hot",void 0),xd(this,"data",null),xd(this,"plugin",void 0),xd(this,"parentReference",new WeakMap),xd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&_(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&_(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(_(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];_(r,o=>{i.push(this.getDataObject(o))}),_(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function hA(t,e,n){return(e=fbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:e+""}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_{constructor(e,n){hA(this,"hot",void 0),hA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class $o extends I_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(_(l,c=>{c&&s.removeChild(c)}),q(n,$o.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,$o.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[_u()]),q(n,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),u&&be(n,[bi(!1)])):(q(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),u&&be(n,[bi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class mbe extends I_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),_(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&_(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&_(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&_(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,$o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ii(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function pbe(t,e,n){wbe(t,e),e.set(t,n)}function wbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vbe(t,e,n){return(e=ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ybe(t){var e=Cbe(t,"string");return typeof e=="symbol"?e:e+""}function Cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bbe(t,e){return t.get(Sbe(t,e))}function Sbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dA=new WeakMap;class Rbe extends I_{constructor(){super(...arguments),vbe(this,"dataManager",this.plugin.dataManager),pbe(this,dA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(rM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(iM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return _(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=bbe(dA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function gp(t,e,n){return(e=Ebe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ebe(t){var e=Tbe(t,"string");return typeof e=="symbol"?e:e+""}function Tbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mbe{constructor(e){gp(this,"plugin",void 0),gp(this,"hot",void 0),gp(this,"dataManager",void 0),gp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ht(i)&&(nt(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function _be(t,e){EV(t,e),e.add(t)}function fA(t,e,n){EV(t,e),e.set(t,n)}function EV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mS(t,e,n){return(e=Pbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pbe(t){var e=xbe(t,"string");return typeof e=="symbol"?e:e+""}function xbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jp(t,e){return t.get(Tn(t,e))}function uv(t,e,n){return t.set(Tn(t,e),n),n}function Tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cv="nestedRows",Ibe=300,gA=cv,Obe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var by=new WeakMap,mc=new WeakMap,On=new WeakSet;class Abe extends qe{constructor(){super(...arguments),_be(this,On),mS(this,"dataManager",null),mS(this,"headersUI",null),mS(this,"collapsedRowsMap",null),fA(this,by,!1),fA(this,mc,!1)}static get PLUGIN_KEY(){return cv}static get PLUGIN_PRIORITY(){return Ibe}isEnabled(){return!!this.hot.getSettings()[cv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Cg),this.dataManager=new dbe(this,this.hot),this.collapsingUI=new mbe(this,this.hot),this.headersUI=new $o(this,this.hot),this.contextMenuUI=new Rbe(this,this.hot),this.rowMoveController=new Mbe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Ybe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Gbe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Dbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,kbe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,$be).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Nbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Vbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Fbe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Bbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Wbe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,jbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Ube).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Lbe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,zbe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tn(On,e,Hbe).call(e,...r)}),this.addHook("beforeLoadData",n=>Tn(On,this,mA).call(this,n)),this.addHook("beforeUpdateData",n=>Tn(On,this,mA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:gA,relativeToGroup:Xa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gA)}disableCoreAPIModifiers(){uv(mc,this,!0)}enableCoreAPIModifiers(){uv(mc,this,!1)}onModifyRowData(e){if(!Jp(mc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Jp(mc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Jp(mc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Hbe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Nbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Dbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),uv(by,this,!0),this.dataManager.getData().slice()}function kbe(t){return this.contextMenuUI.appendOptions(t)}function $be(t,e){this.headersUI.appendLevelIndicators(t,e)}function Lbe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Fbe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{uv(by,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Vbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Bbe(){this.collapsingUI.collapsedRowsStash.stash()}function Wbe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function jbe(){this.collapsingUI.collapsedRowsStash.stash()}function Ube(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function zbe(){this.dataManager.rewriteCache()}function Ybe(){this.headersUI.updateRowHeaderWidth()}function Gbe(t,e){Jp(by,this)&&(e.skipRender=!0)}function mA(t){if(!N$(t)){BE(Obe),this.hot.getSettings()[cv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function pS(t,e,n){return(e=Kbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kbe(t){var e=qbe(t,"string");return typeof e=="symbol"?e:e+""}function qbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xbe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;pS(this,"rootWindow",void 0),pS(this,"prefix",void 0),pS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){_(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Jbe(t,e,n){return(e=Zbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zbe(t){var e=Qbe(t,"string");return typeof e=="symbol"?e:e+""}function Qbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const pA="persistentState",eSe=0;class tSe extends qe{constructor(){super(...arguments),Jbe(this,"storage",void 0)}static get PLUGIN_KEY(){return pA}static get PLUGIN_PRIORITY(){return eSe}isEnabled(){return!!this.hot.getSettings()[pA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Xbe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function nSe(t,e){rSe(t,e),e.add(t)}function rSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wS(t,e,n){return(e=iSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vS="search",sSe=190,aSe="htSearchResult",lSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},uSe=function(t,e,n){return Ht(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ht(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var yS=new WeakSet;class cSe extends qe{constructor(){super(...arguments),nSe(this,yS),wS(this,"callback",lSe),wS(this,"queryMethod",uSe),wS(this,"searchResultClass",aSe)}static get PLUGIN_KEY(){return vS}static get PLUGIN_PRIORITY(){return sSe}isEnabled(){return this.hot.getSettings()[vS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[vS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wA(yS,e,vA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wA(yS,e,vA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function vA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function mp(t,e,n){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hSe(t){var e=dSe(t,"string");return typeof e=="symbol"?e:e+""}function dSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TV{constructor(e){mp(this,"viewportWidth",void 0),mp(this,"overwriteColumnWidthFn",void 0),mp(this,"baseWidths",new Map),mp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class fSe extends TV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=Zc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=Zc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,v=g;o.includes(f)||(v=Math.round(g*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function yA(t,e,n){gSe(t,e),e.set(t,n)}function gSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e){return t.get(MV(t,e))}function pp(t,e,n){return t.set(MV(t,e),n),n}function MV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wp=new WeakMap,Id=new WeakMap;class mSe extends TV{constructor(){super(...arguments),yA(this,wp,0),yA(this,Id,-1)}prepare(e){super.prepare(e),pp(wp,this,0),pp(Id,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),pp(Id,this,e),pp(wp,this,n)}calculate(){if(CS(Id,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+CS(wp,this),0);this.stretchedWidths.set(CS(Id,this),n)}}function pSe(t,e){_V(t,e),e.add(t)}function vp(t,e,n){_V(t,e),e.set(t,n)}function _V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(Hc(t,e))}function bS(t,e,n){return t.set(Hc(t,e),n),n}function Hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wSe="stretchColumns";var Yn=new WeakMap,pc=new WeakMap,SS=new WeakMap,yp=new WeakMap,Od=new WeakSet;class vSe{constructor(e){pSe(this,Od),vp(this,Yn,void 0),vp(this,pc,void 0),vp(this,SS,new Map([["all",new fSe(Hc(Od,this,CA).bind(this))],["last",new mSe(Hc(Od,this,CA).bind(this))]])),vp(this,yp,"none"),bS(Yn,this,e),bS(pc,this,qt(Yn,this).columnIndexMapper.createAndRegisterIndexMap(wSe,"physicalIndexToValue"))}useStrategy(e){bS(yp,this,qt(SS,this).has(e)?e:"none")}refreshStretching(){if(qt(yp,this)==="none"){qt(pc,this).clear();return}qt(Yn,this).batchExecution(()=>{qt(pc,this).clear();const e=qt(SS,this).get(qt(yp,this));let r=qt(Yn,this).view.getViewportWidth();Hc(Od,this,ySe).call(this)&&(r-=_n(qt(Yn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<qt(Yn,this).countCols();i++)qt(Yn,this).columnIndexMapper.isHidden(qt(Yn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Hc(Od,this,CSe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;qt(pc,this).setValueAtIndex(qt(Yn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return qt(pc,this).getValueAtIndex(qt(Yn,this).toPhysicalColumn(e))}}function ySe(){const{view:t}=qt(Yn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=qt(Yn,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=qt(Yn,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function CSe(t){var e;return(e=qt(Yn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Zc}function CA(t,e){return qt(Yn,this).runHooks("beforeStretchingColumnWidth",t,e)}function bSe(t,e){PV(t,e),e.add(t)}function RS(t,e,n){PV(t,e),e.set(t,n)}function PV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ES(t,e,n){return t.set(hv(t,e),n),n}function Rs(t,e){return t.get(hv(t,e))}function hv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SSe="stretchColumns",RSe=155;var Tc=new WeakMap,Cp=new WeakMap,Ad=new WeakMap,TS=new WeakSet;class ESe extends qe{constructor(){super(...arguments),bSe(this,TS),RS(this,Tc,new vSe(this.hot)),RS(this,Cp,null),RS(this,Ad,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Rs(Cp,this)!==null&&Rs(Cp,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),ES(Cp,this,i.width)})})}))}static get PLUGIN_KEY(){return SSe}static get PLUGIN_PRIORITY(){return RSe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Rs(Tc,this).useStrategy(this.hot.getSettings().stretchH),Rs(Ad,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hv(TS,e,MSe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hv(TS,e,TSe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Rs(Tc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Rs(Ad,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Rs(Tc,this).getStretchedWidth(e)}destroy(){Rs(Ad,this).disconnect(),ES(Ad,this,null),ES(Tc,this,null),super.destroy()}}function TSe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function MSe(t){t&&Rs(Tc,this).refreshStretching()}function _Se(t,e){PSe(t,e),e.add(t)}function PSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bp(t,e,n){return(e=xSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xSe(t){var e=ISe(t,"string");return typeof e=="symbol"?e:e+""}function ISe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OSe="touchScroll",ASe=200;var Sp=new WeakSet;class HSe extends qe{constructor(){super(...arguments),_Se(this,Sp),bp(this,"scrollbars",[]),bp(this,"clones",[]),bp(this,"lockedCollection",!1),bp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return OSe}static get PLUGIN_PRIORITY(){return ASe}static get SETTING_KEYS(){return!0}isEnabled(){return kE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>MS(Sp,this,NSe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>MS(Sp,this,DSe).call(this)),this.addHook("afterMomentumScroll",()=>MS(Sp,this,kSe).call(this))}}function NSe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function DSe(){this.freezeOverlays=!0,_(this.clones,t=>{q(t,"hide-tween")})}function kSe(){this.freezeOverlays=!1,_(this.clones,t=>{we(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{_(this.clones,t=>{we(t,"show-tween")})},400),_(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function $Se(t,e){LSe(t,e),e.add(t)}function LSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FSe(t,e,n){return(e=VSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VSe(t){var e=BSe(t,"string");return typeof e=="symbol"?e:e+""}function BSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WSe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zp="trimRows",jSe=330;var bA=new WeakSet;class USe extends qe{constructor(){super(...arguments),$Se(this,bA),FSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Zp}static get PLUGIN_PRIORITY(){return jSe}isEnabled(){return!!this.hot.getSettings()[Zp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Cg),this.trimmedRowsMap.addLocalHook("init",()=>WSe(bA,this,zSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Zp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),_(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(_(e,l=>{o[l]=!1}),i=Sn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function zSe(){const t=this.hot.getSettings()[Zp];Array.isArray(t)&&this.hot.batchExecution(()=>{_(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function YSe(t,e,n){return(e=GSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:e+""}function KSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oi{constructor(e){YSe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Rp(t,e,n){return(e=qSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qSe(t){var e=XSe(t,"string");return typeof e=="symbol"?e:e+""}function XSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends Oi{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Rp(this,"stateBefore",void 0),Rp(this,"range",void 0),Rp(this,"type",void 0),Rp(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new O_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){_(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){pa(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function SA(t,e,n){return(e=JSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=ZSe(t,"string");return typeof e=="symbol"?e:e+""}function ZSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A_ extends Oi{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),SA(this,"columns",void 0),SA(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new A_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),M_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function RA(t,e,n){return(e=QSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QSe(t){var e=eRe(t,"string");return typeof e=="symbol"?e:e+""}function eRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H_ extends Oi{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),RA(this,"previousSortState",void 0),RA(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new H_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function EA(t,e,n){return(e=tRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tRe(t){var e=nRe(t,"string");return typeof e=="symbol"?e:e+""}function nRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_ extends Oi{constructor(e){let{index:n,amount:r}=e;super("insert_col"),EA(this,"index",void 0),EA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new N_({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function TA(t,e,n){return(e=rRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rRe(t){var e=iRe(t,"string");return typeof e=="symbol"?e:e+""}function iRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D_ extends Oi{constructor(e){let{index:n,amount:r}=e;super("insert_row"),TA(this,"index",void 0),TA(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new D_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Ep(t,e,n){return(e=oRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oRe(t){var e=sRe(t,"string");return typeof e=="symbol"?e:e+""}function sRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k_ extends Oi{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Ep(this,"changes",void 0),Ep(this,"selected",void 0),Ep(this,"countCols",void 0),Ep(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new k_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Qn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function MA(t,e,n){return(e=aRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aRe(t){var e=lRe(t,"string");return typeof e=="symbol"?e:e+""}function lRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_ extends Oi{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),MA(this,"conditionsStack",void 0),MA(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new $_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function uRe(t,e,n){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cRe(t){var e=hRe(t,"string");return typeof e=="symbol"?e:e+""}function hRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_ extends Oi{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),uRe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new L_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function xV(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function vs(t,e,n){return(e=dRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dRe(t){var e=fRe(t,"string");return typeof e=="symbol"?e:e+""}function fRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F_ extends Oi{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),vs(this,"index",void 0),vs(this,"indexes",void 0),vs(this,"data",void 0),vs(this,"amount",void 0),vs(this,"headers",void 0),vs(this,"columnPositions",void 0),vs(this,"rowPositions",void 0),vs(this,"fixedColumnsStart",void 0),vs(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const v=[],y=l[g];fe(u,c,E=>{v.push(y[e.toPhysicalColumn(E)])}),h.push(v)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new F_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:xV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ue(this.data[c],o));const l=Ue(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),_(e.getSourceDataArray(),(c,h)=>{_(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&_(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function wc(t,e,n){return(e=gRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gRe(t){var e=mRe(t,"string");return typeof e=="symbol"?e:e+""}function mRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_ extends Oi{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),wc(this,"index",void 0),wc(this,"data",void 0),wc(this,"fixedRowsBottom",void 0),wc(this,"fixedRowsTop",void 0),wc(this,"rowIndexesSequence",void 0),wc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new V_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:xV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function _A(t,e,n){return(e=pRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pRe(t){var e=wRe(t,"string");return typeof e=="symbol"?e:e+""}function wRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B_ extends Oi{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),_A(this,"rows",void 0),_A(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new B_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),M_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function vRe(t,e,n){return(e=yRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yRe(t){var e=CRe(t,"string");return typeof e=="symbol"?e:e+""}function CRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_ extends Oi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),vRe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new W_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function bRe(t,e){[O_,A_,H_,N_,D_,k_,$_,L_,F_,V_,B_,W_].forEach(n=>n.startRegisteringEvents(t,e))}function SRe(t,e){RRe(t,e),e.add(t)}function RRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _S(t,e,n){return(e=ERe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ERe(t){var e=TRe(t,"string");return typeof e=="symbol"?e:e+""}function TRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PA="undoRedo",MRe="undoRedo",_Re=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const xA=new Set;var Tp=new WeakSet;class PRe extends qe{static get PLUGIN_KEY(){return MRe}static get PLUGIN_PRIORITY(){return _Re}static get SETTING_KEYS(){return!0}constructor(e){super(e),SRe(this,Tp),_S(this,"doneActions",[]),_S(this,"undoneActions",[]),_S(this,"ignoreNewActions",!1),bRe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return PS(Tp,e,xRe).call(e,...r)}),this.registerShortcuts(),PS(Tp,this,IRe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),PS(Tp,this,ORe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:PA};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PA)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function xRe(t,e){e==="loadData"&&this.clear()}function IRe(){const t=e=>{xA.has(e)||(nt(ht`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),xA.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function ORe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function ARe(){Ke(Qd),Ke(Lue),Ke(ef),Ke(mce),Ke(Rce),Ke(JL),Ke(vhe),Ke(nde),Ke(gy),Ke(hfe),Ke($fe),Ke(zfe),Ke(wy),Ke(_ge),Ke(Spe),Ke(twe),Ke(Pwe),Ke(Vwe),Ke(Zwe),Ke(uve),Ke(yve),Ke($ve),Ke(Yve),Ke($ye),Ke(mCe),Ke(CCe),Ke(YCe),Ke(Abe),Ke(tSe),Ke(cSe),Ke(ESe),Ke(HSe),Ke(USe),Ke(PRe)}function HRe(){lae(),Ole(),Vle(),sue(),ARe()}function NRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var xS,IS,OS,AS,HS;HRe();NRe(Te);Te.__GhostTable=c_;Te._getListenersCounter=uZ;Te._getRegisteredMapsCounter=xre;Te.EventManager=Ei;const DRe=[h8,yJ,lre,Hle,pJ,Q8,m8,aQ,mJ,w8,SJ,sQ],kRe=[q8,RJ];Te.helper={};Te.dom={};_(DRe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.helper[e]=t[e])})});_(kRe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Te.dom[e]=t[e])})});Te.cellTypes=(xS=Te.cellTypes)!==null&&xS!==void 0?xS:{};_(Nie(),t=>{Te.cellTypes[t]=jM(t)});Te.cellTypes.registerCellType=ci;Te.cellTypes.getCellType=jM;Te.editors=(IS=Te.editors)!==null&&IS!==void 0?IS:{};_(rZ(),t=>{Te.editors[`${Zn(t)}Editor`]=_w(t)});Te.editors.registerEditor=Mr;Te.editors.getEditor=_w;Te.renderers=(OS=Te.renderers)!==null&&OS!==void 0?OS:{};_(SQ(),t=>{const e=Pw(t);t==="base"&&(Te.renderers.cellDecorator=e),Te.renderers[`${Zn(t)}Renderer`]=e});Te.renderers.registerRenderer=Wr;Te.renderers.getRenderer=Pw;Te.validators=(AS=Te.validators)!==null&&AS!==void 0?AS:{};_(TQ(),t=>{Te.validators[`${Zn(t)}Validator`]=KE(t)});Te.validators.registerValidator=Gl;Te.validators.getValidator=KE;Te.plugins=(HS=Te.plugins)!==null&&HS!==void 0?HS:{};_(GE(),t=>{Te.plugins[t]=pg(t)});Te.plugins[`${Zn(qe.PLUGIN_KEY)}Plugin`]=qe;Te.plugins.registerPlugin=Ke;Te.plugins.getPlugin=pg;let pf=null,rn=new Map,Mc={row:-1,col:-1,time:0};function ys(t,e,n,r=!1,i){let o=String(t),s={isDrillable:!1,drillPath:null,originalKey:String(n),originalValue:t,readOnly:r};const a=()=>{if(n===""||n===null||n===void 0)return e;if(!e){const u=i.getObjectByPathCallback(i.rootJsonData,"");return Array.isArray(u)?`[${n}]`:String(n)}const l=i.getObjectByPathCallback(i.rootJsonData,e);return Array.isArray(l)?`${e}[${n}]`:`${e}.${n}`};return t===void 0?(o="undefined",s.readOnly=!1):typeof t=="object"&&t!==null?(o=Array.isArray(t)?`[Array (${t.length})]`:"{Object}",s.isDrillable=!0,s.drillPath=a(),s.readOnly=!0):t===null?(o="null",s.readOnly=!1):(o=String(t),!r&&!s.isDrillable&&(s.readOnly=!1)),r&&(s.readOnly=!0),{displayValue:o,cellMeta:s}}function ui(t,e,n){let r=[],i=!0,o=new Map;const s={rootJsonData:n.rootJsonData,getObjectByPathCallback:n.getObjectByPathCallback},a=n.dataPathString||"";if(Array.isArray(t)){const l=t.length>0?t[0]:null;if(l&&typeof l=="object"&&l!==null&&!Array.isArray(l)){let u=Object.keys(l);if(u.length===0){for(let c=1;c<t.length;c++)if(t[c]&&typeof t[c]=="object"&&Object.keys(t[c]).length>0){u=Object.keys(t[c]);break}}i=u.length>0?u:t.length>0?["(내용 없음)"]:["새 열"],t.forEach((c,h)=>{const d=[],f=typeof c=="object"&&c!==null?c:{};i.forEach((g,v)=>{const y=f[g],E=`${a}[${h}]`,{displayValue:C,cellMeta:M}=ys(y,E,g,!1,s);d.push(C),o.set(`${h}-${v}`,M)}),r.push(d)}),t.length===0&&Array.isArray(i)&&i.length===1&&(i[0]==="새 열"||i[0]==="(내용 없음)"||i[0])}else i=["Index","Value"],r=t.map((u,c)=>{const h=a,{displayValue:d,cellMeta:f}=ys(c,h,String(c),!0,s),{displayValue:g,cellMeta:v}=ys(u,h,String(c),!1,s);return o.set(`${c}-0`,f),o.set(`${c}-1`,v),[d,g]})}else if(typeof t=="object"&&t!==null){const l=Object.keys(t);if(l.length>0&&l.every(c=>Array.isArray(t[c]))){let c=0;l.forEach(d=>{c=Math.max(c,t[d].length)});const h=["항목 (Key)"];for(let d=0;d<c;d++)h.push(String(d));i=h,r=l.map((d,f)=>{const g=t[d],v=[],y=a,{displayValue:E,cellMeta:C}=ys(d,y,d,!0,s);v.push(E),o.set(`${f}-0`,C);for(let M=0;M<c;M++)if(M<g.length){const x=g[M],P=`${a?a+".":""}${d}`,{displayValue:T,cellMeta:O}=ys(x,P,String(M),!1,s);v.push(T),o.set(`${f}-${1+M}`,O)}else v.push(""),o.set(`${f}-${1+M}`,{readOnly:!0,originalValue:null,isPadding:!0});return v})}else i=["항목 (Key)","값 (Value)"],r=l.map((c,h)=>{const d=t[c],f=a,{displayValue:g,cellMeta:v}=ys(c,f,c,!0,s),{displayValue:y,cellMeta:E}=ys(d,f,c,!1,s);return o.set(`${h}-0`,v),o.set(`${h}-1`,E),[g,y]})}else{i=["항목","값"];const l=e||(t==null?String(t):"Value"),u=a,{displayValue:c,cellMeta:h}=ys(l,u,"",!0,s),{displayValue:d,cellMeta:f}=ys(t,u,"",!1,s);o.set("0-0",h),o.set("0-1",f),r=[[c,d]]}return{preparedHotData:r,preparedColHeaders:i,preparedCellMetaMap:o}}function IV(){return pf&&(pf.destroy(),pf=null),rn.clear(),Mc={row:-1,col:-1,time:0},null}function $Re(t,e,n){const r=n.tableViewDomElement;IV(),r&&(r.innerHTML="");const{preparedHotData:i,preparedColHeaders:o,preparedCellMetaMap:s}=ui(t,e,n);return rn=s,r?(pf=new Te(r,{data:i,rowHeaders:!0,colHeaders:o,manualColumnResize:!0,manualRowResize:!0,contextMenu:{items:{view_key_content:{name:"내용 보기 (View Content)",hidden:function(){const l=this.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row;if(u.col!==0||typeof t!="object"||t===null||Array.isArray(t))return!0;const d=Object.keys(t);if(c>=d.length)return!0;const f=d[c],g=t[f];return typeof g!="object"||g===null},callback:function(a,l){const u=this;if(!l||l.length===0||!l[0]||!l[0].start){console.error("View Content callback: 유효하지 않은 selection 객체입니다.",l);return}const h=l[0].start.row,d=Object.keys(t);if(h>=d.length){console.error("View Content callback: 행 인덱스가 범위를 벗어났습니다.",h,d);return}const f=d[h],g=t[f];if(typeof g!="object"||g===null){console.error("View Content callback: 대상 값이 객체나 배열이 아닙니다.",g),tt({title:"오류",text:"내용을 볼 수 있는 대상(객체/배열)이 아닙니다.",icon:"error",showCancelButton:!1,hotInstance:u});return}const v=n.dataPathString||"",y=v?`${v}.${f}`:f;n.displayTableCallback(g,f,n.rootJsonData,y)}},row_above:{name:"위에 행 삽입"},row_below:{name:"아래에 행 삽입"},col_left:{name:"왼쪽에 열 삽입"},col_right:{name:"오른쪽에 열 삽입"},remove_row:{name:"선택한 행 삭제"},remove_col:{name:"선택한 열 삭제"},"---------":Te.plugins.ContextMenu.SEPARATOR,duplicate_row:{name:"선택 행 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)||typeof t=="object"&&t!==null&&!Array.isArray(t)):!0},callback:async function(a,l){const u=this,c=l[0].start.row;if(Array.isArray(t)){if(c>=0&&c<t.length){const h=JSON.parse(JSON.stringify(t[c]));t.splice(c+1,0,h),n.refreshTreeViewCallback("row_duplicated_array_hot");const{preparedHotData:d,preparedColHeaders:f,preparedCellMetaMap:g}=ui(t,e,n);rn=g,u.updateSettings({colHeaders:f}),u.loadData(d)}}else if(typeof t=="object"&&t!==null){const h=Object.keys(t);if(c<0||c>=h.length)return;const d=h[c];let f=d+"_복제본",g=f,v=1;for(;t.hasOwnProperty(g);)g=`${f}_${v++}`;Vl({title:"새 키 입력 (행 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?E!==d&&t.hasOwnProperty(E)?"이미 사용 중인 키입니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim(),C=JSON.parse(JSON.stringify(t[d])),M={};for(const O of Object.keys(t))M[O]=t[O],O===d&&(M[E]=C);Object.keys(t).forEach(O=>delete t[O]),Object.assign(t,M),n.refreshTreeViewCallback("row_duplicated_object_hot_ordered");const{preparedHotData:x,preparedColHeaders:P,preparedCellMetaMap:T}=ui(t,e,n);rn=T,u.updateSettings({colHeaders:P}),u.loadData(x)}})}}},duplicate_col:{name:"선택 열 복제",hidden:function(){return this.getSelectedRangeLast()?!(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])):!0},callback:async function(a,l){const u=this,c=l[0].start.col,h=u.getColHeader();if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!Array.isArray(t[0])&&Array.isArray(h)&&c>=0&&c<h.length){const d=h[c];if(typeof d!="string")return;let f=d+"_복제본",g=f,v=1;for(;t[0].hasOwnProperty(g);)g=`${f}_${v++}`;Vl({title:"새 열 키 입력 (열 복제)",inputValue:g,confirmButtonText:"복제",inputValidator:y=>{const E=y.trim();return E?t.length>0&&t[0].hasOwnProperty(E)&&E!==d?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(E)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:u}).then(y=>{if(y.isConfirmed&&y.value!==void 0){const E=y.value.trim();t.forEach(P=>{if(typeof P=="object"&&P!==null){const T=P.hasOwnProperty(d)?JSON.parse(JSON.stringify(P[d])):null,O={};let G=!1;for(const U in P)P.hasOwnProperty(U)&&(O[U]=P[U],U===d&&(O[E]=T,G=!0));G||(O[E]=T),Object.keys(P).forEach(U=>delete P[U]),Object.assign(P,O)}}),n.refreshTreeViewCallback("col_duplicated_array_obj_hot_ordered");const{preparedHotData:C,preparedColHeaders:M,preparedCellMetaMap:x}=ui(t,e,n);rn=x,u.updateSettings({colHeaders:M}),u.loadData(C)}})}}},set_template:{name:"템플릿 설정",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=rn.get(`${c}-${h}`);if(d&&d.isPadding)return!0;const f=a.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn};return Hd(c,h,g)===null},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col;u&&typeof u.deselectCell=="function"&&u.deselectCell();const f=n.getTemplates();if(!f||f.length===0){tt({title:"알림",text:"사용 가능한 템플릿이 없습니다. 먼저 템플릿을 추가해주세요.",icon:"info",showCancelButton:!1,hotInstance:u});return}const g={};f.forEach((y,E)=>{g[`tpl_idx_${E}`]=y.name});const{value:v}=await yi.fire({title:"템플릿 선택 (Select Template)",input:"select",inputOptions:g,inputPlaceholder:"적용할 템플릿을 선택하세요",showCancelButton:!0,confirmButtonText:"적용 (Apply)",cancelButtonText:"취소 (Cancel)",customClass:{popup:"custom-swal-popup"}});if(v){const y=parseInt(v.replace("tpl_idx_",""),10),E=f[y].value,C=JSON.stringify(E),M=u.getColHeader(),x={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(M)?M:M===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},P=Hd(h,d,x);if(P!==null){n.updateJsonDataCallback(P,C,!1);let T=t;const O=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData;n.dataPathString?T=n.getObjectByPathCallback(O,n.dataPathString):T=O,T===void 0&&(T=P.includes("[")||P.includes(".")?{}:null);const{preparedHotData:G,preparedColHeaders:U,preparedCellMetaMap:V}=ui(T,e,n);rn=V,u.updateSettings({colHeaders:U}),u.loadData(G)}else tt({title:"오류",text:"템플릿을 적용할 수 없는 셀입니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},add_as_template:{name:"템플릿으로 추가",hidden:function(){const a=this,l=a.getSelectedRangeLast();if(!l)return!0;const{from:u}=l,c=u.row,h=u.col,d=a.getColHeader(),f={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(d)?d:d===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},g=Hd(c,h,f);if(g===null)return!0;const v=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,y=n.getObjectByPathCallback(v,g);return!(typeof y=="object"&&y!==null)},callback:async function(a,l){const u=this,c=l[0].start?l[0].start:l[0].from,h=c.row,d=c.col,f=u.getColHeader(),g={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(f)?f:f===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn},v=Hd(h,d,g);if(v===null)return;const y=n.currentJsonDataRef?n.currentJsonDataRef():n.rootJsonData,E=n.getObjectByPathCallback(y,v);if(!(typeof E=="object"&&E!==null)){tt({title:"알림",text:"객체 또는 배열 형식의 값만 템플릿으로 추가할 수 있습니다.",icon:"info",showCancelButton:!1,hotInstance:u});return}u&&typeof u.deselectCell=="function"&&u.deselectCell();const{value:C}=await Vl({title:"새 템플릿 이름 입력",inputLabel:"저장할 템플릿의 이름을 입력하세요:",inputValue:"",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?n.getTemplates().some(T=>T.name===x)?"이미 사용중인 템플릿 이름입니다.":null:"템플릿 이름은 비워둘 수 없습니다."},hotInstance:u});if(C&&C.trim()){const M=Array.isArray(E)?"array":"object",x=n.addTemplate(C.trim(),M,E);tt(x===!0?{title:"성공",text:`템플릿 "${C.trim()}"이(가) 추가되었습니다.`,icon:"success",showCancelButton:!1,hotInstance:u}:x==="duplicate_name"?{title:"오류",text:`템플릿 이름 "${C.trim()}"이(가) 이미 존재합니다. 다른 이름을 사용해주세요.`,icon:"error",showCancelButton:!1,hotInstance:u}:{title:"오류",text:"템플릿 추가에 실패했습니다.",icon:"error",showCancelButton:!1,hotInstance:u})}}},undo:{name:"실행 취소"},redo:{name:"다시 실행"}}},fillHandle:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:0,cells:function(a,l,u){const c={},h=rn.get(`${a}-${l}`);return h&&(c.readOnly=h.readOnly,h.isDrillable&&(c.renderer=function(d,f,g,v,y,E){Te.renderers.TextRenderer.apply(this,arguments),f.style.color="#007bff",f.style.textDecoration="underline",f.style.cursor="pointer"})),c},afterOnCellMouseDown:function(a,l,u){if(a.button!==0)return;const c=new Date().getTime(),{row:h,col:d}=l,f=rn.get(`${h}-${d}`),g=300;let v=!1;if(f&&h===Mc.row&&d===Mc.col&&c-Mc.time<g?(v=!0,Mc={row:-1,col:-1,time:0}):Mc={row:h,col:d,time:c},v){let y=!1;const E=this.getColHeader();if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&Array.isArray(E)&&E.length>0&&E[0]==="항목 (Key)"&&d===0&&f&&(y=!0),y){const C=f.originalKey,M=t,x=n.dataPathString;Vl({title:`키 이름 변경: "${C}"`,inputValue:C,customClass:{popup:"custom-swal-popup"},confirmButtonText:"저장",inputValidator:P=>{const T=P.trim();return T?/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다!":M.hasOwnProperty(T)&&T!==C?"이미 사용 중인 키입니다!":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:this}).then(P=>{if(P.isConfirmed&&P.value!==void 0){const T=P.value.trim();T!==C&&n.updateJsonKeyCallback&&n.updateJsonKeyCallback(x,C,T,M)}});return}}if(f&&f.isDrillable&&f.originalValue!==void 0){const y=typeof t=="object"&&t!==null&&!Array.isArray(t)&&d===0&&f&&f.isDrillable;(!v||v&&!y&&f.drillPath)&&typeof f.originalValue=="object"&&f.originalValue!==null&&n.displayTableCallback(f.originalValue,f.originalKey,n.rootJsonData,f.drillPath)}},afterChange:function(a,l){if(l==="loadData"||!a||!Array.isArray(a)||a.length===0)return;const u=l==="CopyPaste.paste"||l==="Autofill.fill"||a.length>1,c=this.getColHeader();a.forEach(([h,d,f,g])=>{let v=-1;if(typeof d=="number"?v=d:typeof d=="string"&&Array.isArray(c)&&(v=c.indexOf(d)),v===-1)if(typeof d=="number"&&c===!0)v=d;else{console.warn("afterChange: 컬럼 인덱스 결정 불가:",h,d,c);return}const y={sourceData:t,pathPrefix:n.dataPathString,headers:Array.isArray(c)?c:c===!0?[]:[],isSourceArray:Array.isArray(t),isSourceArrayOfObjects:Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&!Array.isArray(t[0])&&t[0]!==null,cellMetaMap:rn};let E=Hd(h,v,y);E!==null&&(n.updateJsonDataCallback(E,String(g),u,f),n.convertToTypedValueCallback(String(g),f))}),u&&n.refreshTreeViewCallback&&n.refreshTreeViewCallback("batch_update_handsontable_afterChange")},afterCreateRow:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)){const f=c.getColHeader();for(let g=0;g<l;g++){let v=null;Array.isArray(f)&&f.length>0&&(f.length!==2||f[0]!=="Index"||f[1]!=="Value")&&(v={},f.forEach(y=>{typeof y=="string"&&(v[y]=null)})),h.splice(a+g,0,v)}d=!0,d&&n.refreshTreeViewCallback("row_added_array_hot")}else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){(async()=>{let f={...h},g=0;for(let C=0;C<l;C++){const M=a+C,x=await Vl({title:`새 항목 키 입력 (${C+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:P=>{const T=P.trim();return T?f.hasOwnProperty(T)?"이미 사용 중인 키입니다.":/^\d+$/.test(T)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(x.isConfirmed&&x.value!==void 0){const P=x.value.trim(),T=null,O=Object.keys(f),G={};let U=!1;for(let V=0;V<O.length;V++)V===M&&!U&&(G[P]=T,U=!0),G[O[V]]=f[O[V]];U||(G[P]=T),f=G,g++}else break}g>0&&(Object.keys(h).forEach(C=>delete h[C]),Object.assign(h,f),d=!0,n.refreshTreeViewCallback("key_added_object_hot_ordered"));const{preparedHotData:v,preparedColHeaders:y,preparedCellMetaMap:E}=ui(h,e,n);rn=E,c.updateSettings({colHeaders:y}),c.loadData(v)})();return}if(d||u!=="loadData"){const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},afterCreateCol:function(a,l,u){if(u==="loadData"||!n.currentJsonDataRef)return;const c=this;let h=t,d=!1;if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){(async()=>{for(let y=0;y<l;y++){const E=a+y,C=await Vl({title:`새 열(속성)의 키 입력 (${y+1}/${l})`,inputPlaceholder:"새로운 키 이름을 입력하세요",confirmButtonText:"추가",inputValidator:M=>{const x=M.trim();return x?h[0].hasOwnProperty(x)?"첫 번째 객체에 이미 해당 키가 존재합니다.":/^\d+$/.test(x)?"키 이름은 숫자만으로 구성될 수 없습니다.":null:"키 이름은 비워둘 수 없습니다!"},hotInstance:c});if(C.isConfirmed&&C.value!==void 0){const M=C.value.trim();h.forEach(x=>{if(typeof x=="object"&&x!==null){const P=Object.keys(x),T={};let O=!1;if(E>=P.length)x[M]=null;else{for(let G=0;G<P.length;G++)G===E&&!O&&(T[M]=null,O=!0),T[P[G]]=x[P[G]];O||(T[M]=null),Object.keys(x).forEach(G=>delete x[G]),Object.assign(x,T)}}}),d=!0}else break}d&&n.refreshTreeViewCallback("col_added_array_of_obj_hot_ordered");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)})();return}else if(typeof h=="object"&&h!==null&&!Array.isArray(h))tt({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c}).then(()=>{const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)});else{tt({title:"오류",text:"현재 데이터 구조에는 열을 추가할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:c});const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(h,e,n);rn=v,c.updateSettings({colHeaders:g}),c.loadData(f)}},beforeRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;if(u.sort((d,f)=>f-d),Array.isArray(h))u.forEach(d=>{d>=0&&d<h.length&&h.splice(d,1)});else if(typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=Object.keys(h),f=u.map(g=>d[g]).filter(g=>g!==void 0);f.length>0&&f.forEach(g=>{delete h[g]})}else return!1;return!0},afterRemoveRow:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef||c==="ContextMenu.remove_row_custom")return;const h=this;let d=t;n.refreshTreeViewCallback("row_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(d,e,n);rn=v,h.updateSettings({colHeaders:g}),h.loadData(f)},beforeRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return!0;let h=t;const d=this.getColHeader();if(Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0]!==null&&!Array.isArray(h[0])){if(!Array.isArray(d))return tt({title:"오류",text:"열 헤더 정보를 가져올 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1;u.sort((f,g)=>g-f),u.forEach(f=>{if(f>=0&&f<d.length){const g=d[f];typeof g=="string"&&h.forEach(v=>{typeof v=="object"&&v!==null&&delete v[g]})}})}else return typeof h=="object"&&h!==null&&!Array.isArray(h)?(tt({title:"오류",text:"이 뷰에서 특정 열 부분 삭제는 지원되지 않습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1):(tt({title:"오류",text:"현재 데이터 구조에서는 열을 삭제할 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:this}),!1);return!0},afterRemoveCol:function(a,l,u,c){if(c==="loadData"||!n.currentJsonDataRef)return;const h=this;let d=t;n.refreshTreeViewCallback("col_removed_hot");const{preparedHotData:f,preparedColHeaders:g,preparedCellMetaMap:v}=ui(d,e,n);rn=v,h.updateSettings({colHeaders:g}),h.loadData(f)}}),pf):(console.error("Handsontable 컨테이너를 찾을 수 없습니다."),null)}function Hd(t,e,n){const{sourceData:r,pathPrefix:i,headers:o,isSourceArray:s,isSourceArrayOfObjects:a,cellMetaMap:l}=n;let u="";if(s)if(t<r.length)if(a)if(Array.isArray(o)&&e>=0&&e<o.length){const c=o[e];u=`[${t}].${c}`}else return null;else if(e===1)u=`[${t}]`;else return null;else return null;else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){const c=l.get(`${t}-0`);if(!c||c.originalKey===void 0)return null;const h=c.originalKey;if(e===0)return null;const d=Array.isArray(o)&&o.length>1&&o[0]==="항목 (Key)"&&!isNaN(parseInt(o[1],10)),f=Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)";if(d)if(e>0&&e<o.length){const g=o[e],v=r[h];if(Array.isArray(v)){const y=l.get(`${t}-${e}`);if(y&&y.isPadding)return null;u=`.${h}[${g}]`}else return null}else return null;else if(f)if(e===1)u=`.${h}`;else return null;else return Object.keys(r).length===0&&Array.isArray(o)&&o.length===2&&o[0]==="항목 (Key)"&&o[1]==="값 (Value)",null}else return t===0&&e===1?i||"":null;return i?u.startsWith(".")||u.startsWith("[")?i+u:u?i+"."+u:i:u.startsWith(".")?u.substring(1):u}let Gi=[],Zi=-1;const LRe=30;let j_=!1;function FRe(){Gi=[],Zi=-1,j_=!1}function VRe(t){if(j_)return;const{dataPathString:e,dataKeyName:n}=t,r=Gi[Zi];r&&r.dataPathString===e&&r.dataKeyName===n||(Zi<Gi.length-1&&(Gi=Gi.slice(0,Zi+1)),Gi.push({dataPathString:e,dataKeyName:n}),Zi=Gi.length-1,Gi.length>LRe&&(Gi.shift(),Zi--))}function BRe(t){let e=!1,n=Zi;return t==="back"&&Zi>0?(n--,e=!0):t==="forward"&&Zi<Gi.length-1&&(n++,e=!0),e?(Zi=n,Gi[Zi]):null}function IA(t){j_=t}function WRe(t){if(!t)return"";const e=t.lastIndexOf("."),n=t.lastIndexOf("[");return e===-1&&n===-1?"":e>n?t.substring(0,e):n>-1?t.substring(0,n):""}function jRe(t,e,n){const r=[];if(!n||!t||t.trim()==="")return r;function i(o,s,a,l){if(!(r.length>=50)){if(typeof o!="object"||o===null){if((e==="value"||e==="both")&&String(o).toLowerCase().includes(t)){let u,c,h;a?(u=a,c=l,h=WRe(s)):(u=o,c="Value",h=""),r.push({displayText:`[Value] <b>${String(o).substring(0,50)}</b> (<i>${(s||"root").replaceAll("."," > ")}</i>)`,actionParams:{data:u,dataKeyName:c,rootJsonData:n,dataPathString:h}})}return}if(Array.isArray(o))for(let u=0;u<o.length&&!(r.length>=50);u++){const c=o[u],h=`${s}[${u}]`;i(c,h,o,String(u))}else{const u=Object.keys(o);for(const c of u){if(r.length>=50)break;const h=o[c],d=s?`${s}.${c}`:c;(e==="key"||e==="both")&&String(c).toLowerCase().includes(t)&&r.push({displayText:`[Key] <b>${c}</b> (in <i>${(s||"root object").replaceAll("."," > ")}</i>)`,actionParams:{data:o,dataKeyName:c,rootJsonData:n,dataPathString:s}}),i(h,d,o,c)}}}}return i(n,"",null,null),r}function OA(t,e,n,r){if(e.innerHTML="",t.length===0&&n.trim()!==""){const i=document.createElement("div");i.className="search-no-results",i.textContent="No results found.",e.appendChild(i)}else t.forEach(i=>{const o=document.createElement("div");o.className="search-result-item",o.innerHTML=i.displayText,i.noAction?o.style.cursor="default":o.addEventListener("click",()=>r(i.actionParams)),e.appendChild(o)});e.style.display=t.length>0||n.trim()!==""&&t.length===0?"block":"none"}const dv="userJsonEditorTemplates_v1";let Qi=[];const Nd=[{name:"빈 객체 (Empty Object)",type:"object",value:{},isDefault:!0},{name:"빈 배열 (Empty Array)",type:"array",value:[],isDefault:!0}];function d0(){try{const t=localStorage.getItem(dv);if(t){const e=JSON.parse(t);if(Array.isArray(e)){const n=Nd.map(i=>i.name),r=e.filter(i=>!n.includes(i.name)||!i.isDefault);Qi=[...Nd,...r]}else console.warn("Stored templates are not in array format, resetting to defaults."),Qi=[...Nd]}else Qi=[...Nd]}catch(t){console.error("Error loading templates from localStorage, resetting to defaults:",t),Qi=[...Nd]}return OV(),Qi}function URe(){return(Qi.length===0&&localStorage.getItem(dv)===null||Qi.length===0&&localStorage.getItem(dv)!==null)&&d0(),Qi}function zRe(t,e,n){if(!t||!e||n===void 0)return console.error("Template name, type, and value are required."),!1;const r=t.trim();if(Qi.some(o=>o.name===r))return console.warn(`Template with name "${r}" already exists.`),"duplicate_name";const i={name:r,type:e,value:JSON.parse(JSON.stringify(n)),isDefault:!1};return Qi.push(i),OV(),!0}function OV(){try{localStorage.setItem(dv,JSON.stringify(Qi))}catch(t){console.error("Error saving templates to localStorage:",t)}}d0();document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".theme-switcher");if(!t)return;const e=t.querySelectorAll(".theme-button"),n=document.body,r="selected_theme_json_editor",i=[{buttonId:"theme-btn-1",themeClass:"theme-high-contrast-dark",name:"High Contrast Dark"},{buttonId:"theme-btn-2",themeClass:"theme-classic-purple",name:"Classic Purple Light"},{buttonId:"theme-btn-3",themeClass:"theme-soft-mint",name:"Soft Mint"}],o="theme-classic-purple";function s(u){i.forEach(h=>{n.classList.contains(h.themeClass)&&n.classList.remove(h.themeClass)});let c=o;u&&i.some(h=>h.themeClass===u)&&(c=u),n.classList.add(c),localStorage.setItem(r,c),a(c)}function a(u){e.forEach(c=>{const h=i.find(d=>d.buttonId===c.id);h&&h.themeClass===u?c.classList.add("active-theme"):c.classList.remove("active-theme")})}e.forEach(u=>{u.addEventListener("click",()=>{const c=i.find(h=>h.buttonId===u.id);c&&s(c.themeClass)})});const l=localStorage.getItem(r);s(l!==null?l:o)});let Ee=null,ou=null,Is,wf,qn,Lt=null;function YRe(){const t=document.getElementById("loadBtn");t&&t.addEventListener("click",U_);const e=document.getElementById("saveBtn");e&&e.addEventListener("click",ZRe);const n=document.getElementById("minifyBtn");n&&n.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=VV(sn.value)}catch(h){en&&(en.textContent="Minify 오류: "+h.message)}else sn&&(sn.value="")});const r=document.getElementById("uglifyBtn");r&&r.addEventListener("click",()=>{if(sn&&sn.value)try{sn.value=BV(sn.value)}catch(h){en&&(en.textContent="Uglify(포맷팅) 오류: "+h.message)}else sn&&(sn.value="")});const i=document.getElementById("diffBtn");i&&i.addEventListener("click",()=>{if(!ou&&!Ee){tt({title:"알림",text:"먼저 JSON 데이터를 로드해주세요.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}if(!ou){tt({title:"알림",text:"로드 시점의 원본 JSON 데이터가 없습니다. 변경사항을 비교할 수 없습니다.",icon:"info",showCancelButton:!1,hotInstance:Lt});return}fj({title:"JSON 데이터 변경사항",jsonDiffData:{left:ou,right:Ee===null?{}:Ee},buttons:[{text:"닫기",role:"confirm"}],hotInstance:Lt}).catch(d=>{console.error("showJsonDiffPopup 실행 중 오류:",d),tt({title:"오류",text:"변경점 확인 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})})});const o=document.getElementById("loadFromFileBtn");o&&o.addEventListener("click",XRe);const s=document.getElementById("saveToFileBtn");s&&s.addEventListener("click",JRe),Is=document.getElementById("searchInput"),wf=document.getElementById("searchTargetSelect"),qn=document.getElementById("searchResultsDropdown"),Is&&Is.addEventListener("input",HA),wf&&wf.addEventListener("change",HA),document.addEventListener("click",h=>{qn&&Is&&!Is.contains(h.target)&&!qn.contains(h.target)&&(qn.style.display="none")}),qn&&qn.addEventListener("click",h=>h.stopPropagation()),window.addEventListener("mousedown",h=>{(h.button===3||h.button===4)&&(h.preventDefault(),h.button===3?DA("back"):h.button===4&&DA("forward"))}),window.addEventListener("contextmenu",h=>{h.preventDefault()});const a=document.querySelector(".json-control-panel");a?(a.addEventListener("dragover",GRe),a.addEventListener("dragleave",KRe),a.addEventListener("drop",qRe)):console.warn(".json-control-panel 요소를 찾을 수 없어 드래그앤드롭 기능을 활성화할 수 없습니다.");const l=document.querySelector(".main-layout-triple-panel"),u=[document.querySelector(".json-control-panel"),document.querySelector(".tree-view-panel"),document.querySelector(".table-view-panel")],c=[document.getElementById("resizer-1"),document.getElementById("resizer-2")];l&&u.every(h=>h)&&c.every(h=>h)?(AA(l,u,c),window.addEventListener("resize",()=>AA(l,u,c)),c.forEach((h,d)=>{let f=!1,g=0,v=[];h.addEventListener("mousedown",C=>{C.preventDefault(),f=!0,g=C.clientX,v=[u[d].offsetWidth,u[d+1].offsetWidth],document.addEventListener("mousemove",y),document.addEventListener("mouseup",E)});function y(C){if(!f)return;const M=C.clientX-g,x=50;let P=v[0]+M,T=v[1]-M;P<x&&(P=x,T=v[0]+v[1]-P),T<x&&(T=x,P=v[0]+v[1]-T),u[d].style.flexBasis=`${P}px`,u[d+1].style.flexBasis=`${T}px`}function E(){f&&(f=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",E))}})):console.warn("3-패널 레이아웃에 필요한 요소를 모두 찾을 수 없습니다. 리사이저가 동작하지 않을 수 있습니다.")}function GRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.add("dragover-active"),t.dataTransfer.dropEffect="copy"}function KRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active")}function qRe(t){t.preventDefault(),t.stopPropagation(),t.currentTarget&&typeof t.currentTarget.classList<"u"&&t.currentTarget.classList.remove("dragover-active");const e=t.dataTransfer.files;if(e.length>0){const n=e[0];if(n.type==="application/json"||n.name.toLowerCase().endsWith(".json")){const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,U_(),nu(qr,`${n.name} 파일이 드롭되어 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),tt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류 (드롭):",o),en&&(en.textContent=`파일 오류 (드롭): ${o.message}`),tt({title:"파일 로드 오류 (드롭)",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류 (드롭):",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다 (드롭)."),tt({title:"파일 읽기 오류 (드롭)",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n)}else tt({title:"잘못된 파일 타입",text:"JSON 파일(.json)만 드롭해주세요.",icon:"warning",showCancelButton:!1,hotInstance:Lt})}}function AA(t,e,n){const r=t.offsetWidth,i=n.reduce((l,u)=>l+u.offsetWidth,0),o=r-i,s=[.1,.15,.75],a=50;if(o>0){let l=Math.max(a,Math.floor(o*s[0])),u=Math.max(a,Math.floor(o*s[1])),c=Math.max(a,o-l-u);l+u+c>o&&(c=o-l-u),e[0].style.flexBasis=`${l}px`,e[1].style.flexBasis=`${u}px`,e[2].style.flexBasis=`${c}px`}}function HA(){if(!Is||!wf||!qn)return;const t=Is.value.trim().toLowerCase(),e=wf.value;if(!t){qn.innerHTML="",qn.style.display="none";return}if(Ee==null){OA([{displayText:"JSON 데이터를 먼저 로드해주세요.",noAction:!0}],qn,t,NA);return}const n=jRe(t,e,Ee);OA(n,qn,t,NA)}function NA(t){t&&typeof Ga=="function"&&(Ga(t.data,t.dataKeyName,t.rootJsonData,t.dataPathString||""),qn&&(qn.style.display="none"))}function XRe(){const t=document.createElement("input");t.type="file",t.accept=".json,application/json",t.style.display="none",t.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const r=new FileReader;r.onload=i=>{try{const o=i.target.result;sn?(sn.value=o,U_(),nu(qr,`${n.name} 파일이 로드되었습니다.`,3e3)):(console.error("JSON 입력 필드를 찾을 수 없습니다."),tt({title:"오류",text:"JSON 입력 필드를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt}))}catch(o){console.error("파일 읽기 또는 JSON 파싱 오류:",o),en&&(en.textContent=`파일 오류: ${o.message}`),tt({title:"파일 로드 오류",text:`파일을 로드하거나 파싱하는 중 오류가 발생했습니다: ${o.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}},r.onerror=i=>{console.error("파일 읽기 오류:",i),en&&(en.textContent="파일을 읽는 중 오류가 발생했습니다."),tt({title:"파일 읽기 오류",text:"파일을 읽는 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})},r.readAsText(n),document.body.removeChild(t)}),document.body.appendChild(t),t.click()}async function JRe(){if(Ee==null){nu(qr,"저장할 JSON 데이터가 없습니다.",3e3);return}try{const t=await Vl({title:"파일 이름 입력",inputLabel:"저장할 파일 이름을 입력해주세요 (.json 확장자는 자동으로 추가됩니다):",inputValue:"data",confirmButtonText:"저장",inputValidator:e=>!e||e.trim().length===0?"파일 이름은 비워둘 수 없습니다.":null,hotInstance:Lt});if(t.isConfirmed&&t.value){let e=t.value.trim();e.toLowerCase().endsWith(".json")||(e+=".json");const n=JSON.stringify(Ee,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),nu(qr,`${e} 파일이 성공적으로 저장되었습니다!`,3e3)}else nu(qr,"파일 저장이 취소되었습니다.",3e3)}catch(t){console.error("JSON 파일 저장 오류:",t),en&&(en.textContent="JSON 파일 저장 오류: "+t.message),tt({title:"파일 저장 오류",text:`JSON 데이터를 파일로 저장하는 중 오류가 발생했습니다: ${t.message}`,icon:"error",showCancelButton:!1,hotInstance:Lt})}}function U_(){QRe(),FRe();try{const t=sn.value.trim();if(!t){Ee=null,ou=null,kc(null,vf),Qp();return}Ee=JSON.parse(t),ou=JSON.parse(JSON.stringify(Ee));const e=AV();if(Et&&(Et.innerHTML=""),typeof Ee=="object"&&Ee!==null)Cf(Ee,Et,"",Ee,0,e);else{const r={["value"]:Ee};Cf(r,Et,"",r,0,e)}Qp(),kc(null,vf)}catch(t){en&&(en.textContent="JSON 파싱 오류: "+t.message),Ee=null,ou=null,Et&&(Et.innerHTML=""),Qp(),kc(null,vf)}}function ZRe(){if(en&&(en.textContent=""),Ee!=null)try{const t=JSON.stringify(Ee,null,2);sn&&(sn.value=t),qr&&nu(qr,"JSON이 텍스트 영역에 저장되었습니다!",3e3)}catch(t){en&&(en.textContent="JSON 문자열 변환 오류: "+t.message),qr&&(qr.textContent="")}else sn&&(sn.value=""),qr&&nu(qr,"저장할 JSON 데이터가 없습니다.",3e3)}function QRe(){mj(),Qp(),Ee=null,ou=null,qc(null),qn&&(qn.innerHTML="",qn.style.display="none"),Is&&(Is.value=""),Et&&(Et.innerHTML=""),kc(null,vf)}function Qp(){Lt=IV()}function e0e(t,e,n=!1){if(Ee==null){console.error("데이터 업데이트 오류: currentJsonData가 없습니다.");return}const r=t.replace(/\[(\d+)\]/g,".$1").split("."),i=r.pop(),o=r.join(".");let s;if(o===""?s=Ee:s=au(Ee,o),o===""&&t===i&&(typeof Ee!="object"||Ee===null)){if(Ee=VS(e,Ee),n)return;fv(t),Ga(Ee,"value",Ee,"");return}if(!s||typeof s!="object"&&!Array.isArray(s)){console.error("데이터 업데이트 오류: 부모 객체를 찾을 수 없거나 객체/배열이 아님.",{pathString:t,parentPath:o,parentObject:s}),tt({title:"오류",text:"데이터 업데이트 중 오류가 발생했습니다 (부모 경로 확인 필요).",icon:"error",showCancelButton:!1,hotInstance:Lt});return}const a=/^\d+$/.test(i)&&Array.isArray(s)?parseInt(i,10):i;if(Array.isArray(s)&&(a<0||a>=s.length)){console.error("데이터 업데이트 오류: 배열 인덱스 범위 초과.",{targetKeyOrIndex:a,arrayLength:s.length}),tt({title:"오류",text:"배열 인덱스 범위를 벗어났습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}let l=!0;const u=s[a],c=VS(String(e),u);if(s[a]=c,!n){if((typeof u!="object"||u===null)&&(typeof c!="object"||c===null)&&Et){const f=Et.querySelector(`.tree-node[data-path="${t}"]`);if(f){const g=f.querySelector(".node-text-wrapper .tree-node-value");g&&(zH(g,c),l=!1)}}!n&&l&&fv(t)}}function t0e(t,e,n,r){let i;if(r&&(t===""||au(Ee,t)===r)?i=r:i=t===""?Ee:au(Ee,t),typeof i!="object"||i===null||Array.isArray(i)){tt({title:"오류",text:"키를 업데이트할 부모 객체를 찾을 수 없습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(!i.hasOwnProperty(e)){tt({title:"오류",text:`기존 키 "${e}"를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}if(n===e){tt({icon:"info",title:"알림",text:"키 이름에 변경사항이 없습니다.",showCancelButton:!1,hotInstance:Lt});return}if(i.hasOwnProperty(n)){tt({title:"오류",text:`새 키 "${n}"가 이미 현재 객체에 존재합니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt});return}const o={},s=i[e];for(const a in i)i.hasOwnProperty(a)&&(a===e?o[n]=s:o[a]=i[a]);for(const a in i)i.hasOwnProperty(a)&&delete i[a];for(const a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);tt({icon:"success",title:"성공",text:`키 "${e}"가 "${n}"(으)로 변경되었습니다.`,showCancelButton:!1,hotInstance:Lt}),fv(`key_renamed_in_parent:${t}`),Ga(i,n,Ee,t)}function fv(t="N/A"){if(Et&&Ee!=null){const e=vj(),n=yj(Et);Et.innerHTML="";const r=AV();if(typeof Ee=="object"&&Ee!==null)Cf(Ee,Et,"",Ee,0,r);else{const o={[typeof t=="string"&&t!=="N/A"&&!t.includes(".")?t:"value"]:Ee};Cf(o,Et,"",o,0,r)}if(Cj(Et,n),e){const i=Et.querySelector(`.tree-node[data-path="${e}"]`);i&&qc(i)}}else Et&&(Et.innerHTML="")}function AV(){return{displayTableCallback:Ga,getObjectByPathCallback:au,rootJsonData:Ee}}function vf(t){const e=au(Ee,t);if(e!==void 0){let n="context";if(t==="")n="root";else{const r=t.lastIndexOf("."),i=t.lastIndexOf("[");i>-1&&t.endsWith("]")?i>r?n=t.substring(i+1,t.length-1):n=t.substring(r+1):r>-1?n=t.substring(r+1):n=t}Ga(e,n,Ee,t,{syncTreeView:!0})}else console.warn(`Data not found for path: ${t}`),tt({title:"오류",text:`경로 '${t}'에 해당하는 데이터를 찾을 수 없습니다.`,icon:"error",showCancelButton:!1,hotInstance:Lt})}function Ga(t,e,n,r,i={syncTreeView:!0}){if(VRe({dataPathString:r,dataKeyName:e}),kc(r,vf),Lt=$Re(t,e,{tableViewDomElement:FS,updateJsonDataCallback:e0e,updateJsonKeyCallback:t0e,refreshTreeViewCallback:fv,getObjectByPathCallback:au,convertToTypedValueCallback:VS,rootJsonData:n,currentJsonDataRef:()=>Ee,dataPathString:r,displayTableCallback:Ga,getTemplates:URe,addTemplate:zRe}),i.syncTreeView&&Et&&r!==void 0&&r!==null){const s=Et.querySelector(`.tree-node[data-path="${r}"]`);s?(qc(s),setTimeout(()=>{const a=Et.querySelector(`.tree-node[data-path="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},50)):r===""?(qc(null),Et.firstChild&&(Et.scrollTop=0)):console.warn(`Tree node for path "${r}" not found for synchronization.`)}}function DA(t){const e=BRe(t);if(e){IA(!0);try{const n=au(Ee,e.dataPathString);Ga(n,e.dataKeyName,Ee,e.dataPathString,{syncTreeView:!1})}catch(n){console.error("Error navigating history:",n),tt({title:"오류",text:"히스토리 복원 중 오류가 발생했습니다.",icon:"error",showCancelButton:!1,hotInstance:Lt})}finally{IA(!1)}}}document.addEventListener("DOMContentLoaded",YRe)});export default n0e();
